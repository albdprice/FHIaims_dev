<regressionsuite>

    <testsuite name="DFT, periodic systems">
        <testcase name="Cu, fcc phase, PW_LDA" folder="fcc_Cu"/>
        <testcase name="Al, PBE, Methfessel-Paxton broadening" folder="Al_mp_broadening"/>
        <testcase name="Ar_Q4C, fully relativistic, PBE" folder="Ar_Q4C"/>
	<testcase name="GaAs, PBE with spin-orbit coupling" folder="GaAs_SOC">
            <testparameter name="Band Structure, No SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(106, 5E-3)"
                file="band*.out.no_soc"
            />
            <testparameter name="Band Structure, SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(208, 5E-3)"
                file="band*.out"
            />
            <testparameter name="Total DOS, No SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E-4, comments='#')"
                file="KS_DOS*.dat.no_soc"
            />
            <testparameter name="Total DOS, SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E-4, comments='#')"
                file="KS_DOS*.dat"
            />
        </testcase>
	<testcase name="GaAs, PBE with spin-orbit coupling, Gamma point only" folder="GaAs_SOC_Gamma">
            <testparameter name="Band Structure, No SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(106, 5E-3)"
                file="band*.out.no_soc"
            />
            <testparameter name="Band Structure, SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(208, 5E-3)"
                file="band*.out"
            />
            <testparameter name="Total DOS, No SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E-4, comments='#')"
                file="KS_DOS*.dat.no_soc"
            />
            <testparameter name="Total DOS, SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E-4, comments='#')"
                file="KS_DOS*.dat"
            />
        </testcase>
        <testcase name="MgS, PBE, Mulliken Analysis and Projected DOS" folder="MgS_pDOS">
            <testparameter name="Total DOS, No SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E-4, comments='#')"
                file="KS_DOS*.dat.no_soc"
            />
            <testparameter name="Total DOS, SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E-4, comments='#')"
                file="KS_DOS*.dat"
            />
            <testparameter name="Atom-Projected Density of States (Mg), No SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 1E-4, comments='#')"
                file="atom_projected_dos_Mg*.dat.no_soc"
            />
            <testparameter name="Atom-Projected Density of States (Mg), SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 5E-4, comments='#')"
                file="atom_projected_dos_Mg*.dat"
            />
            <testparameter name="Atom-Projected Density of States (S), No SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 1E-4, comments='#')"
                file="atom_projected_dos_S*.dat.no_soc"
            />
            <testparameter name="Atom-Projected Density of States (S), SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 5E-4, comments='#')"
                file="atom_projected_dos_S*.dat"
            />
            <testparameter name="Species-Projected Density of States (Mg), No SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 1E-4, comments='#')"
                file="Mg_l_proj_dos.dat.no_soc"
            />
            <testparameter name="Species-Projected Density of States (Mg), SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 5E-4, comments='#')"
                file="Mg_l_proj_dos.dat"
            />
            <testparameter name="Species-Projected Density of States (S), No SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 1E-4, comments='#')"
                file="S_l_proj_dos.dat.no_soc"
            />
            <testparameter name="Species-Projected Density of States (S), SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 5E-4, comments='#')"
                file="Mg_l_proj_dos.dat"
            />
            <testparameter name="Mulliken charges, No SOC"
                importance="mandatory"
                comparison="cmp_file.MullikenFileDiff(1E-4)"
                file="Mulliken.out.no_soc"
            />
        </testcase>
        <testcase name="MgS, PBE, Mulliken Analysis and Projected DOS, Gamma point only" folder="MgS_pDOS_Gamma">
            <testparameter name="Total DOS, No SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E-4, comments='#')"
                file="KS_DOS*.dat.no_soc"
            />
            <testparameter name="Total DOS, SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E-4, comments='#')"
                file="KS_DOS*.dat"
            />
            <testparameter name="Atom-Projected Density of States (Mg), No SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 1E-4, comments='#')"
                file="atom_projected_dos_Mg*.dat.no_soc"
            />
            <testparameter name="Atom-Projected Density of States (Mg), SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 5E-4, comments='#')"
                file="atom_projected_dos_Mg*.dat"
            />
            <testparameter name="Atom-Projected Density of States (S), No SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 1E-4, comments='#')"
                file="atom_projected_dos_S*.dat.no_soc"
            />
            <testparameter name="Atom-Projected Density of States (S), SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 5E-4, comments='#')"
                file="atom_projected_dos_S*.dat"
            />
            <testparameter name="Species-Projected Density of States (Mg), No SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 1E-4, comments='#')"
                file="Mg_l_proj_dos.dat.no_soc"
            />
            <testparameter name="Species-Projected Density of States (Mg), SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 5E-4, comments='#')"
                file="Mg_l_proj_dos.dat"
            />
            <testparameter name="Species-Projected Density of States (S), No SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 1E-4, comments='#')"
                file="S_l_proj_dos.dat.no_soc"
            />
            <testparameter name="Species-Projected Density of States (S), SOC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 5E-4, comments='#')"
                file="S_l_proj_dos.dat"
            />
            <testparameter name="Mulliken charges, No SOC"
                importance="mandatory"
                comparison="cmp_file.MullikenFileDiff(1E-4)"
                file="Mulliken.out.no_soc"
            />
        </testcase>
        <testcase name="TiCl, PBE+U, total energy test" folder="TiCl_plus_U" skip="SCF HOMO energy (eV), HOMO-LUMO gap">
            <testparameter name="DFT+U energy correction"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 3)"
                regex=".+DFT\+U energy correction\s*:\s*([-0-9.]+)"
                occurence="-1"
            />
            <testparameter
                name = "SCF HOMO energy (eV)"
                comparison = "cmp_float.abs_diff(1E-4)"
                importance = "mandatory"
                regex="Highest occupied state \(VBM\) at[ ]+([-0-9.]+) eV"
                occurence="-1"
            />
            <testparameter
                name = "HOMO-LUMO gap"
                comparison = "cmp_float.abs_diff(5E-4)"
                importance = "consistent"
                regex="ESTIMATED overall HOMO-LUMO gap:[ ]+([-0-9.]+) eV"
                occurence="-1"
            />
        </testcase>
        <testcase name="ScN, PW_LDA+U, Band Structure output" folder="ScN.plus_u" skip="SCF HOMO energy (eV), HOMO-LUMO gap">
            <testparameter name="DFT+U energy correction"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 3)"
                regex=".+DFT\+U energy correction\s*:\s*([-0-9.]+)"
                occurence="-1"
            />
            <testparameter
                name = "SCF HOMO energy (eV)"
                comparison = "cmp_float.abs_diff(1E-4)"
                importance = "mandatory"
                regex="Highest occupied state \(VBM\) at[ ]+([-0-9.]+) eV"
                occurence="-1"
            />
            <testparameter
                name = "HOMO-LUMO gap"
                comparison = "cmp_float.abs_diff(5E-4)"
                importance = "consistent"
                regex="ESTIMATED overall HOMO-LUMO gap:[ ]+([-0-9.]+) eV"
                occurence="-1"
            />
            <testparameter
                name = "SCF HOMO occupation number"
                comparison = "cmp_float.abs_diff(5E-5)"
                importance = "mandatory"
                regex="\| Occupation number:[ ]+([-0-9.]+)"
                occurence="-2"
            />
            <testparameter name="Band Structure"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(50, 5E-3)"
                file="band*.out"
            />
        </testcase>
        <testcase name="Al, fcc phase, PW_LDA, stress tensor" folder="fcc_Al_stress"/>
        <testcase name="H2O, ESP-charges, PBE" folder="H2O_esp_periodic">
            <testparameter name="fitted ESP charges"
                importance="mandatory"
                comparison="cmp_float.absvalue_diff(1E-6, 3)"
                regex="Atom[ ]+[0-9]+:[ ]+[A-z]+, ESP charge:[ ]+([-0-9.]+)"
                occurence="1:3"
            />
            <testparameter name="RRMS"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-6, 3)"
                regex="RRMS:[ ]+([-0-9.]+)"
                occurence="1"
            />
        </testcase>
        <testcase name="Periodic Hamiltonian output" folder="Fe.h_s_matrices">
            <testparameter name="Hamiltonian"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(3, 5E-3)"
                file="hamiltonian.out"
            />
            <testparameter name="Overlap Matrix"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(3, 5E-3)"
                file="overlap-matrix.out"
            />
        </testcase>
	<testcase name="GaAs, TPSS functional, Numerical Stress Tensor" folder="GaAs_TPSS_NumStress">
           <testparameter name="Stress Tensor, xx component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  x+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
           <testparameter name="Stress Tensor, xy component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  x+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
           <testparameter name="Stress Tensor, xz component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  x+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
           <testparameter name="Stress Tensor, yx component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  y+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
           <testparameter name="Stress Tensor, yy component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  y+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
           <testparameter name="Stress Tensor, yz component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  y+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
           <testparameter name="Stress Tensor, zx component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  z+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
           <testparameter name="Stress Tensor, zy component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  z+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
           <testparameter name="Stress Tensor, zz component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  z+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
        </testcase>
	<testcase name="GaAs, TPSS functional, Analytic Stress Tensor, Gamma Point only" folder="GaAs_TPSS_AnalStress_Gamma">
           <testparameter name="Stress Tensor, xx component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  x+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
           <testparameter name="Stress Tensor, xy component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  x+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
           <testparameter name="Stress Tensor, xz component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  x+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
           <testparameter name="Stress Tensor, yx component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  y+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
           <testparameter name="Stress Tensor, yy component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  y+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
           <testparameter name="Stress Tensor, yz component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  y+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
           <testparameter name="Stress Tensor, zx component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  z+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
           <testparameter name="Stress Tensor, zy component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  z+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
           <testparameter name="Stress Tensor, zz component (eV/Ang**3)"
                   file="aims.out"
                   importance="mandatory"
                   comparison="cmp_float.absvalue_diff(2e-5, 3)"
                   regex="\|  z+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+[-+]?[0-9]+\.[0-9]+[ ]+([-+]?[0-9]+\.[0-9]+)"
                   occurence="-1"
           />
        </testcase>
        <testcase name="Si, PBE, ill-conditioning" folder="Si.pbe.ill"/>
        <testcase name="Au, frozen core, periodic" folder="Au_frozen_periodic"/>
    </testsuite>

    <testsuite name="DFT, isolated molecules">
        <testcase name="Kr Ion, VWN (test of on-site orthonormalization)" folder="Kr_ion.vwn" skip="SCF HOMO occupation number"/>
        <testcase name="N2, PW-LDA" folder="N2.pw-lda.superpos_rho"  skip="Initialization Energy (eV)"/>
        <testcase name="H20, PBE, 2nd iteration forces" folder="H_20.pbe.forces.2_iter"/>
        <testcase name="H2, minimal basis, spin-collinear PBE" folder="H2_fsm_2"/>
        <testcase name="V3 +1, PBE0, no relativity, spin-collinear" folder="V3+_pbe0_spin">
            <testparameter name="total density"
                importance="mandatory"
                comparison="cmp_file.CubeFileRMSD(1E-6)"
                file="total_density.cube"
            />
            <testparameter name="spin density"
                importance="mandatory"
                comparison="cmp_file.CubeFileRMSD(1E-6)"
                file="spin_density.cube"
            />
            <testparameter name="Mulliken charges"
                importance="mandatory"
                comparison="cmp_file.MullikenFileDiff(1E-4)"
                file="Mulliken.out"
            />
        </testcase>
        <testcase name="NaCl, spin-constrained, relativistic PBE" folder="NaCl_spin_constrained.pbe"/>
        <testcase name="Pd5O, spin-collinear, PW-LDA, DOS-output" folder="O-Pd5.pw-lda.fsm_4">
            <testparameter name="total Density of states"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(3, 1E-4, comments='#')"
                file="KS_DOS*.dat"
            />
            <testparameter name="atom-projected Density of states (O)"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(5, 1E-4, comments='#')"
                file="atom_proj_dos_spin_dnO*.dat"
            />
            <testparameter name="atom-projected Density of states (Pd)"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(6, 1E-4, comments='#')"
                file="atom_proj_dos_spin_dnPd*.dat"
            />
            <testparameter name="Mulliken charges"
                importance="mandatory"
                comparison="cmp_file.MullikenFileDiff(1E-4)"
                file="Mulliken.out"
            />
        </testcase>
        <testcase name="H2 (x3), HSE06, (product) basis output" folder="nH2.hse">
            <testparameter name="Basis Set"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E-6, comments='#')"
                file="[!p][!r][!o]*.dat"
            />
            <testparameter name="Product Basis Set"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(3, 1E-6, comments='#')"
                file="prodbas-*.dat"
            />
            <testparameter name="Product Basis Set (logsbt grid)"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E-6, comments='#')"
                file="prodbas_logsbt*.dat"
            />
        </testcase>
        <testcase name="NaCl, QMMM embedding, PBE" folder="NaCl_qmmm"/>
        <testcase name="H2O, ESP-charges, PBE" folder="H2O_esp_cluster">
            <testparameter name="fitted ESP charges"
                importance="mandatory"
                comparison="cmp_float.absvalue_diff(1E-6, 3)"
                regex="Atom[ ]+[0-9]+:[ ]+[A-z]+, ESP charge:[ ]+([-0-9.]+)"
                occurence="1:3"
            />
            <testparameter name="RRMS"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-6, 3)"
                regex="RRMS:[ ]+([-0-9.]+)"
                occurence="1"
            />
        </testcase>
        <testcase name="H2O^+1, ESP-charges, PBE" folder="H2O_esp_cluster.charged">
            <testparameter name="fitted ESP charges"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-6, 3)"
                regex="Atom[ ]+[0-9]+:[ ]+[A-z]+, ESP charge:[ ]+([-0-9.]+)"
                occurence="1:3"
            />
            <testparameter name="RRMS"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-6, 3)"
                regex="RRMS:[ ]+([-0-9.]+)"
                occurence="1"
            />
        </testcase>
        <testcase name="CH3, M06-L SCF calculation with forces and TPSS post-processing" folder="CH3.m06l_post_tpss"/>
        <testcase name="H2O, M11 Long-range corrected hybrid meta-GGA SCF calculation" folder="H2O.m11"/>
	<testcase name="Hg atom, PBE with spin-orbit coupling" folder="Hg_atom_SOC"/>
	<testcase name="Hg atom, PBE with spin-orbit coupling and packed_matrix_format none" folder="Hg_atom_SOC_PackedMatrixNone"/>
        <testcase name="H2O, PBE, ill-conditioning" folder="H2O.pbe.ill"/>
        <testcase name="Au, frozen core, cluster" folder="Au_frozen_cluster"/>
    </testsuite>

    <testsuite name="beyond DFT">
        <testcase name="H2, self-consistent GW" folder="H2_scgw"/>
        <!--The following, original test consistently failed across multiple compilation settings and platforms. Anyone who fixes it is free to uncomment, but for now, it underminew the entire set. -->
        <!--<testcase name="H2, self-consistent GW" folder="H2_scgw">
            <testparameter name="scGW spectrum"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1, threshold=1E-4, relative=True)"
                file="spectrum_sc.dat"
            />
            <testparameter name="Green's function (img part)"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 0.1, threshold=1E-4, relative=True)"
                file="sp_ImG*.dat"
            />
        </testcase>-->
        <testcase name="Cu2, MP2@HF" folder="Cu2.mp2"/>
        <testcase name="N2, MP2@HF with Gaussians" folder="N2.aug_gaussian"/>
        <testcase name="CO, RPA@PBE" folder="CO.pbe+rpa" skip="DFT/HF total energy (eV)"/> <!--TODO: add custom energies-->
        <!-- Note:  For the Na4 calculations, it is known that the G0W0 results for 1s orbitals varied from architecture to architecture, and it was common practice to simply ignore the failure of this test.  As a result, a serious bug affecting the entire spectrum went undetected for 3 months.  The 1s states are now optional.  This is not a great solution, but the old solution was proven to be far worse. -->
        <testcase name="Na4, G0W0@LDA (analytic continuation: two-pole fitting)" folder="Na4.lda+gw_two-pole">
            <testparameter name="G0W0 QP-energies (1s orbitals)"
                importance="optional"
                comparison="cmp_table.TableFloatDiff(7, 1E-3, headerrows=7)"
                regex="GW quasi-particle energy levels"
                tablerows="10"
            />
            <testparameter name="G0W0 QP-energies (no 1s orbitals)"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-3, headerrows=11)"
                regex="GW quasi-particle energy levels"
                tablerows="38"
            />
        </testcase>
        <!-- WPH, 3 August 2018: Made the QP energies in the CH4 Pade approximation test optional. -->
        <testcase name="CH4, G0W0@LDA (analytic continuation: Pade approximation)" folder="CH4.lda+gw_pade">
            <testparameter name="G0W0 QP-energies (Carbon 1s orbitals)"
                importance="optional"
                comparison="cmp_table.TableFloatDiff(7, 1E-3, headerrows=7)"
                regex="GW quasi-particle energy levels"
                tablerows="7"
            />
            <testparameter name="G0W0 QP-energies (no carbon 1s orbitals)"
                importance="optional"
                comparison="cmp_table.TableFloatDiff(7, 1E-3, headerrows=8)"
                regex="GW quasi-particle energy levels"
                tablerows="21"
            />
        </testcase>
        <testcase name="H2O, G0W0@PBE, Z-shot (analytic continuation: Pade approximation)" folder="H2O.gw_pade_zshot">
            <testparameter name="G0W0 QP-energies (no 1s orbital)"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-3, headerrows=8)"
                regex="GW quasi-particle energy levels"
                tablerows="21"
            />
        </testcase>
        <testcase name="H2O dimer, MP2/RPA@HF, RI-LVL_full" folder="H2O_dim.lvl"/>
	<testcase name="H2O magnetic response" folder="H2O_MR" skip="DFT/HF total energy (eV),Post-SCF total energy (eV),Total calculation time (sec),Total Memory consumption (MB),Number of SCF steps,Initialization Energy (eV),SCF HOMO energy (eV),Total Memory consumption (MB),Number of SCF steps,Initialization Energy (eV),SCF HOMO energy (eV),SCF HOMO occupation number,HOMO-LUMO gap">
	  <testparameter name = "NMR chemical shielding (ppm)"
			 file="aims.out"
			 importance = "mandatory"
			 comparison = "cmp_table.TableFloatDiff(3, 0.001)"
			 regex = "Total:"
			 tablerows="3"
			 occurence="1:2:1"
			 />
	  <testparameter name = "J-coupling (1/s)"
			 file="aims.out"
			 comparison = "cmp_float.rel_diff(0.1)"
			 importance = "mandatory"
			 regex = "^[ ]+1[ ]+([-0-9.]+E[+-0-90-9]+)[ ]+1$"
			 occurence="-2"
			 />
	  <testparameter name = "Magnetizability (10^-30 J/T^2)"
			 file="aims.out"
			 importance = "mandatory"
			 comparison = "cmp_table.TableFloatDiff(3, 0.001)"
			 regex = "Total:"
			 tablerows="3"
			 occurence="-1"
			 />
	</testcase>
    </testsuite>

    <testsuite name="relaxation and MD">
        <testcase name="H20, PBE relaxation" folder="H2O.pbe.relaxation"/>
        <testcase name="Au2, periodic PBE-relaxation" folder="Au_periodic_relaxation"/>
        <!-- Skipping HOMO-LUMO gap for NO test, as it has a half-occupied HOMO which can lead to a reported zero or non-zero gap depending on processor jitter.-->
        <testcase name="NO, spin-collinear PBE-relaxation" folder="NO.pbe.spin.relax" skip="HOMO-LUMO gap, SCF HOMO energy (eV), SCF HOMO occupation number"/>
        <testcase name="NH3, molecular dynamics, NVE emsemble" folder="NH3.MD.NVE"/>
        <testcase name="H2O, molecular dynamics, GLE thermostat" folder="h2o.MD.gle_quantum"/>
        <testcase name="H5O2, molecular dynamics, Nose-Hoover thermostat" folder="H5O2.MD.nose-hoover"/>
        <testcase name="Al, molecular dynamics, periodic thermodynamic integration" folder="Al.periodic_tdi"/>
        <testcase name="Si, periodic relaxation, PW-LDA" folder="Si.pw-lda.cell_relaxation.lattice_trm"/>
        <testcase name="Si, periodic relaxation, PW-LDA, numerical stress (old)" folder="Si.pw-lda.cell_relaxation"/>
        <testcase name="Si2H2O, periodic relaxation, HSE06" folder="periodic_relaxation_hse"/>
        <testcase name="Al2ZnS4, SCR_periodic relaxation, PW-LDA" folder="scr_relaxation_Al2ZnS4"/>
    </testsuite>

    <testsuite name="Restarts, LAPACK">
            <testcase name="restart, cluster, spin none, LAPACK with ORBITAL" folder="restart_clu_LAP_ORBITAL.spin1" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
            <testcase name="restart, cluster, spin none, LAPACK with DENSMAT" folder="restart_clu_LAP_DENSMAT.spin1" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
            <testcase name="restart, cluster, spin collinear, LAPACK with ORBITAL" folder="restart_clu_LAP_ORBITAL.spin2" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
            <testcase name="restart, cluster, spin collinear, LAPACK with DENSMAT" folder="restart_clu_LAP_DENSMAT.spin2" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
            <testcase name="restart, periodic, spin none, LAPACK with DENSMAT" folder="restart_per_LAP_DENSMAT.spin1" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
            <testcase name="restart, periodic, spin collinear, LAPACK with DENSMAT" folder="restart_per_LAP_DENSMAT.spin2" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
            <testcase name="restart, cluster, spin collinear, hybrid, LAPACK with DENSMAT" folder="restart_clu_LAP_DENSMAT.exx.spin2" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
            <testcase name="restart, cluster, spin collinear, hybrid, LAPACK with ORBITAL" folder="restart_clu_LAP_ORBITAL.exx.spin2" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
            <testcase name="restart, periodic, spin collinear, hybrid, LAPACK with DENSMAT" folder="restart_per_LAP_DENSMAT.exx.spin2" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
            <testcase name="restart, forced_singlefile, periodic, spin none, LAPACK with DENSMAT" folder="restart_forced_per_LAP_DENSMAT.spin1" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
    </testsuite>

    <testsuite name="Restarts, ScaLAPACK/ELPA">
        <testcase name="restart, cluster, spin none, SCALAPACK/ELPA with ORBITAL" folder="restart_clu_SCA_ORBITAL.spin1" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
        <testcase name="restart, cluster, spin none, SCALAPACK/ELPA with DENSMAT" folder="restart_clu_SCA_DENSMAT.spin1" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
        <testcase name="restart, cluster, spin collinear, SCALAPACK/ELPA with ORBITAL" folder="restart_clu_SCA_ORBITAL.spin2" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
        <testcase name="restart, cluster, spin collinear, SCALAPACK/ELPA with DENSMAT" folder="restart_clu_SCA_DENSMAT.spin2" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
        <testcase name="restart, periodic, spin none, SCALAPACK/ELPA with DENSMAT" folder="restart_per_SCA_DENSMAT.spin1" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
        <testcase name="restart, periodic, spin collinear, SCALAPACK/ELPA with DENSMAT" folder="restart_per_SCA_DENSMAT.spin2" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
        <testcase name="restart, cluster, spin collinear, hybrid, SCALAPACK/ELPA with DENSMAT" folder="restart_clu_SCA_DENSMAT.exx.spin2" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
        <testcase name="restart, periodic, spin collinear, hybrid, SCALAPACK/ELPA with DENSMAT" folder="restart_per_SCA_DENSMAT.exx.spin2" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
        <testcase name="restart, forced_singlefile, periodic, spin none, SCALAPACK/ELPA with DENSMAT" folder="restart_forced_per_SCA_DENSMAT.spin1" subfolders="./,./" defaultfolder='./' skip="HOMO-LUMO gap, Initialization Energy (eV), SCF HOMO energy (eV)"/>
    </testsuite>

    <testsuite name="ScaLAPACK only">
        <testcase name="CO2, TD-LDA" folder="CO2_tddft_tier2aug2"/>
        <testcase name="H2O, G0W0 with contour deformation, QPs" folder="H2O.gw_contour_def_qp">
            <testparameter name="G0W0 QP-energies"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-3, headerrows=13)"
                regex="GW quasi-particle energy levels"
                tablerows="16"
            />
        </testcase>
        <testcase name="H2O, G0W0 with contour deformation, spectral function " folder="H2O.gw_contour_def_spec">
            <testparameter name="G0W0 QP-energies"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-3, headerrows=14)"
                regex="GW quasi-particle energy levels"
                tablerows="15"
            />
            <testparameter name="Self energy"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E-6)"
                file="self_energy_cd_state_5.dat"
            />
            <testparameter name="Spectral function"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E-6)"
                file="spectrum_cd.dat"
            />
        </testcase>
        <testcase name="H2O, ev-scGW with contour deformation, QPs" folder="H2O.ev_scgw_contour_def_qp">
            <testparameter name="Ev-scGW QP-energies"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-3, headerrows=10)"
                regex="GW quasi-particle energy levels"
                tablerows="17"
                occurence="2"
            />
            <testparameter name="Self energy"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E-6)"
                file="self_energy_cd_state_1.dat"
            />
        </testcase>
        <testcase name="H2O, G0W0 with Hedin shift (AC and CD) " folder="H2O.gw_hedin_shift">
            <testparameter name="G0W0 QP-energies"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-3, headerrows=10)"
                regex="GW quasi-particle energy levels"
                tablerows="17"
            />
            <testparameter name="Self energy AC"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E-4)"
                file="self_energy_analytic_state_4.dat"
            />
            <testparameter name="Self energy CD"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E-6)"
                file="self_energy_cd_state_4.dat"
            />
            <testparameter name="Spectral function CD"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1.5E-6)"
                file="spectrum_cd_state_4.dat"
            />
        </testcase>
        <testcase name="O2, G0W0-Zshot with contour deformation, QPs" folder="O2.gw_contour_def_zshot">
            <testparameter name="G0W0 QP-energies"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-3, headerrows=37)"
                regex="GW quasi-particle energy levels"
                tablerows="40"
            />
        </testcase>
        <testcase name="CH4, Restart G0W0 with contour deformation, QPs" folder="CH4.gw_contour_def_restart">
            <testparameter name="G0W0 QP-energies up"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-3, headerrows=16)"
                regex="GW quasi-particle energy levels"
                tablerows="17"
            />
            <testparameter name="G0W0 QP-energies down"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-3, headerrows=54)"
                regex="GW quasi-particle energy levels"
                tablerows="55"
            />
            <testparameter name="Self energy CD"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E-6)"
                file="down_self_energy_cd_state_5.dat"
            />
        </testcase>
        <testcase name="Density matrix, ELSI ELPA, real case" folder="elsi_dm_elpa_r" skip="HOMO-LUMO gap, SCF HOMO energy (eV), SCF HOMO occupation number"/>
        <testcase name="Density matrix, ELSI ELPA, complex case" folder="elsi_dm_elpa_c" skip="HOMO-LUMO gap, SCF HOMO energy (eV), SCF HOMO occupation number"/>
        <testcase name="Density matrix, ELSI libOMM, real case" folder="elsi_dm_omm_r" skip="HOMO-LUMO gap, SCF HOMO energy (eV), SCF HOMO occupation number"/>
        <testcase name="Density matrix, ELSI libOMM, complex case" folder="elsi_dm_omm_c" skip="HOMO-LUMO gap, SCF HOMO energy (eV), SCF HOMO occupation number"/>
        <testcase name="Density matrix, ELSI NTPoly, real case" folder="elsi_dm_ntpoly_r" skip="HOMO-LUMO gap, SCF HOMO energy (eV), SCF HOMO occupation number"/>
        <testcase name="Density matrix, ELSI NTPoly, complex case" folder="elsi_dm_ntpoly_c" skip="HOMO-LUMO gap, SCF HOMO energy (eV), SCF HOMO occupation number"/>
    </testsuite>

    <testsuite name="DFPT">
        <testcase name="H2, IR" folder="H2_DFPT_IR">
            <testparameter name="Vibrational Frequencies"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(3, 2E-4)"
                regex="Mode number      Frequency \[cm\^\(-1\)\]   IR-intensity \[D\^2/Ang\^2\]"
                tablerows="6"
                occurence="-1"
            />
        </testcase>
        <testcase name="H2, IR, reduce memory" folder="H2_DFPT_IR_reduce_memory">
            <testparameter name="Vibrational Frequencies"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(3, 2E-4)"
                regex="Mode number      Frequency \[cm\^\(-1\)\]   IR-intensity \[D\^2/Ang\^2\]"
                tablerows="6"
                occurence="-1"
            />
        </testcase>
        <testcase name="H2-line, phonon" folder="H2_line_DFPT_phonon">
            <testparameter name="Phonon Frequencies"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(2, 2E-4)"
                regex="Mode number      Frequency \[cm\^\(-1\)\]"
                tablerows="6"
                occurence="-1"
            />
        </testcase>
        <testcase name="H2-line, phonon_reduce_memory" folder="H2_line_DFPT_phonon_reduce_memory">
            <testparameter name="Phonon Frequencies"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(2, 2E-4)"
                regex="Mode number      Frequency \[cm\^\(-1\)\]"
                tablerows="6"
                occurence="-1"
            />
        </testcase>
        <testcase name="H2, polarizability" folder="H2_DFPT_polarizability">
            <testparameter name="polarizability"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(3, 1E-6)"
                regex="DFPT for polarizability"
                tablerows="3"
                occurence="-1"
           />
        </testcase>
        <testcase name="H2-line, dielectric" folder="H2_line_DFPT_dielectric">
            <testparameter name="dielectric"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(3, 1E-6)"
                regex="DFPT for dielectric_constant"
                tablerows="3"
                occurence="-1"
           />
        </testcase>
    </testsuite>

    <testsuite name="Infrastructure">
        <testcase name="CO, load-balancing" folder="CO_loadbalancing" skip="DFT/HF total energy (eV)"/>
    </testsuite>

    <testsuite name="FO-DFT">
        <testcase name="FO-DFT Hybrid basic" folder="fodft_basic.b3lyp" subfolders="frag1_00,frag2_00,dimer_00" defaultfolder="dimer_00">
            <testparameter name="Transfer matrix element (meV)"
                file="dimer_00/aims.out"
                importance="mandatory"
                comparison="cmp_float.absvalue_diff(1E-6, 3)"
                regex="\d{3} -> \d{3}: +([-0-9.]+)"
            />
        </testcase>
        <testcase name="FO-DFT GGA molecule" folder="fodft_molecule.blyp" subfolders="frag1,frag2,dimer" defaultfolder="dimer">
            <testparameter name="Transfer matrix element (meV)"
                file="dimer/aims.out"
                importance="mandatory"
                comparison="cmp_float.absvalue_diff(1E-6, 3)"
                regex="\d{3} -> \d{3}: +([-0-9.]+)"
            />
        </testcase>
    </testsuite>

    <testsuite name="MPE implicit solvation">
        <testcase name="CH3F in water, cavity rho_free, factorization type QR+SVD" folder="mpe_molecule.free.qr+svd">
            <testparameter name="implicit solvent cavity"
                file="cavity_free.dat"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-6, headerrows=1, comments='#')"
            />
            <testparameter name="adjR2 (initial)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="1"
            />
            <testparameter name="adjR2 (final)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="-1"
            />
        </testcase>

        <testcase name="CH3F in water, cavity rho_free, try restore convergence, factorization type QR+SVD" folder="mpe_molecule.free+trc.qr+svd">
            <testparameter name="adjR2 (initial)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="1"
            />
            <testparameter name="adjR2 (final)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="-1"
            />
        </testcase>

        <testcase name="CH3F in water, cavity rho_free, factorization type SVD" folder="mpe_molecule.free.svd">
            <testparameter name="implicit solvent cavity"
                file="cavity_free.dat"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-6, headerrows=1, comments='#')"
            />
            <testparameter name="adjR2 (initial)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="1"
            />
            <testparameter name="adjR2 (final)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="-1"
            />
        </testcase>

        <testcase name="CH3F in water, cavity rho_multipole_dynamic, factorization type QR+SVD" folder="mpe_molecule.dynamic.qr+svd">
            <testparameter name="implicit solvent cavity"
                file="cavity_dynamic.dat"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-6, headerrows=1, comments='#')"
            />
            <testparameter name="adjR2 (initial)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="1"
            />
            <testparameter name="adjR2 (final)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="-1"
            />
        </testcase>

        <testcase name="CH3F in water, cavity rho_multipole_dynamic with kill ratio, factorization type QR+SVD" folder="mpe_molecule.dynamic+kill.qr+svd">
            <testparameter name="adjR2 (initial)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="1"
            />
            <testparameter name="adjR2 (final)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="-1"
            />
        </testcase>

        <testcase name="CH3F in water, cavity rho_free with kill ratio, factorization type QR+SVD" folder="mpe_molecule.free+kill.qr+svd">
            <testparameter name="adjR2 (initial)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="1"
            />
            <testparameter name="adjR2 (final)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="-1"
            />
        </testcase>

        <testcase name="CH3F in water, cavity rho_multipole_dynamic with kill ratio, factorization type SVD" folder="mpe_molecule.dynamic+kill.svd">
            <testparameter name="adjR2 (initial)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="1"
            />
            <testparameter name="adjR2 (final)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="-1"
            />
        </testcase>

        <testcase name="CH3F in water, cavity overlapping_spheres rho, factorization type QR+SVD" folder="mpe_molecule.overlapping_spheres.qr+svd">
            <testparameter name="implicit solvent cavity"
                file="cavity_spheres.dat"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-6, headerrows=1, comments='#')"
            />
            <testparameter name="adjR2 (initial)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="1"
            />
            <testparameter name="adjR2 (final)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="-1"
            />
        </testcase>

        <testcase name="CH3F in water, cavity rho_multipole_static with skipped SCF steps, factorization type QR+SVD" folder="mpe_molecule.static+skip.qr+svd">
            <testparameter name="implicit solvent cavity"
                file="cavity_static.dat"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-6, headerrows=1, comments='#')"
            />
            <testparameter name="adjR2 (initial)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="1"
            />
            <testparameter name="adjR2 (final)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="-1"
            />
        </testcase>

        <testcase name="CH3F in water, cavity rho_free, factorization type QR+SVD, cavity restart" folder="mpe_molecule.free+restart.qr+svd" subfolders="./,./" defaultfolder='./'>
            <testparameter name="implicit solvent cavity"
                file="cavity_free.dat"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-6, headerrows=1, comments='#')"
            />
            <testparameter name="adjR2 (initial)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="1"
            />
            <testparameter name="adjR2 (final)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="-1"
            />
            <testparameter name="restart file"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_string.stripped_equal"
                regex="Read cavity from restart file[ ]+([a-zA-Z_.]+)"
            />
        </testcase>

        <testcase name="CH3F in water, cavity rho_free, factorization type SVD, cavity restart" folder="mpe_molecule.free+restart.svd" subfolders="./,./" defaultfolder='./'>
            <testparameter name="implicit solvent cavity"
                file="cavity_free.dat"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-6, headerrows=1, comments='#')"
            />
            <testparameter name="adjR2 (initial)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="1"
            />
            <testparameter name="adjR2 (final)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="-1"
            />
            <testparameter name="restart file"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_string.stripped_equal"
                regex="Read cavity from restart file[ ]+([a-zA-Z_.]+)"
            />
        </testcase>

        <testcase name="CH3F in water, cavity rho_multipole_dynamic, factorization type QR+SVD, full restart" folder="mpe_molecule.dynamic+restart.qr+svd" subfolders="./,./" defaultfolder='./'>
            <testparameter name="implicit solvent cavity"
                file="cavity_dyn.dat"
                importance="mandatory"
                comparison="cmp_table.TableFloatDiff(7, 1E-6, headerrows=1, comments='#')"
            />
            <testparameter name="adjR2 (initial)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="1"
            />
            <testparameter name="adjR2 (final)"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_float.abs_diff(1E-4, 4)"
                regex="adjR2[ ]+([-0-9.]+)"
                occurence="-1"
            />
            <testparameter name="restart file"
                file="aims.out"
                importance="mandatory"
                comparison="cmp_string.stripped_equal"
                regex="Read cavity from restart file[ ]+([a-zA-Z_.]+)"
            />
        </testcase>
    </testsuite>

    <testsuite name="MPB-DFT">
    	<testcase name="MPB-DFT c!=0 MERM_in_SPE_solver=.true." folder="mpbdft_hcl.ion.merminspe" subfolders="./" defaultfolder="./">
	   <testparameter name="Non-meanfield Solvent-Solute Interaction (Ha)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1E-7, 3)"
		   regex="Nonelectrostatic Free Energy+[ ]+:+[ ]+([-0-9.]+) Ha"
		   occurence="-1"
           />
	   <testparameter name="Nonelectrostatic Ionic Contribution to Free Energy (Ha)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1E-7, 3)"
		   regex="Additional Nonelstatic MPBE Solvation Energy:+[ ]+([-0-9.]+) Ha"
		   occurence="-1"
           />
   	   <testparameter name="Force on H-Atom in direction of HCl axis (eV/Ang)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1.8e-5, 3)"
		   regex="Total forces\([ ]+2\)+.+([-+]?[0-9]+\.[0-9]+[eE]+[-+]?[0-9]+)"
		   occurence="-1"
           />
	</testcase>
    	<testcase name="MPB-DFT c!=0 MERM_in_SPE_solver=.true. density_update_method = density_matrix" folder="mpbdft_hcl.ion.merminspe.densmat" subfolders="./" defaultfolder="./">
	   <testparameter name="Non-meanfield Solvent-Solute Interaction (Ha)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1E-7, 3)"
		   regex="Nonelectrostatic Free Energy+[ ]+:+[ ]+([-0-9.]+) Ha"
		   occurence="-1"
           />
	   <testparameter name="Nonelectrostatic Ionic Contribution to Free Energy (Ha)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1E-7, 3)"
		   regex="Additional Nonelstatic MPBE Solvation Energy:+[ ]+([-0-9.]+) Ha"
		   occurence="-1"
           />
   	   <testparameter name="Force on H-Atom in direction of HCl axis (eV/Ang)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1.8e-5, 3)"
		   regex="Total forces\([ ]+2\)+.+([-+]?[0-9]+\.[0-9]+[eE]+[-+]?[0-9]+)"
		   occurence="-1"
           />
	</testcase>
    	<testcase name="MPB-DFT c!=0 MERM_in_SPE_solver=.false." folder="mpbdft_hcl.ion.nomerminspe" subfolders="./" defaultfolder="./">
	   <testparameter name="Non-meanfield Solvent-Solute Interaction (Ha)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1E-7, 3)"
		   regex="Nonelectrostatic Free Energy+[ ]+:+[ ]+([-0-9.]+) Ha"
		   occurence="-1"
           />
	   <testparameter name="Nonelectrostatic Ionic Contribution to Free Energy (Ha)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1E-7, 3)"
		   regex="Additional Nonelstatic MPBE Solvation Energy:+[ ]+([-0-9.]+) Ha"
		   occurence="-1"
           />
   	   <testparameter name="Force on H-Atom in direction of HCl axis (eV/Ang)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1.8e-5, 3)"
		   regex="Total forces\([ ]+2\)+.+([-+]?[0-9]+\.[0-9]+[eE]+[-+]?[0-9]+)"
		   occurence="-1"
           />
	</testcase>
    	<testcase name="MPB-DFT c=0 MERM_in_SPE_solver=.true." folder="mpbdft_hcl.noion.merminspe" subfolders="./" defaultfolder="./">
	   <testparameter name="Non-meanfield Solvent-Solute Interaction (Ha)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1E-7, 3)"
		   regex="Nonelectrostatic Free Energy+[ ]+:+[ ]+([-0-9.]+) Ha"
		   occurence="-1"
           />
   	   <testparameter name="Force on H-Atom in direction of HCl axis (eV/Ang)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1.8e-5, 3)"
		   regex="Total forces\([ ]+2\)+.+([-+]?[0-9]+\.[0-9]+[eE]+[-+]?[0-9]+)"
		   occurence="-1"
           />
	</testcase>
    	<testcase name="MPB-DFT c=0 MERM_in_SPE_solver=.false." folder="mpbdft_hcl.noion.nomerminspe" subfolders="./" defaultfolder="./">
	   <testparameter name="Non-meanfield Solvent-Solute Interaction (Ha)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1E-7, 3)"
		   regex="Nonelectrostatic Free Energy+[ ]+:+[ ]+([-0-9.]+) Ha"
		   occurence="-1"
           />
   	   <testparameter name="Force on H-Atom in direction of HCl axis (eV/Ang)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1.8e-5, 3)"
		   regex="Total forces\([ ]+2\)+.+([-+]?[0-9]+\.[0-9]+[eE]+[-+]?[0-9]+)"
		   occurence="-1"
           />
	</testcase>
    	<testcase name="MPB-DFT c=0 MERM_atom_wise=.true." folder="mpbdft_hcl.noion.merminspe.atomic" subfolders="./" defaultfolder="./">
	   <testparameter name="Non-meanfield Solvent-Solute Interaction (Ha)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1E-7, 3)"
		   regex="Nonelectrostatic Free Energy+[ ]+:+[ ]+([-0-9.]+) Ha"
		   occurence="-1"
           />
   	   <testparameter name="Force on H-Atom in direction of HCl axis (eV/Ang)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1.8e-5, 3)"
		   regex="Total forces\([ ]+2\)+.+([-+]?[0-9]+\.[0-9]+[eE]+[-+]?[0-9]+)"
		   occurence="-1"
           />
   	   <testparameter name="Force on Cl-Atom in direction of HCl axis (eV/Ang)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1.8e-5, 3)"
		   regex="Total forces\([ ]+1\)+.+([-+]?[0-9]+\.[0-9]+[eE]+[-+]?[0-9]+)"
		   occurence="-1"
           />
	</testcase>
    	<testcase name="MPB-DFT c!=0 MERM_atom_wise=.true. density_update_method = density_matrix" folder="mpbdft_hcl.ion.merminspe.atomic.densmat" subfolders="./" defaultfolder="./">
	   <testparameter name="Non-meanfield Solvent-Solute Interaction (Ha)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1E-7, 3)"
		   regex="Nonelectrostatic Free Energy+[ ]+:+[ ]+([-0-9.]+) Ha"
		   occurence="-1"
           />
   	   <testparameter name="Force on H-Atom in direction of HCl axis (eV/Ang)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1.8e-5, 3)"
		   regex="Total forces\([ ]+2\)+.+([-+]?[0-9]+\.[0-9]+[eE]+[-+]?[0-9]+)"
		   occurence="-1"
           />
   	   <testparameter name="Force on Cl-Atom in direction of HCl axis (eV/Ang)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1.8e-5, 3)"
		   regex="Total forces\([ ]+1\)+.+([-+]?[0-9]+\.[0-9]+[eE]+[-+]?[0-9]+)"
		   occurence="-1"
           />
	</testcase>
    	<testcase name="MPB-DFT c!=0 MERM_atom_wise=.true." folder="mpbdft_hcl.ion.merminspe.atomic" subfolders="./" defaultfolder="./">
	   <testparameter name="Non-meanfield Solvent-Solute Interaction (Ha)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1E-7, 3)"
		   regex="Nonelectrostatic Free Energy+[ ]+:+[ ]+([-0-9.]+) Ha"
		   occurence="-1"
           />
   	   <testparameter name="Force on H-Atom in direction of HCl axis (eV/Ang)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1.8e-5, 3)"
		   regex="Total forces\([ ]+2\)+.+([-+]?[0-9]+\.[0-9]+[eE]+[-+]?[0-9]+)"
		   occurence="-1"
           />
   	   <testparameter name="Force on Cl-Atom in direction of HCl axis (eV/Ang)"
		   file="aims.out"
		   importance="mandatory"
		   comparison="cmp_float.absvalue_diff(1.8e-5, 3)"
		   regex="Total forces\([ ]+1\)+.+([-+]?[0-9]+\.[0-9]+[eE]+[-+]?[0-9]+)"
		   occurence="-1"
           />
	</testcase>
    </testsuite>

    <testsuite name="Symmetry-SPGlib">
    	<testcase name="Si PBE spglib kpoints" folder="Si_PBE_spglib_kpoints" subfolders="./" defaultfolder="./">
	   <testparameter name="Spacegroup"
		  importance="mandatory"
		  comparison="cmp_int.abs_diff(0)"
		  regex="Space group+[ ]+:+[ ]+([-0-9.]+)"
		  occurence="-1"
	    />
	   <testparameter name="Elements in Spacegroup"
		  importance="mandatory"
		  comparison="cmp_int.abs_diff(0)"
		  regex="Number of Operations+[ ]+:+[ ]+([-0-9.]+)"
		  occurence="-1"
           />
	   <testparameter name="Number of irr. k-points"
		  importance="mandatory"
		  comparison="cmp_int.abs_diff(0)"
		  regex="Number of k-points+[ ]+:+[ ]+([-0-9.]+)"
		  occurence="-1"
           />
	   <testparameter name="Total energy 1. SCF cycle"
		  importance="mandatory"
		  comparison="cmp_float.abs_diff(1E-7, 3)"
		  regex="Total energy, T -> 0+[ ]+:+[ ]+[-0-9.]+[ ]+Ha+[ ]+([-0-9.]+) eV"
		  occurence="2"
           />
	</testcase>
    </testsuite>

   <testsuite name="Dielectric function">
       <testcase name="PbS2, PBE dielectric function without spin-orbit coupling" folder="PbS2_dielectric_noSOC">
            <testparameter name="Dielectric function, noSOC, Lorentzian"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(9, 1, comments='#')"
                file="dielectric_function_Lorentzian*.out"
            />
            <testparameter name="Dielectric function, noSOC, Gaussian"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(9, 1, comments='#')"
                file="dielectric_function_Gaussian*.out"
            />
            <testparameter name="Absorption coefficients, noSOC, Lorentzian"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E4, comments='#')"
                file="absorption_Lorentzian*.out"
            />
            <testparameter name="Absorption coefficients, noSOC, Gaussian"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E4, comments='#')"
                file="absorption_Gaussian*.out"
            />
      </testcase>
      <testcase name="PbS2, PBE dielectric function with spin-orbit coupling" folder="PbS2_dielectric_SOC">
            <testparameter name="Dielectric function, SOC, Lorentzian"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(9, 1, comments='#')"
                file="dielectric_function_soc_Lorentzian*.out"
            />
            <testparameter name="Dielectric function, SOC, Gaussian"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(9, 1, comments='#')"
                file="dielectric_function_soc_Gaussian*.out"
            />
            <testparameter name="Absorption coefficients, SOC, Lorentzian"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E4, comments='#')"
                file="absorption_soc_Lorentzian*.out"
            />
            <testparameter name="Absorption coefficients, SOC, Gaussian"
                importance="mandatory"
                comparison="cmp_file.TableFileDiff(2, 1E4, comments='#')"
                file="absorption_soc_Gaussian*.out"
            />
      </testcase>
   </testsuite>

</regressionsuite>
