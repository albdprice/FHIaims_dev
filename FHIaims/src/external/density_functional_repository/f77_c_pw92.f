c:C_PW92subrstart

c    Generated: Mon Oct 18 16:28:06 BST 2004

      subroutine uks_c_pw92
     & (ideriv,npt,rhoa1,rhob1,sigmaaa1,sigmabb1,sigmaab1,
     &  zk,vrhoa,vrhob,vsigmaaa,vsigmabb,vsigmaab,
     &  v2rhoa2,v2rhob2,v2rhoab,
     &  v2rhoasigmaaa,v2rhoasigmaab,v2rhoasigmabb,
     &  v2rhobsigmabb,v2rhobsigmaab,v2rhobsigmaaa,
     &  v2sigmaaa2,v2sigmaaaab,v2sigmaaabb,
     &  v2sigmaab2,v2sigmaabbb,v2sigmabb2)
c
c     J.P. Perdew, Y. Wang
c     Accurate and simple analytic representation of 
c     the electron-gas correlation energy
c     Phys. Rev. B 45 (1992) 13244-13249
c
c
c     CITATION:
c
c     Functionals were obtained from the Density Functional Repository 
c     as developed and distributed by the Quantum Chemistry Group, 
c     CCLRC Daresbury Laboratory, Daresbury, Cheshire, WA4 4AD 
c     United Kingdom. Contact Huub van Dam (h.j.j.vandam@dl.ac.uk) or 
c     Paul Sherwood for further information.
c
c     COPYRIGHT:
c
c     Users may incorporate the source code into software packages and
c     redistribute the source code provided the source code is not
c     changed in anyway and is properly cited in any documentation or
c     publication related to its use.
c
c     ACKNOWLEDGEMENT:
c
c     The source code was generated using Maple 8 through a modified
c     version of the dfauto script published in:
c
c        R. Strange, F.R. Manby, P.J. Knowles
c        Automatic code generation in density functional theory
c        Comp. Phys. Comm. 136 (2001) 310-318.
c
      implicit real*8 (a-h,o-z)
      integer ideriv,npt
      real*8 rhoa1(npt),rhob1(npt)
      real*8 sigmaaa1(npt),sigmabb1(npt),sigmaab1(npt)
      real*8 zk(npt),vrhoa(npt),vrhob(npt)
      real*8 vsigmaaa(npt),vsigmabb(npt),vsigmaab(npt)
      real*8 v2rhoa2(npt),v2rhob2(npt),v2rhoab(npt)
      real*8 v2rhoasigmaaa(npt),v2rhoasigmaab(npt)
      real*8 v2rhoasigmabb(npt),v2rhobsigmabb(npt)
      real*8 v2rhobsigmaab(npt),v2rhobsigmaaa(npt)
      real*8 v2sigmaaa2(npt),v2sigmaaaab(npt),v2sigmaaabb(npt)
      real*8 v2sigmaab2(npt),v2sigmaabbb(npt),v2sigmabb2(npt)
      parameter(tol=1.0d-20)
      
      if (ideriv.eq.0) then
      
      do i=1,npt
      rhoa = dmax1(0.D0,rhoa1(i))
      rhob = dmax1(0.D0,rhob1(i))
      rho = rhoa+rhob
      if(rho.gt.tol) then
      if(rhoa.lt.tol) then
      rho = rhob
      t1 = 1/rhob
      t2 = t1**(1.D0/3.D0)
      t6 = t1**(1.D0/6.D0)
      t9 = dsqrt(t1)
      t11 = t2**2
      t17 = dlog(1.D0+0.321646831778707D2/(0.1112037486309468D2*t6
     &+0.3844746237447211D1*t2+0.1644733775567609D1*t9
     &+0.2405871291288192D0*t11))
      zk(i) = -0.3109D-1*rhob*(1.D0+0.1274696188700087D0*t2)*t17
      elseif(rhob.lt.tol) then
      rho = rhoa
      t1 = 1/rhoa
      t2 = t1**(1.D0/3.D0)
      t6 = t1**(1.D0/6.D0)
      t9 = dsqrt(t1)
      t11 = t2**2
      t17 = dlog(1.D0+0.321646831778707D2/(0.1112037486309468D2*t6
     &+0.3844746237447211D1*t2+0.1644733775567609D1*t9
     &+0.2405871291288192D0*t11))
      zk(i) = -0.3109D-1*rhoa*(1.D0+0.1274696188700087D0*t2)*t17
      else ! (.not.(rhoa.lt.tol).and..not.(rhob.lt.tol))
      t1 = rhoa+rhob
      t2 = 1/t1
      t3 = t2**(1.D0/3.D0)
      t6 = t2**(1.D0/6.D0)
      t9 = dsqrt(t2)
      t11 = t3**2
      t17 = dlog(1.D0+0.160818243221511D2/(0.598255043577108D1*t6
     &+0.2225569421150687D1*t3+0.8004286349993634D0*t9
     &+0.1897004325747559D0*t11))
      t19 = 0.62182D-1*(1.D0+0.1325688999052018D0*t3)*t17
      t30 = dlog(1.D0+0.2960857464321668D2/(0.8157414703487641D1*t6
     &+0.2247591863577616D1*t3+0.4300972471276643D0*t9
     &+0.1911512595127338D0*t11))
      t33 = rhoa-1.D0*rhob
      t34 = t33*t2
      t35 = 1.D0+t34
      t36 = t35**(1.D0/3.D0)
      t39 = 1.D0-1.D0*t34
      t40 = t39**(1.D0/3.D0)
      t42 = t36*t35+t40*t39-2.D0
      t43 = t33**2
      t44 = t43**2
      t45 = t1**2
      t46 = t45**2
      t48 = t44/t46
      t64 = dlog(1.D0+0.321646831778707D2/(0.1112037486309468D2*t6
     &+0.3844746237447211D1*t3+0.1644733775567609D1*t9
     &+0.2405871291288192D0*t11))
      zk(i) = t1*(-t19+0.3799574853701528D-1*(1.D0
     &+0.6901399211255825D-1*t3)*t30*t42*(1.D0-1.D0*t48)
     &+0.1923661050931536D1*(-0.3109D-1*(1.D0+0.1274696188700087D0*t3)
     &*t64+t19)*t42*t48)
      endif ! rhoa,rhob
      else ! rho
      zk(i) = 0.0d0
      endif ! rho
      enddo
      
      else if(ideriv.eq.1) then
      
      do i=1,npt
      rhoa = dmax1(0.D0,rhoa1(i))
      rhob = dmax1(0.D0,rhob1(i))
      rho = rhoa+rhob
      if(rho.gt.tol) then
      if(rhoa.lt.tol) then
      rho = rhob
      t1 = 1/rhob
      t2 = t1**(1.D0/3.D0)
      t4 = 1.D0+0.1274696188700087D0*t2
      t5 = rhob*t4
      t6 = t1**(1.D0/6.D0)
      t9 = dsqrt(t1)
      t11 = t2**2
      t13 = 0.1112037486309468D2*t6+0.3844746237447211D1*t2
     &+0.1644733775567609D1*t9+0.2405871291288192D0*t11
      t16 = 1.D0+0.321646831778707D2/t13
      t17 = dlog(t16)
      zk(i) = -0.3109D-1*t5*t17
      vrhoa(i) = 0.D0
      t22 = 1/t11
      t26 = t13**2
      t28 = t6**2
      t29 = t28**2
      t32 = rhob**2
      t33 = 1/t32
      vrhob(i) = -0.3109D-1*t4*t17+0.1321010150222857D-2*t1*t22*t17
     &+0.1D1*t5/t26*(-0.1853395810515781D1/t29/t6*t33
     &-0.128158207914907D1*t22*t33-0.8223668877838045D0/t9*t33
     &-0.1603914194192128D0/t2*t33)/t16
      elseif(rhob.lt.tol) then
      rho = rhoa
      t1 = 1/rhoa
      t2 = t1**(1.D0/3.D0)
      t4 = 1.D0+0.1274696188700087D0*t2
      t5 = rhoa*t4
      t6 = t1**(1.D0/6.D0)
      t9 = dsqrt(t1)
      t11 = t2**2
      t13 = 0.1112037486309468D2*t6+0.3844746237447211D1*t2
     &+0.1644733775567609D1*t9+0.2405871291288192D0*t11
      t16 = 1.D0+0.321646831778707D2/t13
      t17 = dlog(t16)
      zk(i) = -0.3109D-1*t5*t17
      t22 = 1/t11
      t26 = t13**2
      t28 = t6**2
      t29 = t28**2
      t32 = rhoa**2
      t33 = 1/t32
      vrhoa(i) = -0.3109D-1*t4*t17+0.1321010150222857D-2*t1*t22*t17
     &+0.1D1*t5/t26*(-0.1853395810515781D1/t29/t6*t33
     &-0.128158207914907D1*t22*t33-0.8223668877838045D0/t9*t33
     &-0.1603914194192128D0/t2*t33)/t16
      vrhob(i) = 0.D0
      else ! (.not.(rhoa.lt.tol).and..not.(rhob.lt.tol))
      t1 = rhoa+rhob
      t2 = 1/t1
      t3 = t2**(1.D0/3.D0)
      t5 = 1.D0+0.1325688999052018D0*t3
      t6 = t2**(1.D0/6.D0)
      t9 = dsqrt(t2)
      t11 = t3**2
      t13 = 0.598255043577108D1*t6+0.2225569421150687D1*t3
     &+0.8004286349993634D0*t9+0.1897004325747559D0*t11
      t16 = 1.D0+0.160818243221511D2/t13
      t17 = dlog(t16)
      t19 = 0.62182D-1*t5*t17
      t21 = 1.D0+0.6901399211255825D-1*t3
      t26 = 0.8157414703487641D1*t6+0.2247591863577616D1*t3
     &+0.4300972471276643D0*t9+0.1911512595127338D0*t11
      t29 = 1.D0+0.2960857464321668D2/t26
      t30 = dlog(t29)
      t31 = t21*t30
      t33 = rhoa-1.D0*rhob
      t34 = t33*t2
      t35 = 1.D0+t34
      t36 = t35**(1.D0/3.D0)
      t39 = 1.D0-1.D0*t34
      t40 = t39**(1.D0/3.D0)
      t42 = t36*t35+t40*t39-2.D0
      t43 = t33**2
      t44 = t43**2
      t45 = t1**2
      t46 = t45**2
      t47 = 1/t46
      t48 = t44*t47
      t50 = 1.D0-1.D0*t48
      t53 = 0.3799574853701528D-1*t31*t42*t50
      t55 = 1.D0+0.1274696188700087D0*t3
      t60 = 0.1112037486309468D2*t6+0.3844746237447211D1*t3
     &+0.1644733775567609D1*t9+0.2405871291288192D0*t11
      t63 = 1.D0+0.321646831778707D2/t60
      t64 = dlog(t63)
      t67 = -0.3109D-1*t55*t64+t19
      t68 = t67*t42
      t70 = 0.1923661050931536D1*t68*t48
      zk(i) = t1*(-t19+t53+t70)
      t73 = 1/t45
      t74 = 1/t11*t73
      t75 = t74*t17
      t76 = 0.2747799777968419D-2*t75
      t77 = t13**2
      t80 = t6**2
      t81 = t80**2
      t84 = 1/t81/t6*t73
      t88 = 1/t9*t73
      t91 = 1/t3*t73
      t96 = t5/t77*(-0.99709173929518D0*t84-0.7418564737168958D0*t74
     &-0.4002143174996817D0*t88-0.1264669550498372D0*t91)/t16
      t97 = 0.1D1*t96
      t101 = 0.8740794299481065D-3*t74*t30*t42*t50
      t102 = t26**2
      t115 = 0.1124999956683108D1*t21/t102*(-0.135956911724794D1*t84
     &-0.7491972878592054D0*t74-0.2150486235638321D0*t88
     &-0.1274341730084892D0*t91)/t29*t42*t50
      t116 = t33*t73
      t117 = 1.D0*t116
      t121 = 1.D0*t2
      t125 = 0.1333333333333333D1*t36*(t2-t117)+0.1333333333333333D1
     &*t40*(-t121+t116)
      t130 = t43*t33*t47
      t131 = 4.D0*t130
      t134 = t44/t46/t1
      t135 = 4.D0*t134
      t142 = t60**2
      t159 = 0.1923661050931536D1*(0.1321010150222857D-2*t74*t64+0.1D1
     &*t55/t142*(-0.1853395810515781D1*t84-0.128158207914907D1*t74
     &-0.8223668877838045D0*t88-0.1603914194192128D0*t91)/t63
     &-0.2747799777968419D-2*t75-0.1D1*t96)*t42*t48
      t163 = t68*t130
      t166 = 0.7694644203726145D1*t68*t134
      vrhoa(i) = -t19+t53+t70+t1*(t76+t97-t101-t115
     &+0.3799574853701528D-1*t31*t125*t50+0.3799574853701528D-1*t31
     &*t42*(-t131+t135)+t159+0.1923661050931536D1*t67*t125*t48
     &+0.7694644203726145D1*t163-t166)
      t175 = 0.1333333333333333D1*t36*(-t121-t117)
     &+0.1333333333333333D1*t40*(t2+t116)
      vrhob(i) = -t19+t53+t70+t1*(t76+t97-t101-t115
     &+0.3799574853701528D-1*t31*t175*t50+0.3799574853701528D-1*t31
     &*t42*(t131+t135)+t159+0.1923661050931536D1*t67*t175*t48
     &-0.7694644203726145D1*t163-t166)
      endif ! rhoa,rhob
      else ! rho
      zk(i) = 0.0d0
      vrhoa(i) = 0.0d0
      vrhob(i) = 0.0d0
      endif ! rho
      enddo
      
      else if(ideriv.eq.2) then
      
      do i=1,npt
      rhoa = dmax1(0.D0,rhoa1(i))
      rhob = dmax1(0.D0,rhob1(i))
      rho = rhoa+rhob
      if(rho.gt.tol) then
      if(rhoa.lt.tol) then
      rho = rhob
      t1 = 1/rhob
      t2 = t1**(1.D0/3.D0)
      t4 = 1.D0+0.1274696188700087D0*t2
      t5 = rhob*t4
      t6 = t1**(1.D0/6.D0)
      t9 = dsqrt(t1)
      t11 = t2**2
      t13 = 0.1112037486309468D2*t6+0.3844746237447211D1*t2
     &+0.1644733775567609D1*t9+0.2405871291288192D0*t11
      t16 = 1.D0+0.321646831778707D2/t13
      t17 = dlog(t16)
      zk(i) = -0.3109D-1*t5*t17
      vrhoa(i) = 0.D0
      t22 = 1/t11
      t23 = t1*t22
      t26 = t13**2
      t27 = 1/t26
      t28 = t6**2
      t29 = t28**2
      t30 = t29*t6
      t31 = 1/t30
      t32 = rhob**2
      t33 = 1/t32
      t38 = 1/t9
      t41 = 1/t2
      t44 = -0.1853395810515781D1*t31*t33-0.128158207914907D1*t22*t33
     &-0.8223668877838045D0*t38*t33-0.1603914194192128D0*t41*t33
      t46 = 1/t16
      t47 = t27*t44*t46
      vrhob(i) = -0.3109D-1*t4*t17+0.1321010150222857D-2*t23*t17+0.1D1
     &*t5*t47
      v2rhoa2(i) = 0.D0
      v2rhoab(i) = 0.D0
      t55 = 1/t32/rhob
      t57 = 1/t11/t1
      t65 = t44**2
      t72 = t32**2
      t73 = 1/t72
      t99 = t26**2
      t102 = t16**2
      v2rhob2(i) = 0.2D1*t4*t27*t44*t46+0.8806734334819047D-3*t55*t57
     &*t17-0.8497974591333914D-1*t23*t47-0.2D1*t5/t26/t13*t65*t46
     &+0.1D1*t5*t27*(-0.1544496508763151D1/t30/t1*t73
     &+0.3706791621031562D1*t31*t55-0.854388052766047D0*t57*t73
     &+0.2563164158298141D1*t22*t55-0.4111834438919023D0/t9/t1*t73
     &+0.1644733775567609D1*t38*t55-0.5346380647307093D-1/t2/t1*t73
     &+0.3207828388384256D0*t41*t55)*t46+0.321646831778707D2*t5/t99
     &*t65/t102
      elseif(rhob.lt.tol) then
      rho = rhoa
      t1 = 1/rhoa
      t2 = t1**(1.D0/3.D0)
      t4 = 1.D0+0.1274696188700087D0*t2
      t5 = rhoa*t4
      t6 = t1**(1.D0/6.D0)
      t9 = dsqrt(t1)
      t11 = t2**2
      t13 = 0.1112037486309468D2*t6+0.3844746237447211D1*t2
     &+0.1644733775567609D1*t9+0.2405871291288192D0*t11
      t16 = 1.D0+0.321646831778707D2/t13
      t17 = dlog(t16)
      zk(i) = -0.3109D-1*t5*t17
      t22 = 1/t11
      t23 = t1*t22
      t26 = t13**2
      t27 = 1/t26
      t28 = t6**2
      t29 = t28**2
      t30 = t29*t6
      t31 = 1/t30
      t32 = rhoa**2
      t33 = 1/t32
      t38 = 1/t9
      t41 = 1/t2
      t44 = -0.1853395810515781D1*t31*t33-0.128158207914907D1*t22*t33
     &-0.8223668877838045D0*t38*t33-0.1603914194192128D0*t41*t33
      t46 = 1/t16
      t47 = t27*t44*t46
      vrhoa(i) = -0.3109D-1*t4*t17+0.1321010150222857D-2*t23*t17+0.1D1
     &*t5*t47
      vrhob(i) = 0.D0
      t55 = 1/t32/rhoa
      t57 = 1/t11/t1
      t65 = t44**2
      t72 = t32**2
      t73 = 1/t72
      t99 = t26**2
      t102 = t16**2
      v2rhoa2(i) = 0.2D1*t4*t27*t44*t46+0.8806734334819047D-3*t55*t57
     &*t17-0.8497974591333914D-1*t23*t47-0.2D1*t5/t26/t13*t65*t46
     &+0.1D1*t5*t27*(-0.1544496508763151D1/t30/t1*t73
     &+0.3706791621031562D1*t31*t55-0.854388052766047D0*t57*t73
     &+0.2563164158298141D1*t22*t55-0.4111834438919023D0/t9/t1*t73
     &+0.1644733775567609D1*t38*t55-0.5346380647307093D-1/t2/t1*t73
     &+0.3207828388384256D0*t41*t55)*t46+0.321646831778707D2*t5/t99
     &*t65/t102
      v2rhob2(i) = 0.D0
      v2rhoab(i) = 0.D0
      else ! (.not.(rhoa.lt.tol).and..not.(rhob.lt.tol))
      t1 = rhoa+rhob
      t2 = 1/t1
      t3 = t2**(1.D0/3.D0)
      t5 = 1.D0+0.1325688999052018D0*t3
      t6 = t2**(1.D0/6.D0)
      t9 = dsqrt(t2)
      t11 = t3**2
      t13 = 0.598255043577108D1*t6+0.2225569421150687D1*t3
     &+0.8004286349993634D0*t9+0.1897004325747559D0*t11
      t16 = 1.D0+0.160818243221511D2/t13
      t17 = dlog(t16)
      t19 = 0.62182D-1*t5*t17
      t21 = 1.D0+0.6901399211255825D-1*t3
      t26 = 0.8157414703487641D1*t6+0.2247591863577616D1*t3
     &+0.4300972471276643D0*t9+0.1911512595127338D0*t11
      t29 = 1.D0+0.2960857464321668D2/t26
      t30 = dlog(t29)
      t31 = t21*t30
      t33 = rhoa-1.D0*rhob
      t34 = t33*t2
      t35 = 1.D0+t34
      t36 = t35**(1.D0/3.D0)
      t39 = 1.D0-1.D0*t34
      t40 = t39**(1.D0/3.D0)
      t42 = t36*t35+t40*t39-2.D0
      t43 = t33**2
      t44 = t43**2
      t45 = t1**2
      t46 = t45**2
      t47 = 1/t46
      t48 = t44*t47
      t50 = 1.D0-1.D0*t48
      t51 = t42*t50
      t53 = 0.3799574853701528D-1*t31*t51
      t55 = 1.D0+0.1274696188700087D0*t3
      t60 = 0.1112037486309468D2*t6+0.3844746237447211D1*t3
     &+0.1644733775567609D1*t9+0.2405871291288192D0*t11
      t63 = 1.D0+0.321646831778707D2/t60
      t64 = dlog(t63)
      t67 = -0.3109D-1*t55*t64+t19
      t68 = t67*t42
      t70 = 0.1923661050931536D1*t68*t48
      zk(i) = t1*(-t19+t53+t70)
      t72 = 1/t11
      t73 = 1/t45
      t74 = t72*t73
      t75 = t74*t17
      t76 = 0.2747799777968419D-2*t75
      t77 = t13**2
      t78 = 1/t77
      t79 = t5*t78
      t80 = t6**2
      t81 = t80**2
      t82 = t81*t6
      t83 = 1/t82
      t84 = t83*t73
      t87 = 1/t9
      t88 = t87*t73
      t90 = 1/t3
      t91 = t90*t73
      t93 = -0.99709173929518D0*t84-0.7418564737168958D0*t74
     &-0.4002143174996817D0*t88-0.1264669550498372D0*t91
      t94 = 1/t16
      t96 = t79*t93*t94
      t97 = 0.1D1*t96
      t98 = t30*t42
      t99 = t98*t50
      t100 = t74*t99
      t101 = 0.8740794299481065D-3*t100
      t102 = t26**2
      t103 = 1/t102
      t104 = t21*t103
      t109 = -0.135956911724794D1*t84-0.7491972878592054D0*t74
     &-0.2150486235638321D0*t88-0.1274341730084892D0*t91
      t110 = t104*t109
      t111 = 1/t29
      t112 = t111*t42
      t113 = t112*t50
      t114 = t110*t113
      t115 = 0.1124999956683108D1*t114
      t116 = t33*t73
      t117 = 1.D0*t116
      t118 = t2-t117
      t121 = 1.D0*t2
      t122 = -t121+t116
      t125 = 0.1333333333333333D1*t36*t118+0.1333333333333333D1*t40*t122
      t127 = t31*t125*t50
      t128 = 0.3799574853701528D-1*t127
      t129 = t43*t33
      t130 = t129*t47
      t131 = 4.D0*t130
      t133 = 1/t46/t1
      t134 = t44*t133
      t135 = 4.D0*t134
      t136 = -t131+t135
      t138 = t31*t42*t136
      t139 = 0.3799574853701528D-1*t138
      t142 = t60**2
      t143 = 1/t142
      t144 = t55*t143
      t149 = -0.1853395810515781D1*t84-0.128158207914907D1*t74
     &-0.8223668877838045D0*t88-0.1603914194192128D0*t91
      t150 = 1/t63
      t156 = 0.1321010150222857D-2*t74*t64+0.1D1*t144*t149*t150
     &-0.2747799777968419D-2*t75-0.1D1*t96
      t157 = t156*t42
      t158 = t157*t48
      t159 = 0.1923661050931536D1*t158
      t160 = t67*t125
      t161 = t160*t48
      t162 = 0.1923661050931536D1*t161
      t163 = t68*t130
      t165 = t68*t134
      t166 = 0.7694644203726145D1*t165
      vrhoa(i) = -t19+t53+t70+t1*(t76+t97-t101-t115+t128+t139+t159
     &+t162+0.7694644203726145D1*t163-t166)
      t169 = -t121-t117
      t172 = t2+t116
      t175 = 0.1333333333333333D1*t36*t169+0.1333333333333333D1*t40*t172
      t177 = t31*t175*t50
      t178 = 0.3799574853701528D-1*t177
      t179 = t131+t135
      t181 = t31*t42*t179
      t182 = 0.3799574853701528D-1*t181
      t183 = t67*t175
      t184 = t183*t48
      t185 = 0.1923661050931536D1*t184
      vrhob(i) = -t19+t53+t70+t1*(t76+t97-t101-t115+t178+t182+t159
     &+t185-0.7694644203726145D1*t163-t166)
      t189 = 0.5495599555936838D-2*t75
      t190 = 0.2D1*t96
      t191 = 0.1748158859896213D-2*t100
      t192 = 0.2249999913366216D1*t114
      t195 = 0.3847322101863073D1*t158
      t198 = 0.1538928840745229D2*t165
      t199 = t36**2
      t200 = 1/t199
      t201 = t118**2
      t204 = 2.D0*t73
      t206 = 1/t45/t1
      t208 = 2.D0*t33*t206
      t209 = -t204+t208
      t212 = t40**2
      t213 = 1/t212
      t214 = t122**2
      t220 = 0.4444444444444444D0*t200*t201+0.1333333333333333D1*t36
     &*t209+0.4444444444444444D0*t213*t214-0.1333333333333333D1*t40*t209
      t226 = 1/t11/t2*t47
      t228 = 0.5827196199654043D-3*t226*t99
      t229 = t43*t47
      t230 = t68*t229
      t231 = 0.2308393261117844D2*t230
      t234 = t44/t46/t45
      t236 = 0.3847322101863073D2*t68*t234
      t238 = 0.1538928840745229D2*t157*t134
      t239 = t129*t133
      t240 = t68*t239
      t242 = t77**2
      t245 = t93**2
      t246 = t16**2
      t249 = t5/t242*t245/t246
      t250 = 0.160818243221511D2*t249
      t255 = t5/t77/t13*t245*t94
      t256 = 0.2D1*t255
      t259 = 1/t82/t2*t47
      t261 = t83*t206
      t264 = t72*t206
      t268 = 1/t9/t2*t47
      t270 = t87*t206
      t274 = 1/t3/t2*t47
      t276 = t90*t206
      t280 = t79*(-0.8309097827459833D0*t259+0.199418347859036D1*t261
     &-0.4945709824779306D0*t226+0.1483712947433792D1*t264
     &-0.2001071587498409D0*t268+0.8004286349993634D0*t270
     &-0.4215565168327908D-1*t274+0.2529339100996745D0*t276)*t94
      t281 = 0.1D1*t280
      t282 = 12.D0*t229
      t283 = 32.D0*t239
      t284 = 20.D0*t234
      t300 = t149**2
      t316 = t142**2
      t319 = t63**2
      t324 = t226*t17
      t326 = t264*t17
      t330 = t74*t78*t93*t94
      t335 = 0.8806734334819047D-3*t226*t64-0.2642020300445714D-2*t264
     &*t64-0.8497974591333914D-1*t74*t143*t149*t150-0.2D1*t55/t142/t60
     &*t300*t150+0.1D1*t144*(-0.1544496508763151D1*t259
     &+0.3706791621031562D1*t261-0.854388052766047D0*t226
     &+0.2563164158298141D1*t264-0.4111834438919023D0*t268
     &+0.1644733775567609D1*t270-0.5346380647307093D-1*t274
     &+0.3207828388384256D0*t276)*t150+0.321646831778707D2*t55/t316
     &*t300/t319-0.1831866518645613D-2*t324+0.5495599555936838D-2*t326
     &+0.8837926660346786D-1*t330+0.2D1*t255-0.1D1*t280
     &-0.160818243221511D2*t249
      t338 = 0.1923661050931536D1*t335*t42*t48
      t345 = t157*t130
      t347 = 0.3799574853701528D-1*t31*t220*t50-t228+t231+t236-t238
     &-0.6155715362980916D2*t240+t250-t256+t281+0.3799574853701528D-1
     &*t31*t42*(-t282+t283-t284)+t338+0.7599149707403056D-1*t31*t125
     &*t136+0.1923661050931536D1*t67*t220*t48+0.1538928840745229D2*t345
      t348 = t160*t130
      t350 = 0.1831866518645613D-2*t324
      t351 = 0.5495599555936838D-2*t326
      t353 = 0.1748158859896213D-2*t264*t99
      t354 = t160*t134
      t357 = t74*t98*t136
      t361 = t74*t30*t125*t50
      t366 = t109**2
      t369 = 0.2249999913366216D1*t21/t102/t26*t366*t113
      t374 = 0.5176049209143758D-1*t74*t103*t109*t111*t51
      t375 = 0.8837926660346786D-1*t330
      t376 = t102**2
      t380 = t29**2
      t385 = 0.3330964519106732D2*t21/t376*t366/t380*t42*t50
      t388 = t110*t111*t125*t50
      t391 = t110*t112*t136
      t404 = 0.1124999956683108D1*t104*(-0.1132974264373283D1*t259
     &+0.271913823449588D1*t261-0.4994648585728036D0*t226
     &+0.1498394575718411D1*t264-0.1075243117819161D0*t268
     &+0.4300972471276643D0*t270-0.4247805766949639D-1*t274
     &+0.2548683460169784D0*t276)*t113
      t406 = t156*t125*t48
      t408 = 0.1538928840745229D2*t348+t350-t351+t353
     &-0.1538928840745229D2*t354-0.1748158859896213D-2*t357
     &-0.1748158859896213D-2*t361+t369+t374-t375-t385
     &-0.2249999913366216D1*t388-0.2249999913366216D1*t391-t404
     &+0.3847322101863073D1*t406
      v2rhoa2(i) = t189+t190-t191-t192+0.7599149707403056D-1*t127
     &+0.7599149707403056D-1*t138+t195+0.3847322101863073D1*t161
     &+0.1538928840745229D2*t163-t198+t1*(t347+t408)
      t415 = t169**2
      t418 = t204+t208
      t421 = t172**2
      t427 = 0.4444444444444444D0*t200*t415+0.1333333333333333D1*t36
     &*t418+0.4444444444444444D0*t213*t421-0.1333333333333333D1*t40*t418
      t439 = t156*t175*t48
      t441 = t183*t134
      t443 = t183*t130
      t450 = t110*t111*t175*t50
      t453 = 0.3799574853701528D-1*t31*t427*t50+0.7599149707403056D-1
     &*t31*t175*t179+0.3799574853701528D-1*t31*t42*(-t282-t283-t284)
     &+0.3847322101863073D1*t439-0.1538928840745229D2*t441
     &-0.1538928840745229D2*t443+0.1923661050931536D1*t67*t427*t48
     &-0.2249999913366216D1*t450-t228+t231+t236-t238
     &+0.6155715362980916D2*t240+t250
      t456 = t74*t98*t179
      t460 = t74*t30*t175*t50
      t463 = t110*t112*t179
      t465 = -t256+t281+t338-0.1538928840745229D2*t345+t350-t351+t353
     &+t369+t374-t375-t385-t404-0.1748158859896213D-2*t456
     &-0.1748158859896213D-2*t460-0.2249999913366216D1*t463
      v2rhob2(i) = t189+t190-t191-t192+0.7599149707403056D-1*t177
     &+0.7599149707403056D-1*t181+t195+0.3847322101863073D1*t184
     &-0.1538928840745229D2*t163-t198+t1*(t453+t465)
      t484 = 0.4444444444444444D0*t200*t118*t169+0.2666666666666667D1
     &*t36*t33*t206+0.4444444444444444D0*t213*t122*t172
     &-0.2666666666666667D1*t40*t33*t206
      t502 = 0.1923661050931536D1*t439-0.7694644203726145D1*t441
     &+0.7694644203726145D1*t443-0.1124999956683108D1*t450
     &+0.3799574853701528D-1*t31*t484*t50+0.3799574853701528D-1*t31
     &*t125*t179+0.3799574853701528D-1*t31*t175*t136
     &+0.3799574853701528D-1*t31*t42*(t282-t284)+0.1923661050931536D1
     &*t67*t484*t48-t228-0.2308393261117844D2*t230+t236-t238+t250-t256
     &+t281+t338
      t513 = -0.7694644203726145D1*t348+t350-t351+t353
     &-0.7694644203726145D1*t354-0.8740794299481065D-3*t357
     &-0.8740794299481065D-3*t361+t369+t374-t375-t385
     &-0.1124999956683108D1*t388-0.1124999956683108D1*t391-t404
     &+0.1923661050931536D1*t406-0.8740794299481065D-3*t456
     &-0.8740794299481065D-3*t460-0.1124999956683108D1*t463
      v2rhoab(i) = t189+t190-t191-t192+t178+t182+t195+t185-t198+t128
     &+t139+t162+t1*(t502+t513)
      endif ! rhoa,rhob
      else ! rho
      zk(i) = 0.0d0
      vrhoa(i) = 0.0d0
      vrhob(i) = 0.0d0
      v2rhoa2(i) = 0.0d0
      v2rhob2(i) = 0.0d0
      v2rhoab(i) = 0.0d0
      endif ! rho
      enddo
      
      endif ! ideriv
      return
      end
      
      
      subroutine rks_c_pw92
     & (ideriv,npt,rhoa1,sigmaaa1,
     &  zk,vrhoa,vsigmaaa,
     &  v2rhoa2,v2rhoasigmaaa,v2sigmaaa2)
c
c     J.P. Perdew, Y. Wang
c     Accurate and simple analytic representation of 
c     the electron-gas correlation energy
c     Phys. Rev. B 45 (1992) 13244-13249
c
c
c     CITATION:
c
c     Functionals were obtained from the Density Functional Repository 
c     as developed and distributed by the Quantum Chemistry Group, 
c     CCLRC Daresbury Laboratory, Daresbury, Cheshire, WA4 4AD 
c     United Kingdom. Contact Huub van Dam (h.j.j.vandam@dl.ac.uk) or 
c     Paul Sherwood for further information.
c
c     COPYRIGHT:
c
c     Users may incorporate the source code into software packages and
c     redistribute the source code provided the source code is not
c     changed in anyway and is properly cited in any documentation or
c     publication related to its use.
c
c     ACKNOWLEDGEMENT:
c
c     The source code was generated using Maple 8 through a modified
c     version of the dfauto script published in:
c
c        R. Strange, F.R. Manby, P.J. Knowles
c        Automatic code generation in density functional theory
c        Comp. Phys. Comm. 136 (2001) 310-318.
c
      implicit real*8 (a-h,o-z)
      integer ideriv,npt
      real*8 rhoa1(npt)
      real*8 sigmaaa1(npt)
      real*8 zk(npt),vrhoa(npt),vsigmaaa(npt)
      real*8 v2rhoa2(npt),v2rhoasigmaaa(npt),v2sigmaaa2(npt)
      parameter(tol=1.0d-20)
      
      if(ideriv.eq.0) then
      
      do i=1,npt
      rho = dmax1(0.D0,rhoa1(i))
      if(rho.gt.tol) then
      t1 = 1/rho
      t2 = t1**(1.D0/3.D0)
      t6 = t1**(1.D0/6.D0)
      t9 = dsqrt(t1)
      t11 = t2**2
      t17 = dlog(1.D0+0.160818243221511D2/(0.598255043577108D1*t6
     &+0.2225569421150687D1*t2+0.8004286349993634D0*t9
     &+0.1897004325747559D0*t11))
      zk(i) = -0.62182D-1*rho*(1.D0+0.1325688999052018D0*t2)*t17
      else ! rho
      zk(i) = 0.0d0
      endif ! rho
      enddo
      
      else if(ideriv.eq.1) then
      
      do i=1,npt
      rho = dmax1(0.D0,rhoa1(i))
      if(rho.gt.tol) then
      t1 = 1/rho
      t2 = t1**(1.D0/3.D0)
      t4 = 1.D0+0.1325688999052018D0*t2
      t6 = t1**(1.D0/6.D0)
      t9 = dsqrt(t1)
      t11 = t2**2
      t13 = 0.598255043577108D1*t6+0.2225569421150687D1*t2
     &+0.8004286349993634D0*t9+0.1897004325747559D0*t11
      t16 = 1.D0+0.160818243221511D2/t13
      t17 = dlog(t16)
      zk(i) = -0.62182D-1*rho*t4*t17
      t23 = rho**2
      t24 = 1/t23
      t25 = 1/t11*t24
      t28 = t13**2
      t31 = t6**2
      t32 = t31**2
      vrhoa(i) = -0.62182D-1*t4*t17+rho*(0.2747799777968419D-2*t25*t17
     &+0.1D1*t4/t28*(-0.99709173929518D0/t32/t6*t24
     &-0.7418564737168958D0*t25-0.4002143174996817D0/t9*t24
     &-0.1264669550498372D0/t2*t24)/t16)
      else ! rho
      zk(i) = 0.0d0
      vrhoa(i) = 0.0d0
      endif ! rho
      enddo
      
      else if(ideriv.eq.2) then
      
      do i=1,npt
      rho = dmax1(0.D0,rhoa1(i))
      if(rho.gt.tol) then
      t1 = 1/rho
      t2 = t1**(1.D0/3.D0)
      t4 = 1.D0+0.1325688999052018D0*t2
      t6 = t1**(1.D0/6.D0)
      t9 = dsqrt(t1)
      t11 = t2**2
      t13 = 0.598255043577108D1*t6+0.2225569421150687D1*t2
     &+0.8004286349993634D0*t9+0.1897004325747559D0*t11
      t16 = 1.D0+0.160818243221511D2/t13
      t17 = dlog(t16)
      zk(i) = -0.62182D-1*rho*t4*t17
      t22 = 1/t11
      t23 = rho**2
      t24 = 1/t23
      t25 = t22*t24
      t26 = t25*t17
      t28 = t13**2
      t29 = 1/t28
      t30 = t4*t29
      t31 = t6**2
      t32 = t31**2
      t33 = t32*t6
      t34 = 1/t33
      t38 = 1/t9
      t41 = 1/t2
      t44 = -0.99709173929518D0*t34*t24-0.7418564737168958D0*t25
     &-0.4002143174996817D0*t38*t24-0.1264669550498372D0*t41*t24
      t45 = 1/t16
      t47 = t30*t44*t45
      vrhoa(i) = -0.62182D-1*t4*t17+rho*(0.2747799777968419D-2*t26
     &+0.1D1*t47)
      t55 = t23**2
      t56 = 1/t55
      t57 = 1/t11/t1*t56
      t59 = 0.1831866518645613D-2*t57*t17
      t61 = 1/t23/rho
      t62 = t22*t61
      t64 = 0.5495599555936838D-2*t62*t17
      t75 = dlog(1.D0+0.2960857464321668D2/(0.8157414703487641D1*t6
     &+0.2247591863577616D1*t2+0.4300972471276643D0*t9
     &+0.1911512595127338D0*t11))
      t77 = (1.D0+0.6901399211255825D-1*t2)*t75*t24
      t82 = 0.8837926660346786D-1*t25*t29*t44*t45
      t83 = t28**2
      t86 = t44**2
      t87 = t16**2
      t91 = 0.160818243221511D2*t4/t83*t86/t87
      t115 = 0.1D1*t30*(-0.8309097827459833D0/t33/t1*t56
     &+0.199418347859036D1*t34*t61-0.4945709824779306D0*t57
     &+0.1483712947433792D1*t62-0.2001071587498409D0/t9/t1*t56
     &+0.8004286349993634D0*t38*t61-0.4215565168327908D-1/t2/t1*t56
     &+0.2529339100996745D0*t41*t61)*t45
      t121 = 0.2D1*t4/t28/t13*t86*t45
      v2rhoa2(i) = 0.4D1*t47+0.1099119911187368D-1*t26+rho*(t59-t64
     &+0.3377399869956914D-1*t77-t82+t91+t115-t121)+rho*(t59-t64
     &-0.3377399869956914D-1*t77-t82+t91+t115-t121)
      else ! rho
      zk(i) = 0.0d0
      vrhoa(i) = 0.0d0
      v2rhoa2(i) = 0.0d0
      endif ! rho
      enddo
      
      endif ! ideriv
      return
      end

c:C_PW92subrend
