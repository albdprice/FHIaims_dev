c:XC_PW91subrstart

c    Generated: Mon Nov 19 16:11:21 GMT 2007

      subroutine uks_xc_pw91
     & (ideriv,npt,rhoa1,rhob1,sigmaaa1,sigmabb1,sigmaab1,
     &  zk,vrhoa,vrhob,vsigmaaa,vsigmabb,vsigmaab,
     &  v2rhoa2,v2rhob2,v2rhoab,
     &  v2rhoasigmaaa,v2rhoasigmaab,v2rhoasigmabb,
     &  v2rhobsigmabb,v2rhobsigmaab,v2rhobsigmaaa,
     &  v2sigmaaa2,v2sigmaaaab,v2sigmaaabb,
     &  v2sigmaab2,v2sigmaabbb,v2sigmabb2)
c
c     J.P. Perdew, J.A. Chevary, S.H. Vosko, K.A. Jackson,
c     M.R. Pederson, D.J. Singh, C. Fiolhais
c     Atoms, molecules, solids and surfaces:
c     Applications of the generalized gradient approximation
c     for exchange and correlation
c     Phys. Rev. B 46 (1992) 6671--6687
c
c
c     CITATION:
c
c     Functionals were obtained from the Density Functional Repository 
c     as developed and distributed by the Quantum Chemistry Group, 
c     CCLRC Daresbury Laboratory, Daresbury, Cheshire, WA4 4AD 
c     United Kingdom. Contact Huub van Dam (h.j.j.vandam@dl.ac.uk) or 
c     Paul Sherwood for further information.
c
c     COPYRIGHT:
c
c     Users may incorporate the source code into software packages and
c     redistribute the source code provided the source code is not
c     changed in anyway and is properly cited in any documentation or
c     publication related to its use.
c
c     ACKNOWLEDGEMENT:
c
c     The source code was generated using Maple 8 through a modified
c     version of the dfauto script published in:
c
c        R. Strange, F.R. Manby, P.J. Knowles
c        Automatic code generation in density functional theory
c        Comp. Phys. Comm. 136 (2001) 310-318.
c
      implicit real*8 (a-h,o-z)
      integer ideriv,npt
      real*8 rhoa1(npt),rhob1(npt)
      real*8 sigmaaa1(npt),sigmabb1(npt),sigmaab1(npt)
      real*8 zk(npt),vrhoa(npt),vrhob(npt)
      real*8 vsigmaaa(npt),vsigmabb(npt),vsigmaab(npt)
      real*8 v2rhoa2(npt),v2rhob2(npt),v2rhoab(npt)
      real*8 v2rhoasigmaaa(npt),v2rhoasigmaab(npt)
      real*8 v2rhoasigmabb(npt),v2rhobsigmabb(npt)
      real*8 v2rhobsigmaab(npt),v2rhobsigmaaa(npt)
      real*8 v2sigmaaa2(npt),v2sigmaaaab(npt),v2sigmaaabb(npt)
      real*8 v2sigmaab2(npt),v2sigmaabbb(npt),v2sigmabb2(npt)
      parameter(tol=1.0d-20)
      
      if (ideriv.eq.0) then
      
      do i=1,npt
      rhoa = dmax1(0.D0,rhoa1(i))
      rhob = dmax1(0.D0,rhob1(i))
      rho = rhoa+rhob
      if(rho.gt.tol) then
      if(rhoa.lt.tol) then
      rho = rhob
      sigmabb = dmax1(0.D0,sigmabb1(i))
      sigma = sigmabb
      t2 = rhob**(1.D0/3.D0)
      t3 = t2*rhob
      t4 = dsqrt(sigmabb)
      t6 = t4/t3
      t8 = dlog(0.1000005877780776D1*t6+dsqrt(1+0.10000117555961D1*t6*
     &*2))
      t10 = 0.2520026100493014D-1*t6*t8
      t11 = rhob**2
      t12 = t2**2
      t14 = 1/t12/t11
      t17 = dexp(-0.1645530784602056D1*sigmabb*t14)
      t25 = sigmabb**2
      t26 = t11**2
      t36 = 1/rhob
      t37 = t36**(1.D0/3.D0)
      t40 = t36**(1.D0/6.D0)
      t43 = dsqrt(t36)
      t45 = t37**2
      t51 = dlog(1.D0+0.321646831778707D2/(0.1112037486309468D2*t40
     &+0.3844746237447211D1*t37+0.1644733775567609D1*t43
     &+0.2405871291288192D0*t45))
      t52 = (1.D0+0.1274696188700087D0*t37)*t51
      t55 = 1/t2/t11
      t59 = dexp(0.2513789108010112D1*t52)
      t60 = t59-1.D0
      t61 = 1/t60
      t64 = 1/t12/t26
      t71 = t60**2
      t81 = dlog(1.D0+0.2697586091519874D1*(0.1007494971260294D0
     &*sigmabb*t55+0.2738174287780083D-1*t61*t25*t64)/(1.D0
     &+0.2717804421747983D0*t61*sigmabb*t55+0.7386460874872889D-1/t71
     &*t25*t64))
      zk(i) = -0.9305257363491D0*t3*(1.D0+t10+0.1645530784602056D-1*
     &(0.2743D0-0.1508D0*t17)*sigmabb*t14)/(1.D0+t10
     &+0.1083108625229223D-5*t25/t2/t26/rhob)+rhob*(-0.3109D-1*t52
     &+0.1236778371778789D-1*t81+0.7937005259840997D0*(0.1D-2*
     &(0.2568D1+0.1443307452126544D2*t37+0.2843543831490386D-2*t45)/
     &(1.D0+0.5411317332115466D1*t37+0.1816419932959077D0*t45
     &+0.1763993811759022D-1*t36)-0.1853571428571429D-2)*sigmabb*t55
     &*t17)
      elseif(rhob.lt.tol) then
      rho = rhoa
      sigmaaa = dmax1(0.D0,sigmaaa1(i))
      sigma = sigmaaa
      t2 = rhoa**(1.D0/3.D0)
      t3 = t2*rhoa
      t4 = dsqrt(sigmaaa)
      t6 = t4/t3
      t8 = dlog(0.1000005877780776D1*t6+dsqrt(1+0.10000117555961D1*t6*
     &*2))
      t10 = 0.2520026100493014D-1*t6*t8
      t11 = rhoa**2
      t12 = t2**2
      t14 = 1/t12/t11
      t17 = dexp(-0.1645530784602056D1*sigmaaa*t14)
      t25 = sigmaaa**2
      t26 = t11**2
      t36 = 1/rhoa
      t37 = t36**(1.D0/3.D0)
      t40 = t36**(1.D0/6.D0)
      t43 = dsqrt(t36)
      t45 = t37**2
      t51 = dlog(1.D0+0.321646831778707D2/(0.1112037486309468D2*t40
     &+0.3844746237447211D1*t37+0.1644733775567609D1*t43
     &+0.2405871291288192D0*t45))
      t52 = (1.D0+0.1274696188700087D0*t37)*t51
      t55 = 1/t2/t11
      t59 = dexp(0.2513789108010112D1*t52)
      t60 = t59-1.D0
      t61 = 1/t60
      t64 = 1/t12/t26
      t71 = t60**2
      t81 = dlog(1.D0+0.2697586091519874D1*(0.1007494971260294D0
     &*sigmaaa*t55+0.2738174287780083D-1*t61*t25*t64)/(1.D0
     &+0.2717804421747983D0*t61*sigmaaa*t55+0.7386460874872889D-1/t71
     &*t25*t64))
      zk(i) = -0.9305257363491D0*t3*(1.D0+t10+0.1645530784602056D-1*
     &(0.2743D0-0.1508D0*t17)*sigmaaa*t14)/(1.D0+t10
     &+0.1083108625229223D-5*t25/t2/t26/rhoa)+rhoa*(-0.3109D-1*t52
     &+0.1236778371778789D-1*t81+0.7937005259840997D0*(0.1D-2*
     &(0.2568D1+0.1443307452126544D2*t37+0.2843543831490386D-2*t45)/
     &(1.D0+0.5411317332115466D1*t37+0.1816419932959077D0*t45
     &+0.1763993811759022D-1*t36)-0.1853571428571429D-2)*sigmaaa*t55
     &*t17)
      else ! (.not.(rhoa.lt.tol).and..not.(rhob.lt.tol))
      sigmaaa = dmax1(0.D0,sigmaaa1(i))
      sigmaab = sigmaab1(i)
      sigmabb = dmax1(0.D0,sigmabb1(i))
      sigma = sigmaaa+sigmabb+2.D0*sigmaab
      t4 = rhoa**(1.D0/3.D0)
      t5 = t4*rhoa
      t6 = dsqrt(sigmaaa)
      t8 = t6/t5
      t10 = dlog(0.1000005877780776D1*t8+dsqrt(1+0.10000117555961D1*t8
     &**2))
      t12 = 0.2520026100493014D-1*t8*t10
      t13 = rhoa**2
      t14 = t4**2
      t16 = 1/t14/t13
      t19 = dexp(-0.1645530784602056D1*sigmaaa*t16)
      t27 = sigmaaa**2
      t28 = t13**2
      t38 = rhob**(1.D0/3.D0)
      t39 = t38*rhob
      t40 = dsqrt(sigmabb)
      t42 = t40/t39
      t44 = dlog(0.1000005877780776D1*t42+dsqrt(1+0.10000117555961D1
     &*t42**2))
      t46 = 0.2520026100493014D-1*t42*t44
      t47 = rhob**2
      t48 = t38**2
      t50 = 1/t48/t47
      t53 = dexp(-0.1645530784602056D1*sigmabb*t50)
      t61 = sigmabb**2
      t62 = t47**2
      t72 = 1/rho
      t73 = t72**(1.D0/3.D0)
      t76 = t72**(1.D0/6.D0)
      t79 = dsqrt(t72)
      t81 = t73**2
      t87 = dlog(1.D0+0.160818243221511D2/(0.598255043577108D1*t76
     &+0.2225569421150687D1*t73+0.8004286349993634D0*t79
     &+0.1897004325747559D0*t81))
      t89 = 0.62182D-1*(1.D0+0.1325688999052018D0*t73)*t87
      t100 = dlog(1.D0+0.2960857464321668D2/(0.8157414703487641D1*t76
     &+0.2247591863577616D1*t73+0.4300972471276643D0*t79
     &+0.1911512595127338D0*t81))
      t103 = rhoa-1.D0*rhob
      t104 = t103*t72
      t105 = 1.D0+t104
      t106 = t105**(1.D0/3.D0)
      t109 = 1.D0-1.D0*t104
      t110 = t109**(1.D0/3.D0)
      t112 = t106*t105+t110*t109-2.D0
      t113 = t103**2
      t114 = t113**2
      t115 = rho**2
      t116 = t115**2
      t118 = t114/t116
      t123 = 0.3799574853701528D-1*(1.D0+0.6901399211255825D-1*t73)
     &*t100*t112*(1.D0-1.D0*t118)
      t134 = dlog(1.D0+0.321646831778707D2/(0.1112037486309468D2*t76
     &+0.3844746237447211D1*t73+0.1644733775567609D1*t79
     &+0.2405871291288192D0*t81))
      t140 = 0.1923661050931536D1*(-0.3109D-1*(1.D0
     &+0.1274696188700087D0*t73)*t134+t89)*t112*t118
      t141 = t106**2
      t143 = t110**2
      t145 = 0.5D0*t141+0.5D0*t143
      t146 = t145**2
      t147 = t146*t145
      t148 = 1/t146
      t150 = rho**(1.D0/3.D0)
      t152 = 1/t150/t115
      t159 = dexp(-0.4042761511756372D2*(-t89+t123+t140)/t147)
      t160 = t159-1.D0
      t161 = 1/t160
      t162 = sigma**2
      t164 = t146**2
      t166 = t150**2
      t169 = 1/t164/t166/t116
      t177 = t160**2
      t187 = dlog(1.D0+0.2697586091519874D1*(0.634682060977037D-1
     &*sigma*t148*t152+0.1086645186223595D-1*t161*t162*t169)/(1.D0
     &+0.1712109500228824D0*t161*sigma*t148*t152+0.2931318940773793D-1
     &/t177*t162*t169))
      t208 = dexp(-0.261211729852336D1*t146/t166/t115*sigma)
      zk(i) = -0.9305257363491D0*t5*(1.D0+t12+0.1645530784602056D-1*
     &(0.2743D0-0.1508D0*t19)*sigmaaa*t16)/(1.D0+t12
     &+0.1083108625229223D-5*t27/t4/t28/rhoa)-0.9305257363491D0*t39*
     &(1.D0+t46+0.1645530784602056D-1*(0.2743D0-0.1508D0*t53)*sigmabb
     &*t50)/(1.D0+t46+0.1083108625229223D-5*t61/t38/t62/rhob)+rho*(
     &-t89+t123+t140+0.2473556743557577D-1*t147*t187+0.1D1*(0.1D-2*
     &(0.2568D1+0.1443307452126544D2*t73+0.2843543831490386D-2*t81)/
     &(1.D0+0.5411317332115466D1*t73+0.1816419932959077D0*t81
     &+0.1763993811759022D-1*t72)-0.1853571428571429D-2)*t145*sigma
     &*t152*t208)
      endif ! rhoa,rhob
      else ! rho
      zk(i) = 0.0d0
      endif ! rho
      enddo
      
      else if(ideriv.eq.1) then
      
      do i=1,npt
      rhoa = dmax1(0.D0,rhoa1(i))
      rhob = dmax1(0.D0,rhob1(i))
      rho = rhoa+rhob
      if(rho.gt.tol) then
      if(rhoa.lt.tol) then
      rho = rhob
      sigmabb = dmax1(0.D0,sigmabb1(i))
      sigma = sigmabb
      t2 = rhob**(1.D0/3.D0)
      t3 = t2*rhob
      t4 = dsqrt(sigmabb)
      t5 = 1/t3
      t6 = t4*t5
      t8 = dlog(0.1000005877780776D1*t6+dsqrt(1+0.10000117555961D1*t6*
     &*2))
      t10 = 0.2520026100493014D-1*t6*t8
      t11 = rhob**2
      t12 = t2**2
      t14 = 1/t12/t11
      t15 = sigmabb*t14
      t17 = dexp(-0.1645530784602056D1*t15)
      t19 = 0.2743D0-0.1508D0*t17
      t20 = t19*sigmabb
      t23 = 1.D0+t10+0.1645530784602056D-1*t20*t14
      t24 = t3*t23
      t25 = sigmabb**2
      t26 = t11**2
      t27 = t26*rhob
      t29 = 1/t2/t27
      t32 = 1.D0+t10+0.1083108625229223D-5*t25*t29
      t33 = 1/t32
      t36 = 1/rhob
      t37 = t36**(1.D0/3.D0)
      t39 = 1.D0+0.1274696188700087D0*t37
      t40 = t36**(1.D0/6.D0)
      t43 = dsqrt(t36)
      t45 = t37**2
      t47 = 0.1112037486309468D2*t40+0.3844746237447211D1*t37
     &+0.1644733775567609D1*t43+0.2405871291288192D0*t45
      t50 = 1.D0+0.321646831778707D2/t47
      t51 = dlog(t50)
      t52 = t39*t51
      t53 = 0.3109D-1*t52
      t55 = 1/t2/t11
      t59 = dexp(0.2513789108010112D1*t52)
      t60 = t59-1.D0
      t61 = 1/t60
      t62 = t61*t25
      t64 = 1/t12/t26
      t67 = 0.1007494971260294D0*sigmabb*t55+0.2738174287780083D-1*t62
     &*t64
      t68 = t61*sigmabb
      t71 = t60**2
      t72 = 1/t71
      t73 = t72*t25
      t76 = 1.D0+0.2717804421747983D0*t68*t55+0.7386460874872889D-1
     &*t73*t64
      t77 = 1/t76
      t80 = 1.D0+0.2697586091519874D1*t67*t77
      t81 = dlog(t80)
      t82 = 0.1236778371778789D-1*t81
      t85 = 0.2568D1+0.1443307452126544D2*t37+0.2843543831490386D-2*t45
      t89 = 1.D0+0.5411317332115466D1*t37+0.1816419932959077D0*t45
     &+0.1763993811759022D-1*t36
      t90 = 1/t89
      t93 = 0.1D-2*t85*t90-0.1853571428571429D-2
      t94 = t93*sigmabb
      t95 = t55*t17
      t97 = 0.7937005259840997D0*t94*t95
      zk(i) = -0.9305257363491D0*t24*t33+rhob*(-t53+t82+t97)
      vrhoa(i) = 0.D0
      t105 = 0.3360034800657352D-1*t4*t55*t8
      t106 = t11*rhob
      t108 = 1/t12/t106
      t112 = dsqrt(1.D0+0.10000117555961D1*t15)
      t113 = 1/t112
      t115 = 0.3360054550205309D-1*sigmabb*t108*t113
      t116 = t26*t11
      t119 = t25/t2/t116
      t128 = t32**2
      t129 = 1/t128
      t136 = 1/t11
      t137 = 1/t45*t136
      t139 = 0.1321010150222857D-2*t137*t51
      t140 = t47**2
      t143 = t40**2
      t144 = t143**2
      t154 = 1/t37*t136
      t160 = 0.1D1*t39/t140*(-0.1853395810515781D1/t144/t40*t136
     &-0.128158207914907D1*t137-0.8223668877838045D0/t43*t136
     &-0.1603914194192128D0*t154)/t50
      t162 = 1/t2/t106
      t165 = t139+t160
      t167 = t64*t165*t59
      t171 = 1/t12/t27
      t177 = t76**2
      t179 = t67/t177
      t180 = t72*sigmabb
      t198 = 1/t80
      t206 = t89**2
      s1 = -0.12407009817988D1*t2*t23*t33-0.9305257363491D0*t3*(-t105
     &-t115-0.1088885204563779D-1*t119*t17-0.4388082092272149D-1*t20
     &*t108)*t33+0.9305257363491D0*t24*t129*(-t105-t115
     &-0.5776579334555855D-5*t119)
      vrhob(i) = s1-t53+t82+t97+rhob*(t139+t160+0.1236778371778789D-1*
     &(0.2697586091519874D1*(-0.2350821599607352D0*sigmabb*t162
     &+0.2213957124623647D1*t73*t167-0.1277814667630705D0*t62*t171)
     &*t77-0.2697586091519874D1*t179*(0.2197487022544806D2*t180*t55
     &*t165*t59-0.6341543650745294D0*t68*t162+0.1194467989321217D2/t71
     &/t60*t25*t167-0.3447015074940681D0*t73*t171))*t198
     &+0.7937005259840997D0*(0.1D-2*(-0.4811024840421814D1*t137
     &-0.1895695887660258D-2*t154)*t90-0.1D-2*t85/t206*(
     &-0.1803772444038489D1*t137-0.1210946621972718D0*t154
     &-0.1763993811759022D-1*t136))*sigmabb*t95-0.1851967893962899D1
     &*t94*t162*t17+0.3482823064697813D1*t93*t25/t116*t17)
      vsigmaaa(i) = 0.D0
      vsigmaab(i) = 0.D0
      t232 = 0.1260013050246507D-1/t4*t5*t8
      t234 = 0.1260020456326991D-1*t14*t113
      vsigmabb(i) = -0.9305257363491D0*t3*(t232+t234
     &+0.408331951711417D-2*t29*t17*sigmabb+0.1645530784602056D-1*t19
     &*t14)*t33+0.9305257363491D0*t24*t129*(t232+t234
     &+0.2166217250458446D-5*sigmabb*t29)+rhob*(0.1236778371778789D-1*
     &(0.2697586091519874D1*(0.1007494971260294D0*t55
     &+0.5476348575560166D-1*t68*t64)*t77-0.2697586091519874D1*t179*
     &(0.2717804421747983D0*t61*t55+0.1477292174974578D0*t180*t64))
     &*t198+0.7937005259840997D0*t93*t55*t17-0.130605864926168D1*t94
     &/t27*t17)
      elseif(rhob.lt.tol) then
      rho = rhoa
      sigmaaa = dmax1(0.D0,sigmaaa1(i))
      sigma = sigmaaa
      t2 = rhoa**(1.D0/3.D0)
      t3 = t2*rhoa
      t4 = dsqrt(sigmaaa)
      t5 = 1/t3
      t6 = t4*t5
      t8 = dlog(0.1000005877780776D1*t6+dsqrt(1+0.10000117555961D1*t6*
     &*2))
      t10 = 0.2520026100493014D-1*t6*t8
      t11 = rhoa**2
      t12 = t2**2
      t14 = 1/t12/t11
      t15 = sigmaaa*t14
      t17 = dexp(-0.1645530784602056D1*t15)
      t19 = 0.2743D0-0.1508D0*t17
      t20 = t19*sigmaaa
      t23 = 1.D0+t10+0.1645530784602056D-1*t20*t14
      t24 = t3*t23
      t25 = sigmaaa**2
      t26 = t11**2
      t27 = t26*rhoa
      t29 = 1/t2/t27
      t32 = 1.D0+t10+0.1083108625229223D-5*t25*t29
      t33 = 1/t32
      t36 = 1/rhoa
      t37 = t36**(1.D0/3.D0)
      t39 = 1.D0+0.1274696188700087D0*t37
      t40 = t36**(1.D0/6.D0)
      t43 = dsqrt(t36)
      t45 = t37**2
      t47 = 0.1112037486309468D2*t40+0.3844746237447211D1*t37
     &+0.1644733775567609D1*t43+0.2405871291288192D0*t45
      t50 = 1.D0+0.321646831778707D2/t47
      t51 = dlog(t50)
      t52 = t39*t51
      t53 = 0.3109D-1*t52
      t55 = 1/t2/t11
      t59 = dexp(0.2513789108010112D1*t52)
      t60 = t59-1.D0
      t61 = 1/t60
      t62 = t61*t25
      t64 = 1/t12/t26
      t67 = 0.1007494971260294D0*sigmaaa*t55+0.2738174287780083D-1*t62
     &*t64
      t68 = t61*sigmaaa
      t71 = t60**2
      t72 = 1/t71
      t73 = t72*t25
      t76 = 1.D0+0.2717804421747983D0*t68*t55+0.7386460874872889D-1
     &*t73*t64
      t77 = 1/t76
      t80 = 1.D0+0.2697586091519874D1*t67*t77
      t81 = dlog(t80)
      t82 = 0.1236778371778789D-1*t81
      t85 = 0.2568D1+0.1443307452126544D2*t37+0.2843543831490386D-2*t45
      t89 = 1.D0+0.5411317332115466D1*t37+0.1816419932959077D0*t45
     &+0.1763993811759022D-1*t36
      t90 = 1/t89
      t93 = 0.1D-2*t85*t90-0.1853571428571429D-2
      t94 = t93*sigmaaa
      t95 = t55*t17
      t97 = 0.7937005259840997D0*t94*t95
      zk(i) = -0.9305257363491D0*t24*t33+rhoa*(-t53+t82+t97)
      t105 = 0.3360034800657352D-1*t4*t55*t8
      t106 = t11*rhoa
      t108 = 1/t12/t106
      t112 = dsqrt(1.D0+0.10000117555961D1*t15)
      t113 = 1/t112
      t115 = 0.3360054550205309D-1*sigmaaa*t108*t113
      t116 = t26*t11
      t119 = t25/t2/t116
      t128 = t32**2
      t129 = 1/t128
      t136 = 1/t11
      t137 = 1/t45*t136
      t139 = 0.1321010150222857D-2*t137*t51
      t140 = t47**2
      t143 = t40**2
      t144 = t143**2
      t154 = 1/t37*t136
      t160 = 0.1D1*t39/t140*(-0.1853395810515781D1/t144/t40*t136
     &-0.128158207914907D1*t137-0.8223668877838045D0/t43*t136
     &-0.1603914194192128D0*t154)/t50
      t162 = 1/t2/t106
      t165 = t139+t160
      t167 = t64*t165*t59
      t171 = 1/t12/t27
      t177 = t76**2
      t179 = t67/t177
      t180 = t72*sigmaaa
      t198 = 1/t80
      t206 = t89**2
      s1 = -0.12407009817988D1*t2*t23*t33-0.9305257363491D0*t3*(-t105
     &-t115-0.1088885204563779D-1*t119*t17-0.4388082092272149D-1*t20
     &*t108)*t33+0.9305257363491D0*t24*t129*(-t105-t115
     &-0.5776579334555855D-5*t119)
      vrhoa(i) = s1-t53+t82+t97+rhoa*(t139+t160+0.1236778371778789D-1*
     &(0.2697586091519874D1*(-0.2350821599607352D0*sigmaaa*t162
     &+0.2213957124623647D1*t73*t167-0.1277814667630705D0*t62*t171)
     &*t77-0.2697586091519874D1*t179*(0.2197487022544806D2*t180*t55
     &*t165*t59-0.6341543650745294D0*t68*t162+0.1194467989321217D2/t71
     &/t60*t25*t167-0.3447015074940681D0*t73*t171))*t198
     &+0.7937005259840997D0*(0.1D-2*(-0.4811024840421814D1*t137
     &-0.1895695887660258D-2*t154)*t90-0.1D-2*t85/t206*(
     &-0.1803772444038489D1*t137-0.1210946621972718D0*t154
     &-0.1763993811759022D-1*t136))*sigmaaa*t95-0.1851967893962899D1
     &*t94*t162*t17+0.3482823064697813D1*t93*t25/t116*t17)
      vrhob(i) = 0.D0
      t232 = 0.1260013050246507D-1/t4*t5*t8
      t234 = 0.1260020456326991D-1*t14*t113
      vsigmaaa(i) = -0.9305257363491D0*t3*(t232+t234
     &+0.408331951711417D-2*t29*t17*sigmaaa+0.1645530784602056D-1*t19
     &*t14)*t33+0.9305257363491D0*t24*t129*(t232+t234
     &+0.2166217250458446D-5*sigmaaa*t29)+rhoa*(0.1236778371778789D-1*
     &(0.2697586091519874D1*(0.1007494971260294D0*t55
     &+0.5476348575560166D-1*t68*t64)*t77-0.2697586091519874D1*t179*
     &(0.2717804421747983D0*t61*t55+0.1477292174974578D0*t180*t64))
     &*t198+0.7937005259840997D0*t93*t55*t17-0.130605864926168D1*t94
     &/t27*t17)
      vsigmaab(i) = 0.D0
      vsigmabb(i) = 0.D0
      else ! (.not.(rhoa.lt.tol).and..not.(rhob.lt.tol))
      sigmaaa = dmax1(0.D0,sigmaaa1(i))
      sigmaab = sigmaab1(i)
      sigmabb = dmax1(0.D0,sigmabb1(i))
      sigma = sigmaaa+sigmabb+2.D0*sigmaab
      t4 = rhoa**(1.D0/3.D0)
      t5 = t4*rhoa
      t6 = dsqrt(sigmaaa)
      t7 = 1/t5
      t8 = t6*t7
      t10 = dlog(0.1000005877780776D1*t8+dsqrt(1+0.10000117555961D1*t8
     &**2))
      t12 = 0.2520026100493014D-1*t8*t10
      t13 = rhoa**2
      t14 = t4**2
      t16 = 1/t14/t13
      t17 = sigmaaa*t16
      t19 = dexp(-0.1645530784602056D1*t17)
      t21 = 0.2743D0-0.1508D0*t19
      t22 = t21*sigmaaa
      t25 = 1.D0+t12+0.1645530784602056D-1*t22*t16
      t26 = t5*t25
      t27 = sigmaaa**2
      t28 = t13**2
      t31 = 1/t4/t28/rhoa
      t34 = 1.D0+t12+0.1083108625229223D-5*t27*t31
      t35 = 1/t34
      t38 = rhob**(1.D0/3.D0)
      t39 = t38*rhob
      t40 = dsqrt(sigmabb)
      t41 = 1/t39
      t42 = t40*t41
      t44 = dlog(0.1000005877780776D1*t42+dsqrt(1+0.10000117555961D1
     &*t42**2))
      t46 = 0.2520026100493014D-1*t42*t44
      t47 = rhob**2
      t48 = t38**2
      t50 = 1/t48/t47
      t51 = sigmabb*t50
      t53 = dexp(-0.1645530784602056D1*t51)
      t55 = 0.2743D0-0.1508D0*t53
      t56 = t55*sigmabb
      t59 = 1.D0+t46+0.1645530784602056D-1*t56*t50
      t60 = t39*t59
      t61 = sigmabb**2
      t62 = t47**2
      t65 = 1/t38/t62/rhob
      t68 = 1.D0+t46+0.1083108625229223D-5*t61*t65
      t69 = 1/t68
      t72 = 1/rho
      t73 = t72**(1.D0/3.D0)
      t75 = 1.D0+0.1325688999052018D0*t73
      t76 = t72**(1.D0/6.D0)
      t79 = dsqrt(t72)
      t81 = t73**2
      t83 = 0.598255043577108D1*t76+0.2225569421150687D1*t73
     &+0.8004286349993634D0*t79+0.1897004325747559D0*t81
      t86 = 1.D0+0.160818243221511D2/t83
      t87 = dlog(t86)
      t89 = 0.62182D-1*t75*t87
      t91 = 1.D0+0.6901399211255825D-1*t73
      t96 = 0.8157414703487641D1*t76+0.2247591863577616D1*t73
     &+0.4300972471276643D0*t79+0.1911512595127338D0*t81
      t99 = 1.D0+0.2960857464321668D2/t96
      t100 = dlog(t99)
      t101 = t91*t100
      t103 = rhoa-1.D0*rhob
      t104 = t103*t72
      t105 = 1.D0+t104
      t106 = t105**(1.D0/3.D0)
      t109 = 1.D0-1.D0*t104
      t110 = t109**(1.D0/3.D0)
      t112 = t106*t105+t110*t109-2.D0
      t113 = t103**2
      t114 = t113**2
      t115 = rho**2
      t116 = t115**2
      t117 = 1/t116
      t118 = t114*t117
      t120 = 1.D0-1.D0*t118
      t123 = 0.3799574853701528D-1*t101*t112*t120
      t125 = 1.D0+0.1274696188700087D0*t73
      t130 = 0.1112037486309468D2*t76+0.3844746237447211D1*t73
     &+0.1644733775567609D1*t79+0.2405871291288192D0*t81
      t133 = 1.D0+0.321646831778707D2/t130
      t134 = dlog(t133)
      t137 = -0.3109D-1*t125*t134+t89
      t138 = t137*t112
      t140 = 0.1923661050931536D1*t138*t118
      t141 = t106**2
      t143 = t110**2
      t145 = 0.5D0*t141+0.5D0*t143
      t146 = t145**2
      t147 = t146*t145
      t148 = 1/t146
      t149 = sigma*t148
      t150 = rho**(1.D0/3.D0)
      t152 = 1/t150/t115
      t155 = -t89+t123+t140
      t156 = 1/t147
      t159 = dexp(-0.4042761511756372D2*t155*t156)
      t160 = t159-1.D0
      t161 = 1/t160
      t162 = sigma**2
      t163 = t161*t162
      t164 = t146**2
      t165 = 1/t164
      t166 = t150**2
      t168 = 1/t166/t116
      t169 = t165*t168
      t172 = 0.634682060977037D-1*t149*t152+0.1086645186223595D-1*t163
     &*t169
      t173 = t161*sigma
      t174 = t148*t152
      t177 = t160**2
      t178 = 1/t177
      t179 = t178*t162
      t182 = 1.D0+0.1712109500228824D0*t173*t174+0.2931318940773793D-1
     &*t179*t169
      t183 = 1/t182
      t186 = 1.D0+0.2697586091519874D1*t172*t183
      t187 = dlog(t186)
      t189 = 0.2473556743557577D-1*t147*t187
      t192 = 0.2568D1+0.1443307452126544D2*t73+0.2843543831490386D-2*t81
      t196 = 1.D0+0.5411317332115466D1*t73+0.1816419932959077D0*t81
     &+0.1763993811759022D-1*t72
      t197 = 1/t196
      t200 = 0.1D-2*t192*t197-0.1853571428571429D-2
      t201 = t200*t145
      t204 = 1/t166/t115
      t208 = dexp(-0.261211729852336D1*t146*t204*sigma)
      t209 = sigma*t152*t208
      t211 = 0.1D1*t201*t209
      zk(i) = -0.9305257363491D0*t26*t35-0.9305257363491D0*t60*t69+rho
     &*(-t89+t123+t140+t189+t211)
      t221 = 0.3360034800657352D-1*t6/t4/t13*t10
      t224 = 1/t14/t13/rhoa
      t228 = dsqrt(1.D0+0.10000117555961D1*t17)
      t229 = 1/t228
      t231 = 0.3360054550205309D-1*sigmaaa*t224*t229
      t235 = t27/t4/t28/t13
      t244 = t34**2
      t245 = 1/t244
      t255 = 0.1333333333333333D1*t106*t72-0.1333333333333333D1*t110*t72
      t258 = 0.3799574853701528D-1*t101*t255*t120
      t259 = t113*t103
      t262 = t101*t112*t259*t117
      t263 = 0.1519829941480611D0*t262
      t266 = 0.1923661050931536D1*t137*t255*t118
      t268 = t138*t259*t117
      t269 = 0.7694644203726145D1*t268
      t270 = t146*t187
      t271 = 1/t106
      t274 = 1/t110
      t277 = 0.3333333333333333D0*t271*t72-0.3333333333333333D0*t274*t72
      t280 = sigma*t156
      t284 = t179*t165
      t288 = t155*t165
      t291 = -0.4042761511756372D2*(t258-t263+t266+t269)*t156
     &+0.1212828453526912D3*t288*t277
      t293 = t168*t291*t159
      t298 = 1/t164/t145*t168
      t299 = t298*t277
      t305 = t182**2
      t307 = t172/t305
      t308 = t178*sigma
      t309 = t308*t148
      t314 = t156*t152
      t321 = 1/t177/t160*t162*t165
      t331 = 1/t186
      t338 = t200*t146*t162
      t339 = t116*rho
      t340 = 1/t339
      t348 = 1/t115
      t349 = 1/t81*t348
      t350 = t349*t87
      t351 = 0.2747799777968419D-2*t350
      t352 = t83**2
      t355 = t76**2
      t356 = t355**2
      t359 = 1/t356/t76*t348
      t363 = 1/t79*t348
      t366 = 1/t73*t348
      t371 = t75/t352*(-0.99709173929518D0*t359-0.7418564737168958D0
     &*t349-0.4002143174996817D0*t363-0.1264669550498372D0*t366)/t86
      t372 = 0.1D1*t371
      t376 = 0.8740794299481065D-3*t349*t100*t112*t120
      t377 = t96**2
      t390 = 0.1124999956683108D1*t91/t377*(-0.135956911724794D1*t359
     &-0.7491972878592054D0*t349-0.2150486235638321D0*t363
     &-0.1274341730084892D0*t366)/t99*t112*t120
      t397 = -0.1333333333333333D1*t106*t103*t348+0.1333333333333333D1
     &*t110*t103*t348
      t400 = 0.3799574853701528D-1*t101*t397*t120
      t404 = 0.1519829941480611D0*t101*t112*t114*t340
      t407 = t130**2
      t424 = 0.1923661050931536D1*(0.1321010150222857D-2*t349*t134
     &+0.1D1*t125/t407*(-0.1853395810515781D1*t359-0.128158207914907D1
     &*t349-0.8223668877838045D0*t363-0.1603914194192128D0*t366)/t133
     &-0.2747799777968419D-2*t350-0.1D1*t371)*t112*t118
      t427 = 0.1923661050931536D1*t137*t397*t118
      t430 = 0.7694644203726145D1*t138*t114*t340
      t437 = -0.3333333333333333D0*t271*t103*t348+0.3333333333333333D0
     &*t274*t103*t348
      t443 = t115*rho
      t445 = 1/t150/t443
      t453 = -0.4042761511756372D2*(t351+t372-t376-t390+t400+t404+t424
     &+t427-t430)*t156+0.1212828453526912D3*t288*t437
      t455 = t168*t453*t159
      t458 = t298*t437
      t463 = t165/t166/t339
      t497 = t196**2
      s1 = t351+t372-t376-t390+t400+t404+t424
      s2 = s1+t427-t430+0.7420670230672731D-1*t270*t437
      s3 = s2+0.2473556743557577D-1*t147*(0.2697586091519874D1*(
     &-0.1269364121954074D0*t280*t152*t437-0.148092480894642D0*t149
     &*t445-0.1086645186223595D-1*t284*t455-0.4346580744894379D-1*t163
     &*t458-0.5071010869043442D-1*t163*t463)*t183-0.2697586091519874D1
     &*t307*(-0.1712109500228824D0*t309*t152*t453*t159
     &-0.3424219000457648D0*t173*t314*t437-0.3994922167200589D0*t173
     &*t148*t445-0.5862637881547585D-1*t321*t455-0.1172527576309517D0
     &*t179*t458-0.136794883902777D0*t179*t463))*t331+0.1D1*(0.1D-2*(
     &-0.4811024840421814D1*t349-0.1895695887660258D-2*t366)*t197
     &-0.1D-2*t192/t497*(-0.1803772444038489D1*t349
     &-0.1210946621972718D0*t366-0.1763993811759022D-1*t348))*t145*t209
      t532 = s3+0.1D1*t200*t437*t209-0.2333333333333333D1*t201*sigma
     &*t445*t208+0.1D1*t201*sigma*t152*(-0.522423459704672D1*t145*t204
     &*sigma*t437+0.6965646129395627D1*t146/t166/t443*sigma)*t208
      t533 = rho*t532
      vrhoa(i) = -0.12407009817988D1*t4*t25*t35-0.9305257363491D0*t5*(
     &-t221-t231-0.1088885204563779D-1*t235*t19-0.4388082092272149D-1
     &*t22*t224)*t35+0.9305257363491D0*t26*t245*(-t221-t231
     &-0.5776579334555855D-5*t235)+rho*(t258-t263+t266+t269
     &+0.7420670230672731D-1*t270*t277+0.2473556743557577D-1*t147*
     &(0.2697586091519874D1*(-0.1269364121954074D0*t280*t152*t277
     &-0.1086645186223595D-1*t284*t293-0.4346580744894379D-1*t163*t299
     &)*t183-0.2697586091519874D1*t307*(-0.1712109500228824D0*t309
     &*t152*t291*t159-0.3424219000457648D0*t173*t314*t277
     &-0.5862637881547585D-1*t321*t293-0.1172527576309517D0*t179*t299)
     &)*t331+0.1D1*t200*t277*t209-0.522423459704672D1*t338*t340*t277
     &*t208)-t89+t123+t140+t189+t211+t533
      t541 = 0.3360034800657352D-1*t40/t38/t47*t44
      t544 = 1/t48/t47/rhob
      t548 = dsqrt(1.D0+0.10000117555961D1*t51)
      t549 = 1/t548
      t551 = 0.3360054550205309D-1*sigmabb*t544*t549
      t555 = t61/t38/t62/t47
      t564 = t68**2
      t565 = 1/t564
      t571 = -t255
      t574 = 0.3799574853701528D-1*t101*t571*t120
      t575 = 0.1519829941480611D0*t262
      t578 = 0.1923661050931536D1*t137*t571*t118
      t579 = 0.7694644203726145D1*t268
      t580 = -t277
      t591 = -0.4042761511756372D2*(t574+t575+t578-t579)*t156
     &+0.1212828453526912D3*t288*t580
      t593 = t168*t591*t159
      t596 = t298*t580
      vrhob(i) = -0.12407009817988D1*t38*t59*t69-0.9305257363491D0*t39
     &*(-t541-t551-0.1088885204563779D-1*t555*t53
     &-0.4388082092272149D-1*t56*t544)*t69+0.9305257363491D0*t60*t565*
     &(-t541-t551-0.5776579334555855D-5*t555)+rho*(t574+t575+t578-t579
     &+0.7420670230672731D-1*t270*t580+0.2473556743557577D-1*t147*
     &(0.2697586091519874D1*(-0.1269364121954074D0*t280*t152*t580
     &-0.1086645186223595D-1*t284*t593-0.4346580744894379D-1*t163*t596
     &)*t183-0.2697586091519874D1*t307*(-0.1712109500228824D0*t309
     &*t152*t591*t159-0.3424219000457648D0*t173*t314*t580
     &-0.5862637881547585D-1*t321*t593-0.1172527576309517D0*t179*t596)
     &)*t331+0.1D1*t200*t580*t209-0.522423459704672D1*t338*t340*t580
     &*t208)-t89+t123+t140+t189+t211+t533
      t632 = 0.1260013050246507D-1/t6*t7*t10
      t634 = 0.1260020456326991D-1*t16*t229
      t677 = rho*(0.2473556743557577D-1*t147*(0.2697586091519874D1*
     &(0.634682060977037D-1*t174+0.2173290372447189D-1*t173*t169)*t183
     &-0.2697586091519874D1*t307*(0.1712109500228824D0*t161*t148*t152
     &+0.5862637881547585D-1*t308*t169))*t331+0.1D1*t201*t152*t208
     &-0.261211729852336D1*t200*t147*sigma*t340*t208)
      vsigmaaa(i) = -0.9305257363491D0*t5*(t632+t634
     &+0.408331951711417D-2*t31*t19*sigmaaa+0.1645530784602056D-1*t21
     &*t16)*t35+0.9305257363491D0*t26*t245*(t632+t634
     &+0.2166217250458446D-5*sigmaaa*t31)+t677
      vsigmaab(i) = 2.D0*t677
      t681 = 0.1260013050246507D-1/t40*t41*t44
      t683 = 0.1260020456326991D-1*t50*t549
      vsigmabb(i) = -0.9305257363491D0*t39*(t681+t683
     &+0.408331951711417D-2*t65*t53*sigmabb+0.1645530784602056D-1*t55
     &*t50)*t69+0.9305257363491D0*t60*t565*(t681+t683
     &+0.2166217250458446D-5*sigmabb*t65)+t677
      endif ! rhoa,rhob
      else ! rho
      zk(i) = 0.0d0
      vrhoa(i) = 0.0d0
      vrhob(i) = 0.0d0
      vsigmaaa(i) = 0.0d0
      vsigmaab(i) = 0.0d0
      vsigmabb(i) = 0.0d0
      endif ! rho
      enddo
      
      else if(ideriv.eq.2) then
      
      do i=1,npt
      rhoa = dmax1(0.D0,rhoa1(i))
      rhob = dmax1(0.D0,rhob1(i))
      rho = rhoa+rhob
      if(rho.gt.tol) then
      if(rhoa.lt.tol) then
      rho = rhob
      sigmabb = dmax1(0.D0,sigmabb1(i))
      sigma = sigmabb
      t2 = rhob**(1.D0/3.D0)
      t3 = t2*rhob
      t4 = dsqrt(sigmabb)
      t5 = 1/t3
      t6 = t4*t5
      t8 = dlog(0.1000005877780776D1*t6+dsqrt(1+0.10000117555961D1*t6*
     &*2))
      t10 = 0.2520026100493014D-1*t6*t8
      t11 = rhob**2
      t12 = t2**2
      t14 = 1/t12/t11
      t15 = sigmabb*t14
      t17 = dexp(-0.1645530784602056D1*t15)
      t19 = 0.2743D0-0.1508D0*t17
      t20 = t19*sigmabb
      t23 = 1.D0+t10+0.1645530784602056D-1*t20*t14
      t24 = t3*t23
      t25 = sigmabb**2
      t26 = t11**2
      t27 = t26*rhob
      t29 = 1/t2/t27
      t32 = 1.D0+t10+0.1083108625229223D-5*t25*t29
      t33 = 1/t32
      t36 = 1/rhob
      t37 = t36**(1.D0/3.D0)
      t39 = 1.D0+0.1274696188700087D0*t37
      t40 = t36**(1.D0/6.D0)
      t43 = dsqrt(t36)
      t45 = t37**2
      t47 = 0.1112037486309468D2*t40+0.3844746237447211D1*t37
     &+0.1644733775567609D1*t43+0.2405871291288192D0*t45
      t50 = 1.D0+0.321646831778707D2/t47
      t51 = dlog(t50)
      t52 = t39*t51
      t53 = 0.3109D-1*t52
      t55 = 1/t2/t11
      t59 = dexp(0.2513789108010112D1*t52)
      t60 = t59-1.D0
      t61 = 1/t60
      t62 = t61*t25
      t64 = 1/t12/t26
      t67 = 0.1007494971260294D0*sigmabb*t55+0.2738174287780083D-1*t62
     &*t64
      t68 = t61*sigmabb
      t71 = t60**2
      t72 = 1/t71
      t73 = t72*t25
      t76 = 1.D0+0.2717804421747983D0*t68*t55+0.7386460874872889D-1
     &*t73*t64
      t77 = 1/t76
      t80 = 1.D0+0.2697586091519874D1*t67*t77
      t81 = dlog(t80)
      t82 = 0.1236778371778789D-1*t81
      t85 = 0.2568D1+0.1443307452126544D2*t37+0.2843543831490386D-2*t45
      t89 = 1.D0+0.5411317332115466D1*t37+0.1816419932959077D0*t45
     &+0.1763993811759022D-1*t36
      t90 = 1/t89
      t93 = 0.1D-2*t85*t90-0.1853571428571429D-2
      t94 = t93*sigmabb
      t95 = t55*t17
      t97 = 0.7937005259840997D0*t94*t95
      zk(i) = -0.9305257363491D0*t24*t33+rhob*(-t53+t82+t97)
      vrhoa(i) = 0.D0
      t100 = t2*t23
      t105 = 0.3360034800657352D-1*t4*t55*t8
      t106 = t11*rhob
      t108 = 1/t12/t106
      t111 = 1.D0+0.10000117555961D1*t15
      t112 = dsqrt(t111)
      t113 = 1/t112
      t115 = 0.3360054550205309D-1*sigmabb*t108*t113
      t116 = t26*t11
      t119 = t25/t2/t116
      t124 = -t105-t115-0.1088885204563779D-1*t119*t17
     &-0.4388082092272149D-1*t20*t108
      t125 = t3*t124
      t128 = t32**2
      t129 = 1/t128
      t131 = -t105-t115-0.5776579334555855D-5*t119
      t132 = t129*t131
      t135 = 1/t45
      t136 = 1/t11
      t137 = t135*t136
      t138 = t137*t51
      t139 = 0.1321010150222857D-2*t138
      t140 = t47**2
      t141 = 1/t140
      t142 = t39*t141
      t143 = t40**2
      t144 = t143**2
      t145 = t144*t40
      t146 = 1/t145
      t150 = 1/t43
      t153 = 1/t37
      t154 = t153*t136
      t156 = -0.1853395810515781D1*t146*t136-0.128158207914907D1*t137
     &-0.8223668877838045D0*t150*t136-0.1603914194192128D0*t154
      t157 = 1/t50
      t159 = t142*t156*t157
      t160 = 0.1D1*t159
      t162 = 1/t2/t106
      t165 = t139+t160
      t167 = t64*t165*t59
      t171 = 1/t12/t27
      t174 = -0.2350821599607352D0*sigmabb*t162+0.2213957124623647D1
     &*t73*t167-0.1277814667630705D0*t62*t171
      t177 = t76**2
      t178 = 1/t177
      t179 = t67*t178
      t180 = t72*sigmabb
      t188 = 1/t71/t60
      t189 = t188*t25
      t194 = 0.2197487022544806D2*t180*t55*t165*t59
     &-0.6341543650745294D0*t68*t162+0.1194467989321217D2*t189*t167
     &-0.3447015074940681D0*t73*t171
      t197 = 0.2697586091519874D1*t174*t77-0.2697586091519874D1*t179
     &*t194
      t198 = 1/t80
      t199 = t197*t198
      t203 = -0.4811024840421814D1*t137-0.1895695887660258D-2*t154
      t206 = t89**2
      t207 = 1/t206
      t208 = t85*t207
      t212 = -0.1803772444038489D1*t137-0.1210946621972718D0*t154
     &-0.1763993811759022D-1*t136
      t215 = 0.1D-2*t203*t90-0.1D-2*t208*t212
      t216 = t215*sigmabb
      t217 = t216*t95
      t219 = t162*t17
      t220 = t94*t219
      t222 = t93*t25
      t224 = 1/t116*t17
      t225 = t222*t224
      vrhob(i) = -0.12407009817988D1*t100*t33-0.9305257363491D0*t125
     &*t33+0.9305257363491D0*t24*t132-t53+t82+t97+rhob*(t139+t160
     &+0.1236778371778789D-1*t199+0.7937005259840997D0*t217
     &-0.1851967893962899D1*t220+0.3482823064697813D1*t225)
      vsigmaaa(i) = 0.D0
      vsigmaab(i) = 0.D0
      t232 = 0.1260013050246507D-1/t4*t5*t8
      t234 = 0.1260020456326991D-1*t14*t113
      t235 = t29*t17
      t241 = t3*(t232+t234+0.408331951711417D-2*t235*sigmabb
     &+0.1645530784602056D-1*t19*t14)
      t246 = t232+t234+0.2166217250458446D-5*sigmabb*t29
      t247 = t129*t246
      t253 = 0.1007494971260294D0*t55+0.5476348575560166D-1*t68*t64
      t260 = 0.2717804421747983D0*t61*t55+0.1477292174974578D0*t180*t64
      t263 = 0.2697586091519874D1*t253*t77-0.2697586091519874D1*t179
     &*t260
      t269 = 1/t27
      vsigmabb(i) = -0.9305257363491D0*t241*t33+0.9305257363491D0*t24
     &*t247+rhob*(0.1236778371778789D-1*t263*t198+0.7937005259840997D0
     &*t93*t55*t17-0.130605864926168D1*t94*t269*t17)
      v2rhoa2(i) = 0.D0
      v2rhoab(i) = 0.D0
      t286 = 0.7840081201533821D-1*t4*t162*t8
      t289 = 0.1680027275102654D0*sigmabb*t64*t113
      t290 = t26*t106
      t293 = t25/t2/t290
      t295 = 1/t112/t111
      t297 = 0.4480125399532632D-1*t293*t295
      t300 = t25*sigmabb
      t301 = t26**2
      t316 = 1/t128/t32
      t317 = t131**2
      t334 = dlog(1.D0+0.160818243221511D2/(0.598255043577108D1*t40
     &+0.2225569421150687D1*t37+0.8004286349993634D0*t43
     &+0.1897004325747559D0*t45))
      t346 = t156**2
      t349 = 0.2D1*t39/t140/t47*t346*t157
      t353 = 0.8497974591333914D-1*t137*t141*t156*t157
      t356 = 1/t26
      t359 = 1/t106
      t364 = 1/t45/t36*t356
      t366 = t135*t359
      t376 = 1/t37/t36*t356
      t378 = t153*t359
      t383 = 0.1D1*t142*(-0.1544496508763151D1/t145/t36*t356
     &+0.3706791621031562D1*t146*t359-0.854388052766047D0*t364
     &+0.2563164158298141D1*t366-0.4111834438919023D0/t43/t36*t356
     &+0.1644733775567609D1*t150*t359-0.5346380647307093D-1*t376
     &+0.3207828388384256D0*t378)*t157
      t384 = t140**2
      t387 = t50**2
      t391 = 0.321646831778707D2*t39/t384*t346/t387
      t397 = 0.8806734334819047D-3*t364*t51
      t399 = 0.1D-22*t366*t334
      t401 = 0.2642020300445714D-2*t366*t51
      t403 = 1/t2/t26
      t406 = t165**2
      t407 = t64*t406
      t409 = dexp(0.5027578216020225D1*t52)
      t410 = t407*t409
      t414 = t171*t165*t59
      t417 = -t399+t397-t401-t353-t349+t383+t391
      t419 = t64*t417*t59
      t422 = t407*t59
      t426 = 1/t12/t116
      t437 = t67/t177/t76
      t438 = t194**2
      t442 = t55*t406
      t459 = t71**2
      t499 = t212**2
      t514 = t197**2
      t515 = t80**2
      t516 = 1/t515
      s1 = -t349-t353+t383+t391-0.2902352553914844D2*t222/t290*t17
     &+t397-t399
      s2 = s1-t401+0.1236778371778789D-1*(0.2697586091519874D1*
     &(0.7836071998691172D0*sigmabb*t403+0.3580200260842915D3*t189
     &*t410-0.2066359982982071D2*t73*t414+0.2213957124623647D1*t73
     &*t419-0.1790100130421458D3*t73*t422+0.7240949783240664D0*t62
     &*t426)*t77-0.5395172183039748D1*t174*t178*t194
     &+0.5395172183039748D1*t437*t438-0.2697586091519874D1*t179*
     &(0.35535663829313D4*t188*sigmabb*t442*t409-0.1025493943854243D3
     &*t180*t162*t165*t59+0.2197487022544806D2*t180*t55*t417*t59
     &-0.177678319146565D4*t180*t442*t59+0.2113847883581765D1*t68*t403
     &+0.2897369528551702D4/t459*t25*t410-0.1114836790033136D3*t189
     &*t414+0.1194467989321217D2*t189*t419-0.9657898428505673D3*t189
     &*t422+0.1953308542466386D1*t73*t426))*t198-0.3703935787925799D1
     &*t216*t219
      t526 = s2+0.6965646129395627D1*t215*t25*t224
     &+0.6173226313209665D1*t94*t403*t17+0.7937005259840997D0*(0.1D-2*
     &(-0.3207349893614542D1*t364+0.9622049680843627D1*t366
     &-0.6318986292200858D-3*t376+0.3791391775320515D-2*t378)*t90
     &-0.2D-2*t203*t207*t212+0.2D-2*t85/t206/t89*t499-0.1D-2*t208*(
     &-0.1202514962692326D1*t364+0.3607544888076978D1*t366
     &-0.4036488739909061D-1*t376+0.2421893243945437D0*t378
     &+0.3527987623518044D-1*t359))*sigmabb*t95-0.1236778371778789D-1
     &*t514*t516+0.1528291352075288D2*t93*t300/t12/t301/rhob*t17
      v2rhob2(i) = -0.4135669939329333D0/t12*t23*t33
     &-0.24814019635976D1*t2*t124*t33+0.24814019635976D1*t100*t132
     &-0.9305257363491D0*t3*(t286+t289-t297+0.9799966841074009D-1*t293
     &*t17-0.4778117666686413D-1*t300/t301/t11*t17
     &+0.1608963433833121D0*t20*t64)*t33+0.18610514726982D1*t125*t132
     &-0.18610514726982D1*t24*t316*t317+0.9305257363491D0*t24*t129*
     &(t286+t289-t297+0.3658500245218708D-4*t293)-0.1D-22*t137*t334
     &+0.2642020300445714D-2*t138+0.2D1*t159+0.2473556743557577D-1
     &*t199+0.1587401051968199D1*t217-0.3703935787925799D1*t220
     &+0.6965646129395627D1*t225+rhob*t526
      v2sigmaaa2(i) = 0.D0
      v2sigmaaaab(i) = 0.D0
      v2sigmaaabb(i) = 0.D0
      v2sigmaab2(i) = 0.D0
      v2sigmaabbb(i) = 0.D0
      t532 = 0.6300065251232535D-2/t4/sigmabb*t5*t8
      t536 = 0.6300102281634954D-2/sigmabb*t14*t113
      t538 = 0.6300176343092764D-2*t29*t295
      t550 = t246**2
      t565 = t260**2
      t574 = t263**2
      v2sigmabb2(i) = -0.9305257363491D0*t3*(-t532+t536-t538
     &-0.6719227968777768D-2/t301*t17*sigmabb+0.8166639034228341D-2
     &*t235)*t33+0.18610514726982D1*t241*t247-0.18610514726982D1*t24
     &*t316*t550+0.9305257363491D0*t24*t129*(-t532+t536-t538
     &+0.2166217250458446D-5*t29)+rhob*(0.1236778371778789D-1*
     &(0.1477292174974578D0*t61*t64*t77-0.5395172183039748D1*t253*t178
     &*t260+0.5395172183039748D1*t437*t565-0.3985122824322565D0*t179
     &*t72*t64)*t198-0.1236778371778789D-1*t574*t516
     &-0.261211729852336D1*t93*t269*t17+0.2149159713855873D1*t94/t12
     &/t290*t17)
      elseif(rhob.lt.tol) then
      rho = rhoa
      sigmaaa = dmax1(0.D0,sigmaaa1(i))
      sigma = sigmaaa
      t2 = rhoa**(1.D0/3.D0)
      t3 = t2*rhoa
      t4 = dsqrt(sigmaaa)
      t5 = 1/t3
      t6 = t4*t5
      t8 = dlog(0.1000005877780776D1*t6+dsqrt(1+0.10000117555961D1*t6*
     &*2))
      t10 = 0.2520026100493014D-1*t6*t8
      t11 = rhoa**2
      t12 = t2**2
      t14 = 1/t12/t11
      t15 = sigmaaa*t14
      t17 = dexp(-0.1645530784602056D1*t15)
      t19 = 0.2743D0-0.1508D0*t17
      t20 = t19*sigmaaa
      t23 = 1.D0+t10+0.1645530784602056D-1*t20*t14
      t24 = t3*t23
      t25 = sigmaaa**2
      t26 = t11**2
      t27 = t26*rhoa
      t29 = 1/t2/t27
      t32 = 1.D0+t10+0.1083108625229223D-5*t25*t29
      t33 = 1/t32
      t36 = 1/rhoa
      t37 = t36**(1.D0/3.D0)
      t39 = 1.D0+0.1274696188700087D0*t37
      t40 = t36**(1.D0/6.D0)
      t43 = dsqrt(t36)
      t45 = t37**2
      t47 = 0.1112037486309468D2*t40+0.3844746237447211D1*t37
     &+0.1644733775567609D1*t43+0.2405871291288192D0*t45
      t50 = 1.D0+0.321646831778707D2/t47
      t51 = dlog(t50)
      t52 = t39*t51
      t53 = 0.3109D-1*t52
      t55 = 1/t2/t11
      t59 = dexp(0.2513789108010112D1*t52)
      t60 = t59-1.D0
      t61 = 1/t60
      t62 = t61*t25
      t64 = 1/t12/t26
      t67 = 0.1007494971260294D0*sigmaaa*t55+0.2738174287780083D-1*t62
     &*t64
      t68 = t61*sigmaaa
      t71 = t60**2
      t72 = 1/t71
      t73 = t72*t25
      t76 = 1.D0+0.2717804421747983D0*t68*t55+0.7386460874872889D-1
     &*t73*t64
      t77 = 1/t76
      t80 = 1.D0+0.2697586091519874D1*t67*t77
      t81 = dlog(t80)
      t82 = 0.1236778371778789D-1*t81
      t85 = 0.2568D1+0.1443307452126544D2*t37+0.2843543831490386D-2*t45
      t89 = 1.D0+0.5411317332115466D1*t37+0.1816419932959077D0*t45
     &+0.1763993811759022D-1*t36
      t90 = 1/t89
      t93 = 0.1D-2*t85*t90-0.1853571428571429D-2
      t94 = t93*sigmaaa
      t95 = t55*t17
      t97 = 0.7937005259840997D0*t94*t95
      zk(i) = -0.9305257363491D0*t24*t33+rhoa*(-t53+t82+t97)
      t100 = t2*t23
      t105 = 0.3360034800657352D-1*t4*t55*t8
      t106 = t11*rhoa
      t108 = 1/t12/t106
      t111 = 1.D0+0.10000117555961D1*t15
      t112 = dsqrt(t111)
      t113 = 1/t112
      t115 = 0.3360054550205309D-1*sigmaaa*t108*t113
      t116 = t26*t11
      t119 = t25/t2/t116
      t124 = -t105-t115-0.1088885204563779D-1*t119*t17
     &-0.4388082092272149D-1*t20*t108
      t125 = t3*t124
      t128 = t32**2
      t129 = 1/t128
      t131 = -t105-t115-0.5776579334555855D-5*t119
      t132 = t129*t131
      t135 = 1/t45
      t136 = 1/t11
      t137 = t135*t136
      t138 = t137*t51
      t139 = 0.1321010150222857D-2*t138
      t140 = t47**2
      t141 = 1/t140
      t142 = t39*t141
      t143 = t40**2
      t144 = t143**2
      t145 = t144*t40
      t146 = 1/t145
      t150 = 1/t43
      t153 = 1/t37
      t154 = t153*t136
      t156 = -0.1853395810515781D1*t146*t136-0.128158207914907D1*t137
     &-0.8223668877838045D0*t150*t136-0.1603914194192128D0*t154
      t157 = 1/t50
      t159 = t142*t156*t157
      t160 = 0.1D1*t159
      t162 = 1/t2/t106
      t165 = t139+t160
      t167 = t64*t165*t59
      t171 = 1/t12/t27
      t174 = -0.2350821599607352D0*sigmaaa*t162+0.2213957124623647D1
     &*t73*t167-0.1277814667630705D0*t62*t171
      t177 = t76**2
      t178 = 1/t177
      t179 = t67*t178
      t180 = t72*sigmaaa
      t188 = 1/t71/t60
      t189 = t188*t25
      t194 = 0.2197487022544806D2*t180*t55*t165*t59
     &-0.6341543650745294D0*t68*t162+0.1194467989321217D2*t189*t167
     &-0.3447015074940681D0*t73*t171
      t197 = 0.2697586091519874D1*t174*t77-0.2697586091519874D1*t179
     &*t194
      t198 = 1/t80
      t199 = t197*t198
      t203 = -0.4811024840421814D1*t137-0.1895695887660258D-2*t154
      t206 = t89**2
      t207 = 1/t206
      t208 = t85*t207
      t212 = -0.1803772444038489D1*t137-0.1210946621972718D0*t154
     &-0.1763993811759022D-1*t136
      t215 = 0.1D-2*t203*t90-0.1D-2*t208*t212
      t216 = t215*sigmaaa
      t217 = t216*t95
      t219 = t162*t17
      t220 = t94*t219
      t222 = t93*t25
      t224 = 1/t116*t17
      t225 = t222*t224
      vrhoa(i) = -0.12407009817988D1*t100*t33-0.9305257363491D0*t125
     &*t33+0.9305257363491D0*t24*t132-t53+t82+t97+rhoa*(t139+t160
     &+0.1236778371778789D-1*t199+0.7937005259840997D0*t217
     &-0.1851967893962899D1*t220+0.3482823064697813D1*t225)
      vrhob(i) = 0.D0
      t232 = 0.1260013050246507D-1/t4*t5*t8
      t234 = 0.1260020456326991D-1*t14*t113
      t235 = t29*t17
      t241 = t3*(t232+t234+0.408331951711417D-2*t235*sigmaaa
     &+0.1645530784602056D-1*t19*t14)
      t246 = t232+t234+0.2166217250458446D-5*sigmaaa*t29
      t247 = t129*t246
      t253 = 0.1007494971260294D0*t55+0.5476348575560166D-1*t68*t64
      t260 = 0.2717804421747983D0*t61*t55+0.1477292174974578D0*t180*t64
      t263 = 0.2697586091519874D1*t253*t77-0.2697586091519874D1*t179
     &*t260
      t269 = 1/t27
      vsigmaaa(i) = -0.9305257363491D0*t241*t33+0.9305257363491D0*t24
     &*t247+rhoa*(0.1236778371778789D-1*t263*t198+0.7937005259840997D0
     &*t93*t55*t17-0.130605864926168D1*t94*t269*t17)
      vsigmaab(i) = 0.D0
      vsigmabb(i) = 0.D0
      t286 = 0.7840081201533821D-1*t4*t162*t8
      t289 = 0.1680027275102654D0*sigmaaa*t64*t113
      t290 = t26*t106
      t293 = t25/t2/t290
      t295 = 1/t112/t111
      t297 = 0.4480125399532632D-1*t293*t295
      t300 = t25*sigmaaa
      t301 = t26**2
      t316 = 1/t128/t32
      t317 = t131**2
      t334 = dlog(1.D0+0.160818243221511D2/(0.598255043577108D1*t40
     &+0.2225569421150687D1*t37+0.8004286349993634D0*t43
     &+0.1897004325747559D0*t45))
      t346 = t156**2
      t349 = 0.2D1*t39/t140/t47*t346*t157
      t353 = 0.8497974591333914D-1*t137*t141*t156*t157
      t356 = 1/t26
      t359 = 1/t106
      t364 = 1/t45/t36*t356
      t366 = t135*t359
      t376 = 1/t37/t36*t356
      t378 = t153*t359
      t383 = 0.1D1*t142*(-0.1544496508763151D1/t145/t36*t356
     &+0.3706791621031562D1*t146*t359-0.854388052766047D0*t364
     &+0.2563164158298141D1*t366-0.4111834438919023D0/t43/t36*t356
     &+0.1644733775567609D1*t150*t359-0.5346380647307093D-1*t376
     &+0.3207828388384256D0*t378)*t157
      t384 = t140**2
      t387 = t50**2
      t391 = 0.321646831778707D2*t39/t384*t346/t387
      t397 = 0.8806734334819047D-3*t364*t51
      t399 = 0.1D-22*t366*t334
      t401 = 0.2642020300445714D-2*t366*t51
      t403 = 1/t2/t26
      t406 = t165**2
      t407 = t64*t406
      t409 = dexp(0.5027578216020225D1*t52)
      t410 = t407*t409
      t414 = t171*t165*t59
      t417 = -t399+t397-t401-t353-t349+t383+t391
      t419 = t64*t417*t59
      t422 = t407*t59
      t426 = 1/t12/t116
      t437 = t67/t177/t76
      t438 = t194**2
      t442 = t55*t406
      t459 = t71**2
      t499 = t212**2
      t514 = t197**2
      t515 = t80**2
      t516 = 1/t515
      s1 = -t349-t353+t383+t391-0.2902352553914844D2*t222/t290*t17
     &+t397-t399
      s2 = s1-t401+0.1236778371778789D-1*(0.2697586091519874D1*
     &(0.7836071998691172D0*sigmaaa*t403+0.3580200260842915D3*t189
     &*t410-0.2066359982982071D2*t73*t414+0.2213957124623647D1*t73
     &*t419-0.1790100130421458D3*t73*t422+0.7240949783240664D0*t62
     &*t426)*t77-0.5395172183039748D1*t174*t178*t194
     &+0.5395172183039748D1*t437*t438-0.2697586091519874D1*t179*
     &(0.35535663829313D4*t188*sigmaaa*t442*t409-0.1025493943854243D3
     &*t180*t162*t165*t59+0.2197487022544806D2*t180*t55*t417*t59
     &-0.177678319146565D4*t180*t442*t59+0.2113847883581765D1*t68*t403
     &+0.2897369528551702D4/t459*t25*t410-0.1114836790033136D3*t189
     &*t414+0.1194467989321217D2*t189*t419-0.9657898428505673D3*t189
     &*t422+0.1953308542466386D1*t73*t426))*t198-0.3703935787925799D1
     &*t216*t219
      t526 = s2+0.6965646129395627D1*t215*t25*t224
     &+0.6173226313209665D1*t94*t403*t17+0.7937005259840997D0*(0.1D-2*
     &(-0.3207349893614542D1*t364+0.9622049680843627D1*t366
     &-0.6318986292200858D-3*t376+0.3791391775320515D-2*t378)*t90
     &-0.2D-2*t203*t207*t212+0.2D-2*t85/t206/t89*t499-0.1D-2*t208*(
     &-0.1202514962692326D1*t364+0.3607544888076978D1*t366
     &-0.4036488739909061D-1*t376+0.2421893243945437D0*t378
     &+0.3527987623518044D-1*t359))*sigmaaa*t95-0.1236778371778789D-1
     &*t514*t516+0.1528291352075288D2*t93*t300/t12/t301/rhoa*t17
      v2rhoa2(i) = -0.4135669939329333D0/t12*t23*t33
     &-0.24814019635976D1*t2*t124*t33+0.24814019635976D1*t100*t132
     &-0.9305257363491D0*t3*(t286+t289-t297+0.9799966841074009D-1*t293
     &*t17-0.4778117666686413D-1*t300/t301/t11*t17
     &+0.1608963433833121D0*t20*t64)*t33+0.18610514726982D1*t125*t132
     &-0.18610514726982D1*t24*t316*t317+0.9305257363491D0*t24*t129*
     &(t286+t289-t297+0.3658500245218708D-4*t293)-0.1D-22*t137*t334
     &+0.2642020300445714D-2*t138+0.2D1*t159+0.2473556743557577D-1
     &*t199+0.1587401051968199D1*t217-0.3703935787925799D1*t220
     &+0.6965646129395627D1*t225+rhoa*t526
      v2rhob2(i) = 0.D0
      v2rhoab(i) = 0.D0
      t532 = 0.6300065251232535D-2/t4/sigmaaa*t5*t8
      t536 = 0.6300102281634954D-2/sigmaaa*t14*t113
      t538 = 0.6300176343092764D-2*t29*t295
      t550 = t246**2
      t565 = t260**2
      t574 = t263**2
      v2sigmaaa2(i) = -0.9305257363491D0*t3*(-t532+t536-t538
     &-0.6719227968777768D-2/t301*t17*sigmaaa+0.8166639034228341D-2
     &*t235)*t33+0.18610514726982D1*t241*t247-0.18610514726982D1*t24
     &*t316*t550+0.9305257363491D0*t24*t129*(-t532+t536-t538
     &+0.2166217250458446D-5*t29)+rhoa*(0.1236778371778789D-1*
     &(0.1477292174974578D0*t61*t64*t77-0.5395172183039748D1*t253*t178
     &*t260+0.5395172183039748D1*t437*t565-0.3985122824322565D0*t179
     &*t72*t64)*t198-0.1236778371778789D-1*t574*t516
     &-0.261211729852336D1*t93*t269*t17+0.2149159713855873D1*t94/t12
     &/t290*t17)
      v2sigmaaaab(i) = 0.D0
      v2sigmaaabb(i) = 0.D0
      v2sigmaab2(i) = 0.D0
      v2sigmaabbb(i) = 0.D0
      v2sigmabb2(i) = 0.D0
      else ! (.not.(rhoa.lt.tol).and..not.(rhob.lt.tol))
      sigmaaa = dmax1(0.D0,sigmaaa1(i))
      sigmaab = sigmaab1(i)
      sigmabb = dmax1(0.D0,sigmabb1(i))
      sigma = sigmaaa+sigmabb+2.D0*sigmaab
      t4 = rhoa**(1.D0/3.D0)
      t5 = t4*rhoa
      t6 = dsqrt(sigmaaa)
      t7 = 1/t5
      t8 = t6*t7
      t10 = dlog(0.1000005877780776D1*t8+dsqrt(1+0.10000117555961D1*t8
     &**2))
      t12 = 0.2520026100493014D-1*t8*t10
      t13 = rhoa**2
      t14 = t4**2
      t16 = 1/t14/t13
      t17 = sigmaaa*t16
      t19 = dexp(-0.1645530784602056D1*t17)
      t21 = 0.2743D0-0.1508D0*t19
      t22 = t21*sigmaaa
      t25 = 1.D0+t12+0.1645530784602056D-1*t22*t16
      t26 = t5*t25
      t27 = sigmaaa**2
      t28 = t13**2
      t31 = 1/t4/t28/rhoa
      t34 = 1.D0+t12+0.1083108625229223D-5*t27*t31
      t35 = 1/t34
      t38 = rhob**(1.D0/3.D0)
      t39 = t38*rhob
      t40 = dsqrt(sigmabb)
      t41 = 1/t39
      t42 = t40*t41
      t44 = dlog(0.1000005877780776D1*t42+dsqrt(1+0.10000117555961D1
     &*t42**2))
      t46 = 0.2520026100493014D-1*t42*t44
      t47 = rhob**2
      t48 = t38**2
      t50 = 1/t48/t47
      t51 = sigmabb*t50
      t53 = dexp(-0.1645530784602056D1*t51)
      t55 = 0.2743D0-0.1508D0*t53
      t56 = t55*sigmabb
      t59 = 1.D0+t46+0.1645530784602056D-1*t56*t50
      t60 = t39*t59
      t61 = sigmabb**2
      t62 = t47**2
      t65 = 1/t38/t62/rhob
      t68 = 1.D0+t46+0.1083108625229223D-5*t61*t65
      t69 = 1/t68
      t72 = 1/rho
      t73 = t72**(1.D0/3.D0)
      t75 = 1.D0+0.1325688999052018D0*t73
      t76 = t72**(1.D0/6.D0)
      t79 = dsqrt(t72)
      t81 = t73**2
      t83 = 0.598255043577108D1*t76+0.2225569421150687D1*t73
     &+0.8004286349993634D0*t79+0.1897004325747559D0*t81
      t86 = 1.D0+0.160818243221511D2/t83
      t87 = dlog(t86)
      t89 = 0.62182D-1*t75*t87
      t91 = 1.D0+0.6901399211255825D-1*t73
      t96 = 0.8157414703487641D1*t76+0.2247591863577616D1*t73
     &+0.4300972471276643D0*t79+0.1911512595127338D0*t81
      t99 = 1.D0+0.2960857464321668D2/t96
      t100 = dlog(t99)
      t101 = t91*t100
      t103 = rhoa-1.D0*rhob
      t104 = t103*t72
      t105 = 1.D0+t104
      t106 = t105**(1.D0/3.D0)
      t107 = t106*t105
      t109 = 1.D0-1.D0*t104
      t110 = t109**(1.D0/3.D0)
      t111 = t110*t109
      t112 = t107+t111-2.D0
      t113 = t103**2
      t114 = t113**2
      t115 = rho**2
      t116 = t115**2
      t117 = 1/t116
      t118 = t114*t117
      t120 = 1.D0-1.D0*t118
      t121 = t112*t120
      t123 = 0.3799574853701528D-1*t101*t121
      t125 = 1.D0+0.1274696188700087D0*t73
      t130 = 0.1112037486309468D2*t76+0.3844746237447211D1*t73
     &+0.1644733775567609D1*t79+0.2405871291288192D0*t81
      t133 = 1.D0+0.321646831778707D2/t130
      t134 = dlog(t133)
      t137 = -0.3109D-1*t125*t134+t89
      t138 = t137*t112
      t140 = 0.1923661050931536D1*t138*t118
      t141 = t106**2
      t143 = t110**2
      t145 = 0.5D0*t141+0.5D0*t143
      t146 = t145**2
      t147 = t146*t145
      t148 = 1/t146
      t149 = sigma*t148
      t150 = rho**(1.D0/3.D0)
      t152 = 1/t150/t115
      t155 = -t89+t123+t140
      t156 = 1/t147
      t157 = t155*t156
      t159 = dexp(-0.4042761511756372D2*t157)
      t160 = t159-1.D0
      t161 = 1/t160
      t162 = sigma**2
      t163 = t161*t162
      t164 = t146**2
      t165 = 1/t164
      t166 = t150**2
      t168 = 1/t166/t116
      t169 = t165*t168
      t172 = 0.634682060977037D-1*t149*t152+0.1086645186223595D-1*t163
     &*t169
      t173 = t161*sigma
      t174 = t148*t152
      t177 = t160**2
      t178 = 1/t177
      t179 = t178*t162
      t182 = 1.D0+0.1712109500228824D0*t173*t174+0.2931318940773793D-1
     &*t179*t169
      t183 = 1/t182
      t186 = 1.D0+0.2697586091519874D1*t172*t183
      t187 = dlog(t186)
      t189 = 0.2473556743557577D-1*t147*t187
      t192 = 0.2568D1+0.1443307452126544D2*t73+0.2843543831490386D-2*t81
      t196 = 1.D0+0.5411317332115466D1*t73+0.1816419932959077D0*t81
     &+0.1763993811759022D-1*t72
      t197 = 1/t196
      t200 = 0.1D-2*t192*t197-0.1853571428571429D-2
      t201 = t200*t145
      t204 = 1/t166/t115
      t208 = dexp(-0.261211729852336D1*t146*t204*sigma)
      t209 = sigma*t152*t208
      t211 = 0.1D1*t201*t209
      zk(i) = -0.9305257363491D0*t26*t35-0.9305257363491D0*t60*t69+rho
     &*(-t89+t123+t140+t189+t211)
      t214 = t4*t25
      t218 = 1/t4/t13
      t221 = 0.3360034800657352D-1*t6*t218*t10
      t222 = t13*rhoa
      t224 = 1/t14/t222
      t227 = 1.D0+0.10000117555961D1*t17
      t228 = dsqrt(t227)
      t229 = 1/t228
      t231 = 0.3360054550205309D-1*sigmaaa*t224*t229
      t234 = 1/t4/t28/t13
      t235 = t27*t234
      t240 = -t221-t231-0.1088885204563779D-1*t235*t19
     &-0.4388082092272149D-1*t22*t224
      t241 = t5*t240
      t244 = t34**2
      t245 = 1/t244
      t247 = -t221-t231-0.5776579334555855D-5*t235
      t248 = t245*t247
      t255 = 0.1333333333333333D1*t106*t72-0.1333333333333333D1*t110*t72
      t257 = t101*t255*t120
      t258 = 0.3799574853701528D-1*t257
      t259 = t113*t103
      t260 = t112*t259
      t262 = t101*t260*t117
      t263 = 0.1519829941480611D0*t262
      t264 = t137*t255
      t265 = t264*t118
      t266 = 0.1923661050931536D1*t265
      t267 = t259*t117
      t268 = t138*t267
      t269 = 0.7694644203726145D1*t268
      t270 = t146*t187
      t271 = 1/t106
      t274 = 1/t110
      t277 = 0.3333333333333333D0*t271*t72-0.3333333333333333D0*t274*t72
      t278 = t270*t277
      t279 = 0.7420670230672731D-1*t278
      t280 = sigma*t156
      t281 = t152*t277
      t284 = t179*t165
      t285 = t258-t263+t266+t269
      t288 = t155*t165
      t291 = -0.4042761511756372D2*t285*t156+0.1212828453526912D3*t288
     &*t277
      t292 = t168*t291
      t293 = t292*t159
      t296 = t164*t145
      t297 = 1/t296
      t298 = t297*t168
      t299 = t298*t277
      t302 = -0.1269364121954074D0*t280*t281-0.1086645186223595D-1
     &*t284*t293-0.4346580744894379D-1*t163*t299
      t305 = t182**2
      t306 = 1/t305
      t307 = t172*t306
      t308 = t178*sigma
      t309 = t308*t148
      t310 = t152*t291
      t311 = t310*t159
      t314 = t156*t152
      t315 = t314*t277
      t319 = 1/t177/t160
      t320 = t319*t162
      t321 = t320*t165
      t326 = -0.1712109500228824D0*t309*t311-0.3424219000457648D0*t173
     &*t315-0.5862637881547585D-1*t321*t293-0.1172527576309517D0*t179
     &*t299
      t329 = 0.2697586091519874D1*t302*t183-0.2697586091519874D1*t307
     &*t326
      t330 = t147*t329
      t331 = 1/t186
      t332 = t330*t331
      t333 = 0.2473556743557577D-1*t332
      t334 = t200*t277
      t335 = t334*t209
      t336 = 0.1D1*t335
      t338 = t200*t146*t162
      t339 = t116*rho
      t340 = 1/t339
      t342 = t340*t277*t208
      t343 = t338*t342
      t344 = 0.522423459704672D1*t343
      t347 = 1/t81
      t348 = 1/t115
      t349 = t347*t348
      t350 = t349*t87
      t351 = 0.2747799777968419D-2*t350
      t352 = t83**2
      t353 = 1/t352
      t354 = t75*t353
      t355 = t76**2
      t356 = t355**2
      t357 = t356*t76
      t358 = 1/t357
      t359 = t358*t348
      t362 = 1/t79
      t363 = t362*t348
      t365 = 1/t73
      t366 = t365*t348
      t368 = -0.99709173929518D0*t359-0.7418564737168958D0*t349
     &-0.4002143174996817D0*t363-0.1264669550498372D0*t366
      t369 = 1/t86
      t371 = t354*t368*t369
      t372 = 0.1D1*t371
      t373 = t100*t112
      t374 = t373*t120
      t375 = t349*t374
      t376 = 0.8740794299481065D-3*t375
      t377 = t96**2
      t378 = 1/t377
      t379 = t91*t378
      t384 = -0.135956911724794D1*t359-0.7491972878592054D0*t349
     &-0.2150486235638321D0*t363-0.1274341730084892D0*t366
      t385 = t379*t384
      t386 = 1/t99
      t387 = t386*t112
      t388 = t387*t120
      t389 = t385*t388
      t390 = 0.1124999956683108D1*t389
      t391 = t106*t103
      t394 = t110*t103
      t397 = -0.1333333333333333D1*t391*t348+0.1333333333333333D1*t394
     &*t348
      t399 = t101*t397*t120
      t400 = 0.3799574853701528D-1*t399
      t401 = t112*t114
      t403 = t101*t401*t340
      t404 = 0.1519829941480611D0*t403
      t407 = t130**2
      t408 = 1/t407
      t409 = t125*t408
      t414 = -0.1853395810515781D1*t359-0.128158207914907D1*t349
     &-0.8223668877838045D0*t363-0.1603914194192128D0*t366
      t415 = 1/t133
      t421 = 0.1321010150222857D-2*t349*t134+0.1D1*t409*t414*t415
     &-0.2747799777968419D-2*t350-0.1D1*t371
      t422 = t421*t112
      t423 = t422*t118
      t424 = 0.1923661050931536D1*t423
      t425 = t137*t397
      t426 = t425*t118
      t427 = 0.1923661050931536D1*t426
      t428 = t114*t340
      t429 = t138*t428
      t430 = 0.7694644203726145D1*t429
      t431 = t271*t103
      t434 = t274*t103
      t437 = -0.3333333333333333D0*t431*t348+0.3333333333333333D0*t434
     &*t348
      t438 = t270*t437
      t440 = t152*t437
      t443 = t115*rho
      t445 = 1/t150/t443
      t448 = t351+t372-t376-t390+t400+t404+t424+t427-t430
      t453 = -0.4042761511756372D2*t448*t156+0.1212828453526912D3*t288
     &*t437
      t454 = t168*t453
      t455 = t454*t159
      t458 = t298*t437
      t462 = 1/t166/t339
      t463 = t165*t462
      t466 = -0.1269364121954074D0*t280*t440-0.148092480894642D0*t149
     &*t445-0.1086645186223595D-1*t284*t455-0.4346580744894379D-1*t163
     &*t458-0.5071010869043442D-1*t163*t463
      t469 = t152*t453
      t470 = t469*t159
      t473 = t314*t437
      t476 = t148*t445
      t485 = -0.1712109500228824D0*t309*t470-0.3424219000457648D0*t173
     &*t473-0.3994922167200589D0*t173*t476-0.5862637881547585D-1*t321
     &*t455-0.1172527576309517D0*t179*t458-0.136794883902777D0*t179*t463
      t488 = 0.2697586091519874D1*t466*t183-0.2697586091519874D1*t307
     &*t485
      t489 = t147*t488
      t490 = t489*t331
      t494 = -0.4811024840421814D1*t349-0.1895695887660258D-2*t366
      t497 = t196**2
      t498 = 1/t497
      t499 = t192*t498
      t503 = -0.1803772444038489D1*t349-0.1210946621972718D0*t366
     &-0.1763993811759022D-1*t348
      t506 = 0.1D-2*t494*t197-0.1D-2*t499*t503
      t507 = t506*t145
      t508 = t507*t209
      t510 = t200*t437
      t511 = t510*t209
      t514 = sigma*t445*t208
      t515 = t201*t514
      t517 = t201*sigma
      t518 = t145*t204
      t519 = sigma*t437
      t523 = 1/t166/t443
      t524 = t146*t523
      t527 = -0.522423459704672D1*t518*t519+0.6965646129395627D1*t524
     &*sigma
      t529 = t152*t527*t208
      t530 = t517*t529
      t532 = t351+t372-t376-t390+t400+t404+t424+t427-t430
     &+0.7420670230672731D-1*t438+0.2473556743557577D-1*t490+0.1D1
     &*t508+0.1D1*t511-0.2333333333333333D1*t515+0.1D1*t530
      t533 = rho*t532
      vrhoa(i) = -0.12407009817988D1*t214*t35-0.9305257363491D0*t241
     &*t35+0.9305257363491D0*t26*t248+rho*(t258-t263+t266+t269+t279
     &+t333+t336-t344)-t89+t123+t140+t189+t211+t533
      t534 = t38*t59
      t538 = 1/t38/t47
      t541 = 0.3360034800657352D-1*t40*t538*t44
      t542 = t47*rhob
      t544 = 1/t48/t542
      t547 = 1.D0+0.10000117555961D1*t51
      t548 = dsqrt(t547)
      t549 = 1/t548
      t551 = 0.3360054550205309D-1*sigmabb*t544*t549
      t554 = 1/t38/t62/t47
      t555 = t61*t554
      t560 = -t541-t551-0.1088885204563779D-1*t555*t53
     &-0.4388082092272149D-1*t56*t544
      t561 = t39*t560
      t564 = t68**2
      t565 = 1/t564
      t567 = -t541-t551-0.5776579334555855D-5*t555
      t568 = t565*t567
      t571 = -t255
      t573 = t101*t571*t120
      t574 = 0.3799574853701528D-1*t573
      t575 = 0.1519829941480611D0*t262
      t576 = t137*t571
      t577 = t576*t118
      t578 = 0.1923661050931536D1*t577
      t579 = 0.7694644203726145D1*t268
      t580 = -t277
      t581 = t270*t580
      t582 = 0.7420670230672731D-1*t581
      t583 = t152*t580
      t586 = t574+t575+t578-t579
      t591 = -0.4042761511756372D2*t586*t156+0.1212828453526912D3*t288
     &*t580
      t592 = t168*t591
      t593 = t592*t159
      t596 = t298*t580
      t599 = -0.1269364121954074D0*t280*t583-0.1086645186223595D-1
     &*t284*t593-0.4346580744894379D-1*t163*t596
      t602 = t152*t591
      t603 = t602*t159
      t606 = t314*t580
      t613 = -0.1712109500228824D0*t309*t603-0.3424219000457648D0*t173
     &*t606-0.5862637881547585D-1*t321*t593-0.1172527576309517D0*t179
     &*t596
      t616 = 0.2697586091519874D1*t599*t183-0.2697586091519874D1*t307
     &*t613
      t617 = t147*t616
      t618 = t617*t331
      t619 = 0.2473556743557577D-1*t618
      t620 = t200*t580
      t621 = t620*t209
      t622 = 0.1D1*t621
      t624 = t340*t580*t208
      t625 = t338*t624
      t626 = 0.522423459704672D1*t625
      vrhob(i) = -0.12407009817988D1*t534*t69-0.9305257363491D0*t561
     &*t69+0.9305257363491D0*t60*t568+rho*(t574+t575+t578-t579+t582
     &+t619+t622-t626)-t89+t123+t140+t189+t211+t533
      t629 = 1/t6
      t632 = 0.1260013050246507D-1*t629*t7*t10
      t634 = 0.1260020456326991D-1*t16*t229
      t635 = t31*t19
      t640 = t632+t634+0.408331951711417D-2*t635*sigmaaa
     &+0.1645530784602056D-1*t21*t16
      t641 = t5*t640
      t646 = t632+t634+0.2166217250458446D-5*sigmaaa*t31
      t647 = t245*t646
      t653 = 0.634682060977037D-1*t174+0.2173290372447189D-1*t173*t169
      t656 = t161*t148
      t661 = 0.1712109500228824D0*t656*t152+0.5862637881547585D-1*t308
     &*t169
      t664 = 0.2697586091519874D1*t653*t183-0.2697586091519874D1*t307
     &*t661
      t666 = t147*t664*t331
      t667 = 0.2473556743557577D-1*t666
      t668 = t152*t208
      t669 = t201*t668
      t670 = 0.1D1*t669
      t671 = t200*t147
      t673 = sigma*t340*t208
      t674 = t671*t673
      t675 = 0.261211729852336D1*t674
      t677 = rho*(t667+t670-t675)
      vsigmaaa(i) = -0.9305257363491D0*t641*t35+0.9305257363491D0*t26
     &*t647+t677
      vsigmaab(i) = 2.D0*t677
      t678 = 1/t40
      t681 = 0.1260013050246507D-1*t678*t41*t44
      t683 = 0.1260020456326991D-1*t50*t549
      t684 = t65*t53
      t689 = t681+t683+0.408331951711417D-2*t684*sigmabb
     &+0.1645530784602056D-1*t55*t50
      t690 = t39*t689
      t695 = t681+t683+0.2166217250458446D-5*sigmabb*t65
      t696 = t565*t695
      vsigmabb(i) = -0.9305257363491D0*t690*t69+0.9305257363491D0*t60
     &*t696+t677
      t705 = 0.2D1*t371
      t706 = 0.7599149707403056D-1*t399
      t707 = 0.3847322101863073D1*t423
      t708 = 0.3847322101863073D1*t426
      t709 = 0.1538928840745229D2*t429
      t710 = t186**2
      t711 = 1/t710
      t715 = sigma*t165
      t716 = t440*t277
      t719 = 1/t107
      t721 = 1/t443
      t726 = 1/t111
      t732 = 0.1111111111111111D0*t719*t103*t721-0.3333333333333333D0
     &*t271*t348+0.1111111111111111D0*t726*t103*t721
     &+0.3333333333333333D0*t274*t348
      t740 = dexp(-0.8085523023512745D2*t157)
      t741 = t740*t291
      t742 = t454*t741
      t745 = t179*t297
      t746 = t159*t277
      t747 = t454*t746
      t753 = 0.8740794299481065D-3*t349*t100*t255*t120
      t754 = t116*t115
      t755 = 1/t754
      t758 = t347*t755*t373*t259
      t759 = 0.3496317719792426D-2*t758
      t763 = 0.1124999956683108D1*t385*t386*t255*t120
      t765 = t385*t387*t267
      t766 = 0.4499999826732431D1*t765
      t767 = 1/t141
      t773 = 1/t143
      t779 = -0.4444444444444444D0*t767*t103*t721-0.1333333333333333D1
     &*t106*t348-0.4444444444444444D0*t773*t103*t721
     &+0.1333333333333333D1*t110*t348
      t782 = 0.3799574853701528D-1*t101*t779*t120
      t785 = t101*t397*t259*t117
      t786 = 0.1519829941480611D0*t785
      t790 = 0.1519829941480611D0*t101*t255*t114*t340
      t792 = t101*t260*t340
      t793 = 0.6079319765922445D0*t792
      t796 = 0.1923661050931536D1*t421*t255*t118
      t797 = t422*t267
      t798 = 0.7694644203726145D1*t797
      t801 = 0.1923661050931536D1*t137*t779*t118
      t802 = t425*t267
      t803 = 0.7694644203726145D1*t802
      t805 = 0.7694644203726145D1*t264*t428
      t807 = t138*t259*t340
      t808 = 0.3077857681490458D2*t807
      t809 = -t753+t759-t763+t766+t782-t786+t790+t793+t796+t798+t801
     &+t803-t805-t808
      t812 = t448*t165
      t815 = t285*t165
      t818 = t155*t297
      t819 = t437*t277
      t824 = -0.4042761511756372D2*t809*t156+0.1212828453526912D3*t812
     &*t277+0.1212828453526912D3*t815*t437-0.4851313814107647D3*t818
     &*t819+0.1212828453526912D3*t288*t732
      t826 = t168*t824*t159
      t829 = t291*t159
      t830 = t454*t829
      t833 = t168*t437
      t834 = t833*t829
      t838 = 1/t164/t146
      t839 = t163*t838
      t840 = t833*t277
      t843 = t298*t732
      t847 = t462*t291*t159
      t850 = t297*t462
      t851 = t850*t277
      t854 = 0.3808092365862222D0*t715*t716-0.1269364121954074D0*t280
     &*t152*t732+0.296184961789284D0*t280*t445*t277
     &+0.2173290372447189D-1*t321*t742+0.4346580744894379D-1*t745*t747
     &-0.1086645186223595D-1*t284*t826-0.1086645186223595D-1*t284*t830
     &+0.4346580744894379D-1*t745*t834+0.2173290372447189D0*t839*t840
     &-0.4346580744894379D-1*t163*t843+0.5071010869043442D-1*t284*t847
     &+0.2028404347617377D0*t163*t851
      t857 = t466*t306
      t860 = t302*t306
      t865 = t172/t305/t182
      t869 = t319*sigma
      t870 = t869*t148
      t874 = t308*t156
      t888 = t173*t165
      t898 = t156*t445
      t902 = t177**2
      t905 = 1/t902*t162*t165
      t908 = t320*t297
      t917 = t179*t838
      t926 = 0.3424219000457648D0*t870*t469*t741+0.3424219000457648D0
     &*t874*t469*t746-0.1712109500228824D0*t309*t152*t824*t159
     &-0.1712109500228824D0*t309*t469*t829+0.3424219000457648D0*t874
     &*t440*t829+0.1027265700137294D1*t888*t716-0.3424219000457648D0
     &*t173*t314*t732+0.3994922167200589D0*t309*t445*t291*t159
     &+0.7989844334401178D0*t173*t898*t277+0.1758791364464276D0*t905
     &*t742+0.2345055152619034D0*t908*t747-0.5862637881547585D-1*t321
     &*t826-0.5862637881547585D-1*t321*t830+0.2345055152619034D0*t908
     &*t834+0.5862637881547585D0*t917*t840-0.1172527576309517D0*t179
     &*t843+0.273589767805554D0*t321*t847+0.547179535611108D0*t179*t851
      t936 = t146*t488
      t937 = t331*t277
      t940 = t146*t329
      t941 = t331*t437
      t944 = -0.2473556743557577D-1*t489*t711*t329
     &+0.2473556743557577D-1*t147*(0.2697586091519874D1*t854*t183
     &-0.2697586091519874D1*t857*t326-0.2697586091519874D1*t860*t485
     &+0.5395172183039748D1*t865*t485*t326-0.2697586091519874D1*t307
     &*t926)*t331+t782+t796+t798+t801+t803-t805-t808+0.1D1*t506*t277
     &*t209+0.7420670230672731D-1*t936*t937+0.7420670230672731D-1*t940
     &*t941-t786+t759
      t946 = 0.7420670230672731D-1*t270*t732
      t953 = t145*t523
      t962 = t334*sigma
      t964 = 0.1D1*t962*t529
      t965 = t340*t527
      t966 = t277*t208
      t969 = 0.522423459704672D1*t338*t965*t966
      t970 = t145*t187
      t972 = 0.1484134046134546D0*t970*t819
      t974 = 0.2333333333333333D1*t334*t514
      t975 = t510*t162
      t976 = t340*t145
      t978 = t975*t976*t966
      t981 = t506*t146*t162
      t983 = 0.522423459704672D1*t981*t342
      t986 = t338*t755*t277*t208
      t990 = 0.1D1*t200*t732*t209
      t991 = -t753+t766-t763+t790+t793+t946+0.1D1*t517*t152*(
     &-0.522423459704672D1*t277*t204*t519-0.522423459704672D1*t518
     &*sigma*t732+0.1393129225879125D2*t953*sigma*t277)*t208+t964-t969
     &+t972-t974-0.522423459704672D1*t978-t983+0.1218988072644235D2
     &*t986+t990
      t993 = rho*(t944+t991)
      t996 = 0.5495599555936838D-2*t350
      t997 = 0.1484134046134546D0*t438
      t1002 = 0.4444444444444444D0*t767*t348+0.4444444444444444D0*t773
     &*t348
      t1005 = 0.3799574853701528D-1*t101*t1002*t120
      t1008 = t101*t255*t259*t117
      t1009 = 0.3039659882961223D0*t1008
      t1012 = t101*t112*t113*t117
      t1013 = 0.4559489824441834D0*t1012
      t1016 = 0.1923661050931536D1*t137*t1002*t118
      t1017 = t264*t267
      t1018 = 0.1538928840745229D2*t1017
      t1020 = t138*t113*t117
      t1021 = 0.2308393261117844D2*t1020
      t1022 = t277**2
      t1031 = -0.1111111111111111D0*t719*t348-0.1111111111111111D0
     &*t726*t348
      t1033 = 0.7420670230672731D-1*t270*t1031
      t1039 = 0.1269364121954074D0*t280*t152*t1031
      t1040 = t291**2
      t1041 = t168*t1040
      t1042 = t1041*t740
      t1045 = t292*t746
      t1056 = 0.1212828453526912D3*t288*t1031
      t1057 = -0.4042761511756372D2*(t1005-t1009-t1013+t1016+t1018
     &+t1021)*t156+0.2425656907053823D3*t815*t277-0.4851313814107647D3
     &*t818*t1022+t1056
      t1059 = t168*t1057*t159
      t1062 = t1041*t159
      t1065 = t838*t168
      t1066 = t1065*t1022
      t1069 = t298*t1031
      t1071 = 0.4346580744894379D-1*t163*t1069
      t1077 = t326**2
      t1080 = t152*t1040
      t1094 = t165*t152
      t1100 = 0.3424219000457648D0*t173*t314*t1031
      t1112 = 0.1172527576309517D0*t179*t1069
      t1113 = 0.3424219000457648D0*t870*t1080*t740
     &+0.6848438000915295D0*t874*t310*t746-0.1712109500228824D0*t309
     &*t152*t1057*t159-0.1712109500228824D0*t309*t1080*t159
     &+0.1027265700137294D1*t173*t1094*t1022-t1100
     &+0.1758791364464276D0*t905*t1042+0.4690110305238068D0*t908*t1045
     &-0.5862637881547585D-1*t321*t1059-0.5862637881547585D-1*t321
     &*t1062+0.5862637881547585D0*t179*t1066-t1112
      t1120 = t329**2
      t1126 = 0.1D1*t200*t1031*t209
      t1129 = t976*t208
      t1135 = 0.522423459704672D1*t338*t340*t1031*t208
      t1137 = t671*t162*sigma
      t1138 = t116*t443
      t1140 = 1/t166/t1138
      t1145 = t1005-t1009-t1013+t1016+t1018+t1021+0.1484134046134546D0
     &*t970*t1022+0.1484134046134546D0*t940*t937+t1033
     &+0.2473556743557577D-1*t147*(0.2697586091519874D1*
     &(0.3808092365862222D0*t715*t152*t1022-t1039
     &+0.2173290372447189D-1*t321*t1042+0.8693161489788758D-1*t745
     &*t1045-0.1086645186223595D-1*t284*t1059-0.1086645186223595D-1
     &*t284*t1062+0.2173290372447189D0*t163*t1066-t1071)*t183
     &-0.5395172183039748D1*t860*t326+0.5395172183039748D1*t865*t1077
     &-0.2697586091519874D1*t307*t1113)*t331-0.2473556743557577D-1
     &*t147*t1120*t711+t1126-0.1567270379114016D2*t200*t1022*t162
     &*t1129-t1135+0.272926271249799D2*t1137*t1140*t1022*t208
      t1147 = 0.1484134046134546D0*t278+0.7599149707403056D-1*t257
     &+0.3847322101863073D1*t265+0.1538928840745229D2*t268
     &-0.3039659882961223D0*t262+0.4947113487115154D-1*t332+t705+t706
     &+t707+t708-t709+t993+0.2D1*t335-0.1044846919409344D2*t343+t996
     &+t997+rho*t1145
      t1148 = 0.1748158859896213D-2*t375
      t1149 = 0.2249999913366216D1*t389
      t1150 = 0.3039659882961223D0*t403
      t1151 = 0.2D1*t530
      t1158 = -t753+t766-t763+t790+t793+t946+t964-t969+t972
     &-0.522423459704672D1*t338*t340*t732*t208-t974
     &-0.1044846919409344D2*t978-t983+0.261211729852336D2*t986+t990
      t1160 = rho*(t944+t1158)
      t1161 = 0.4947113487115154D-1*t490
      t1162 = 0.2D1*t508
      t1163 = 0.2D1*t511
      t1164 = 0.4666666666666667D1*t515
      t1176 = 0.7840081201533821D-1*t6/t4/t222*t10
      t1178 = 1/t14/t28
      t1181 = 0.1680027275102654D0*sigmaaa*t1178*t229
      t1185 = t27/t4/t28/t222
      t1187 = 1/t228/t227
      t1189 = 0.4480125399532632D-1*t1185*t1187
      t1193 = t28**2
      t1217 = -0.1111111111111111D0*t719*t113*t117
     &+0.6666666666666667D0*t431*t721-0.1111111111111111D0*t726*t113
     &*t117-0.6666666666666667D0*t434*t721
      t1220 = t488**2
      t1227 = t462*t453*t159
      t1240 = 0.4444444444444444D0*t767*t113*t117+0.2666666666666667D1
     &*t391*t721+0.4444444444444444D0*t773*t113*t117
     &-0.2666666666666667D1*t394*t721
      t1243 = 0.3799574853701528D-1*t101*t1240*t120
      t1245 = 0.1538928840745229D2*t425*t428
      t1249 = 0.1748158859896213D-2*t349*t100*t397*t120
      t1250 = t347*t721
      t1252 = 0.1748158859896213D-2*t1250*t374
      t1257 = 0.6992635439584852D-2*t347/t1138*t373*t114
      t1260 = 0.1923661050931536D1*t137*t1240*t118
      t1263 = 0.7599149707403056D0*t101*t401*t755
      t1267 = 0.2249999913366216D1*t385*t386*t397*t120
      t1269 = 0.1538928840745229D2*t422*t428
      t1272 = 0.3847322101863073D1*t421*t397*t118
      t1275 = 0.3847322101863073D2*t138*t114*t755
      t1279 = t368**2
      t1281 = t75/t352/t83*t1279*t369
      t1282 = 0.2D1*t1281
      t1283 = t1243-t1245-t1249+t1252-t1257+t1260-t1263-t1267-t1269
     &+t1272+t1275-t1282
      t1286 = 1/t357/t72*t117
      t1288 = t358*t721
      t1292 = 1/t81/t72*t117
      t1297 = 1/t79/t72*t117
      t1299 = t362*t721
      t1303 = 1/t73/t72*t117
      t1305 = t365*t721
      t1309 = t354*(-0.8309097827459833D0*t1286+0.199418347859036D1
     &*t1288-0.4945709824779306D0*t1292+0.1483712947433792D1*t1250
     &-0.2001071587498409D0*t1297+0.8004286349993634D0*t1299
     &-0.4215565168327908D-1*t1303+0.2529339100996745D0*t1305)*t369
      t1310 = 0.1D1*t1309
      t1311 = t352**2
      t1314 = t86**2
      t1317 = t75/t1311*t1279/t1314
      t1318 = 0.160818243221511D2*t1317
      t1330 = t414**2
      t1346 = t407**2
      t1349 = t133**2
      t1354 = t1292*t87
      t1356 = t1250*t87
      t1360 = t349*t353*t368*t369
      t1365 = 0.8806734334819047D-3*t1292*t134-0.2642020300445714D-2
     &*t1250*t134-0.8497974591333914D-1*t349*t408*t414*t415-0.2D1*t125
     &/t407/t130*t1330*t415+0.1D1*t409*(-0.1544496508763151D1*t1286
     &+0.3706791621031562D1*t1288-0.854388052766047D0*t1292
     &+0.2563164158298141D1*t1250-0.4111834438919023D0*t1297
     &+0.1644733775567609D1*t1299-0.5346380647307093D-1*t1303
     &+0.3207828388384256D0*t1305)*t415+0.321646831778707D2*t125/t1346
     &*t1330/t1349-0.1831866518645613D-2*t1354+0.5495599555936838D-2
     &*t1356+0.8837926660346786D-1*t1360+0.2D1*t1281-0.1D1*t1309
     &-0.160818243221511D2*t1317
      t1368 = 0.1923661050931536D1*t1365*t112*t118
      t1369 = 0.8837926660346786D-1*t1360
      t1370 = 0.1831866518645613D-2*t1354
      t1371 = 0.5495599555936838D-2*t1356
      t1375 = t384**2
      t1378 = 0.2249999913366216D1*t91/t377/t96*t1375*t388
      t1380 = 0.5827196199654043D-3*t1292*t374
      t1384 = 0.3039659882961223D0*t101*t397*t114*t340
      t1389 = 0.5176049209143758D-1*t349*t378*t384*t386*t121
      t1390 = t377**2
      t1394 = t99**2
      t1399 = 0.3330964519106732D2*t91/t1390*t1375/t1394*t112*t120
      t1411 = 0.1124999956683108D1*t379*(-0.1132974264373283D1*t1286
     &+0.271913823449588D1*t1288-0.4994648585728036D0*t1292
     &+0.1498394575718411D1*t1250-0.1075243117819161D0*t1297
     &+0.4300972471276643D0*t1299-0.4247805766949639D-1*t1303
     &+0.2548683460169784D0*t1305)*t388
      t1414 = 0.8999999653464862D1*t385*t387*t428
      t1415 = t1310+t1318+t1368-t1369+t1370-t1371+t1378-t1380+t1384
     &+t1389-t1399-t1411-t1414
      t1421 = t437**2
      t1426 = -0.4042761511756372D2*(t1283+t1415)*t156
     &+0.2425656907053823D3*t812*t437-0.4851313814107647D3*t818*t1421
     &+0.1212828453526912D3*t288*t1217
      t1428 = t168*t1426*t159
      t1431 = t159*t437
      t1432 = t454*t1431
      t1445 = 1/t150/t116
      t1448 = t453**2
      t1449 = t168*t1448
      t1450 = t1449*t159
      t1453 = t1449*t740
      t1458 = t165/t166/t754
      t1461 = t850*t437
      t1464 = t298*t1217
      t1467 = t1065*t1421
      t1470 = 0.1014202173808688D0*t284*t1227-0.1086645186223595D-1
     &*t284*t1428+0.8693161489788758D-1*t745*t1432
     &+0.3808092365862222D0*t715*t152*t1421+0.5923699235785679D0*t280
     &*t445*t437-0.1269364121954074D0*t280*t152*t1217
     &+0.4936416029821399D0*t149*t1445-0.1086645186223595D-1*t284
     &*t1450+0.2173290372447189D-1*t321*t1453+0.2873572825791284D0
     &*t163*t1458+0.4056808695234754D0*t163*t1461
     &-0.4346580744894379D-1*t163*t1464+0.2173290372447189D0*t163*t1467
      t1475 = t485**2
      t1491 = t152*t1448
      t1526 = 0.6848438000915295D0*t874*t469*t1431
     &+0.7989844334401178D0*t309*t445*t453*t159-0.1712109500228824D0
     &*t309*t152*t1426*t159+0.547179535611108D0*t321*t1227
     &+0.3424219000457648D0*t870*t1491*t740+0.1758791364464276D0*t905
     &*t1453-0.1712109500228824D0*t309*t1491*t159+0.1331640722400196D1
     &*t173*t148*t1445+0.1027265700137294D1*t173*t1094*t1421
     &+0.1597968866880236D1*t173*t898*t437-0.3424219000457648D0*t173
     &*t314*t1217+0.4690110305238068D0*t908*t1432+0.7751710087824029D0
     &*t179*t1458-0.5862637881547585D-1*t321*t1428
     &+0.1094359071222216D1*t179*t1461-0.5862637881547585D-1*t321
     &*t1450-0.1172527576309517D0*t179*t1464+0.5862637881547585D0*t179
     &*t1467
      t1549 = t503**2
      t1584 = t527**2
      t1597 = t510*sigma
      s2 = 0.1484134046134546D0*t936*t941+0.7420670230672731D-1*t270
     &*t1217-0.2473556743557577D-1*t147*t1220*t711
     &-0.4666666666666667D1*t507*t514+0.2473556743557577D-1*t147*
     &(0.2697586091519874D1*t1470*t183-0.5395172183039748D1*t857*t485
     &+0.5395172183039748D1*t865*t1475-0.2697586091519874D1*t307*t1526
     &)*t331
      s1 = s2+0.2D1*t506*t437*t209+0.1D1*(0.1D-2*(
     &-0.3207349893614542D1*t1292+0.9622049680843627D1*t1250
     &-0.6318986292200858D-3*t1303+0.3791391775320515D-2*t1305)*t197
     &-0.2D-2*t494*t498*t503+0.2D-2*t192/t497/t196*t1549-0.1D-2*t499*(
     &-0.1202514962692326D1*t1292+0.3607544888076978D1*t1250
     &-0.4036488739909061D-1*t1303+0.2421893243945437D0*t1305
     &+0.3527987623518044D-1*t721))*t145*t209+0.1D1*t517*t152*(
     &-0.522423459704672D1*t1421*t204*sigma+0.2786258451758251D2*t953
     &*t519-0.522423459704672D1*t518*sigma*t1217-0.2554070247445063D2
     &*t146*t168*sigma)*t208+0.7777777777777778D1*t201*sigma*t1445
     &*t208+0.1D1*t517*t152*t1584*t208
      t1604 = s1+0.1D1*t200*t1217*t209-0.4666666666666667D1*t510*t514
     &+0.2D1*t507*sigma*t529+0.2D1*t1597*t529-0.4666666666666667D1
     &*t517*t445*t527*t208+t1243-t1245-t1249+t1252-t1257
      t1608 = -t1369+t1370-t1371+0.1484134046134546D0*t970*t1421+t1378
     &-t1380+t1384+t1389-t1399-t1411-t1414
      t1611 = rho*(t1604+t1260-t1263-t1267-t1269+t1272+t1275-t1282
     &+t1310+t1318+t1368+t1608)
      t1622 = 1/t244/t34
      t1623 = t247**2
      t1627 = -t1148-t1149+t1150+t1151+t1160+t1161+t1162+t1163-t1164
     &-0.4135669939329333D0/t14*t25*t35-0.24814019635976D1*t4*t240*t35
     &-0.9305257363491D0*t5*(t1176+t1181-t1189+0.9799966841074009D-1
     &*t1185*t19-0.4778117666686413D-1*t27*sigmaaa/t1193/t13*t19
     &+0.1608963433833121D0*t22*t1178)*t35+t1611+0.18610514726982D1
     &*t241*t248+0.24814019635976D1*t214*t248+0.9305257363491D0*t26
     &*t245*(t1176+t1181-t1189+0.3658500245218708D-4*t1185)
     &-0.18610514726982D1*t26*t1622*t1623
      v2rhoa2(i) = t1147+t1627
      t1631 = t338*t755*t580*t208
      t1633 = t580*t208
      t1636 = 0.522423459704672D1*t338*t965*t1633
      t1639 = 0.1D1*t506*t580*t209
      t1641 = 0.2333333333333333D1*t620*t514
      t1642 = t440*t580
      t1645 = -t732
      t1652 = t740*t591
      t1653 = t454*t1652
      t1656 = t159*t580
      t1657 = t454*t1656
      t1663 = 0.8740794299481065D-3*t349*t100*t571*t120
      t1664 = 0.3496317719792426D-2*t758
      t1668 = 0.1124999956683108D1*t385*t386*t571*t120
      t1669 = 0.4499999826732431D1*t765
      t1670 = -t779
      t1673 = 0.3799574853701528D-1*t101*t1670*t120
      t1674 = 0.1519829941480611D0*t785
      t1678 = 0.1519829941480611D0*t101*t571*t114*t340
      t1679 = 0.6079319765922445D0*t792
      t1682 = 0.1923661050931536D1*t421*t571*t118
      t1683 = 0.7694644203726145D1*t797
      t1686 = 0.1923661050931536D1*t137*t1670*t118
      t1687 = 0.7694644203726145D1*t802
      t1689 = 0.7694644203726145D1*t576*t428
      t1690 = 0.3077857681490458D2*t807
      t1691 = -t1663-t1664-t1668-t1669+t1673+t1674+t1678-t1679+t1682
     &-t1683+t1686-t1687-t1689+t1690
      t1696 = t586*t165
      t1699 = t437*t580
      t1704 = -0.4042761511756372D2*t1691*t156+0.1212828453526912D3
     &*t812*t580+0.1212828453526912D3*t1696*t437-0.4851313814107647D3
     &*t818*t1699+0.1212828453526912D3*t288*t1645
      t1706 = t168*t1704*t159
      t1709 = t591*t159
      t1710 = t454*t1709
      t1713 = t833*t1709
      t1716 = t833*t580
      t1719 = t298*t1645
      t1723 = t462*t591*t159
      t1726 = t850*t580
      t1729 = 0.3808092365862222D0*t715*t1642-0.1269364121954074D0
     &*t280*t152*t1645+0.296184961789284D0*t280*t445*t580
     &+0.2173290372447189D-1*t321*t1653+0.4346580744894379D-1*t745
     &*t1657-0.1086645186223595D-1*t284*t1706-0.1086645186223595D-1
     &*t284*t1710+0.4346580744894379D-1*t745*t1713
     &+0.2173290372447189D0*t839*t1716-0.4346580744894379D-1*t163
     &*t1719+0.5071010869043442D-1*t284*t1723+0.2028404347617377D0
     &*t163*t1726
      t1734 = t599*t306
      t1786 = 0.3424219000457648D0*t870*t469*t1652
     &+0.3424219000457648D0*t874*t469*t1656-0.1712109500228824D0*t309
     &*t152*t1704*t159-0.1712109500228824D0*t309*t469*t1709
     &+0.3424219000457648D0*t874*t440*t1709+0.1027265700137294D1*t888
     &*t1642-0.3424219000457648D0*t173*t314*t1645+0.3994922167200589D0
     &*t309*t445*t591*t159+0.7989844334401178D0*t173*t898*t580
     &+0.1758791364464276D0*t905*t1653+0.2345055152619034D0*t908*t1657
     &-0.5862637881547585D-1*t321*t1706-0.5862637881547585D-1*t321
     &*t1710+0.2345055152619034D0*t908*t1713+0.5862637881547585D0*t917
     &*t1716-0.1172527576309517D0*t179*t1719+0.273589767805554D0*t321
     &*t1723+0.547179535611108D0*t179*t1726
      t1792 = 0.2473556743557577D-1*t147*(0.2697586091519874D1*t1729
     &*t183-0.2697586091519874D1*t857*t613-0.2697586091519874D1*t1734
     &*t485+0.5395172183039748D1*t865*t485*t613-0.2697586091519874D1
     &*t307*t1786)*t331
      t1793 = t331*t580
      t1795 = 0.7420670230672731D-1*t936*t1793
      t1797 = 0.522423459704672D1*t981*t624
      t1798 = 0.1218988072644235D2*t1631-t1636+t1639-t1641+t1792+t1795
     &-t1797-t1663+t1682+t1673-t1683-t1687+t1690-t1668
      t1799 = t976*t1633
      t1800 = t975*t1799
      t1804 = 0.1D1*t200*t1645*t209
      t1805 = t146*t616
      t1807 = 0.7420670230672731D-1*t1805*t941
      t1809 = 0.1484134046134546D0*t970*t1699
      t1811 = 0.7420670230672731D-1*t270*t1645
      t1812 = t620*sigma
      t1814 = 0.1D1*t1812*t529
      t1815 = t711*t616
      t1817 = 0.2473556743557577D-1*t489*t1815
      t1832 = t1678-0.522423459704672D1*t1800+t1686-t1689+t1804+t1674
     &+t1807+t1809-t1664+t1811-t1669+t1814-t1679-t1817+0.1D1*t517*t152
     &*(-0.522423459704672D1*t580*t204*t519-0.522423459704672D1*t518
     &*sigma*t1645+0.1393129225879125D2*t953*sigma*t580)*t208
      t1834 = rho*(t1798+t1832)
      t1848 = 0.7840081201533821D-1*t40/t38/t542*t44
      t1850 = 1/t48/t62
      t1853 = 0.1680027275102654D0*sigmabb*t1850*t549
      t1857 = t61/t38/t62/t542
      t1859 = 1/t548/t547
      t1861 = 0.4480125399532632D-1*t1857*t1859
      t1865 = t62**2
      t1880 = -0.1538928840745229D2*t268+t1834+0.24814019635976D1*t534
     &*t568+0.3039659882961223D0*t262-0.4135669939329333D0/t48*t59*t69
     &+t705+t706+t707+t708-t709+0.18610514726982D1*t561*t568+t996+t997
     &-0.9305257363491D0*t39*(t1848+t1853-t1861+0.9799966841074009D-1
     &*t1857*t53-0.4778117666686413D-1*t61*sigmabb/t1865/t47*t53
     &+0.1608963433833121D0*t56*t1850)*t69-0.24814019635976D1*t38*t560
     &*t69-t1148-t1149
      t1886 = 0.261211729852336D2*t1631-t1636+t1639
     &-0.522423459704672D1*t338*t340*t1645*t208-t1641+t1792+t1795
     &-t1797-t1663+t1682+t1673-t1683-t1687+t1690
      t1888 = -t1668+t1678-0.1044846919409344D2*t1800+t1686-t1689
     &+t1804+t1674+t1807+t1809-t1664+t1811-t1669+t1814-t1679-t1817
      t1890 = rho*(t1886+t1888)
      t1899 = 1/t564/t68
      t1900 = t567**2
      t1907 = t101*t571*t259*t117
      t1908 = 0.3039659882961223D0*t1907
      t1909 = t576*t267
      t1910 = 0.1538928840745229D2*t1909
      t1911 = t580**2
      t1919 = t591**2
      t1920 = t168*t1919
      t1921 = t1920*t740
      t1924 = t592*t1656
      t1934 = -0.4042761511756372D2*(t1005+t1908-t1013+t1016-t1910
     &+t1021)*t156+0.2425656907053823D3*t1696*t580
     &-0.4851313814107647D3*t818*t1911+t1056
      t1936 = t168*t1934*t159
      t1939 = t1920*t159
      t1942 = t1065*t1911
      t1950 = t613**2
      t1953 = t152*t1919
      t1980 = 0.3424219000457648D0*t870*t1953*t740
     &+0.6848438000915295D0*t874*t602*t1656-0.1712109500228824D0*t309
     &*t152*t1934*t159-0.1712109500228824D0*t309*t1953*t159
     &+0.1027265700137294D1*t173*t1094*t1911-t1100
     &+0.1758791364464276D0*t905*t1921+0.4690110305238068D0*t908*t1924
     &-0.5862637881547585D-1*t321*t1936-0.5862637881547585D-1*t321
     &*t1939+0.5862637881547585D0*t179*t1942-t1112
      t1987 = t616**2
      t1999 = t1005+t1908-t1013+t1016-t1910+t1021+0.1484134046134546D0
     &*t970*t1911+0.1484134046134546D0*t1805*t1793+t1033
     &+0.2473556743557577D-1*t147*(0.2697586091519874D1*
     &(0.3808092365862222D0*t715*t152*t1911-t1039
     &+0.2173290372447189D-1*t321*t1921+0.8693161489788758D-1*t745
     &*t1924-0.1086645186223595D-1*t284*t1936-0.1086645186223595D-1
     &*t284*t1939+0.2173290372447189D0*t163*t1942-t1071)*t183
     &-0.5395172183039748D1*t1734*t613+0.5395172183039748D1*t865*t1950
     &-0.2697586091519874D1*t307*t1980)*t331-0.2473556743557577D-1
     &*t147*t1987*t711+t1126-0.1567270379114016D2*t200*t1911*t162
     &*t1129-t1135+0.272926271249799D2*t1137*t1140*t1911*t208
      t2004 = t1150+t1890+t1151+0.7599149707403056D-1*t573
     &+0.3847322101863073D1*t577+0.9305257363491D0*t60*t565*(t1848
     &+t1853-t1861+0.3658500245218708D-4*t1857)-0.18610514726982D1*t60
     &*t1899*t1900+t1161+0.1484134046134546D0*t581+rho*t1999+t1162
     &+t1163-t1164+0.4947113487115154D-1*t618+t1611+0.2D1*t621
     &-0.1044846919409344D2*t625
      v2rhob2(i) = t1880+t2004
      t2007 = t279+t258+t266+0.5D0*t1834+t333+t705+t706+t707+t708-t709
     &+0.5D0*t993+t336-t344+t996+t997-t1148
      t2010 = -t1002
      t2013 = 0.3799574853701528D-1*t101*t2010*t120
      t2014 = 0.1519829941480611D0*t1008
      t2015 = 0.1519829941480611D0*t1907
      t2016 = 0.4559489824441834D0*t1012
      t2019 = 0.1923661050931536D1*t137*t2010*t118
      t2020 = 0.7694644203726145D1*t1017
      t2021 = 0.7694644203726145D1*t1909
      t2022 = 0.2308393261117844D2*t1020
      t2023 = t277*t580
      t2028 = -t1031
      t2033 = t281*t580
      t2039 = t292*t1652
      t2042 = t292*t1656
      t2056 = -0.4042761511756372D2*(t2013+t2014-t2015+t2016+t2019
     &-t2020+t2021-t2022)*t156+0.1212828453526912D3*t815*t580
     &+0.1212828453526912D3*t1696*t277-0.4851313814107647D3*t818*t2023
     &+0.1212828453526912D3*t288*t2028
      t2058 = t168*t2056*t159
      t2061 = t292*t1709
      t2064 = t168*t277
      t2065 = t2064*t1709
      t2068 = t2064*t580
      t2071 = t298*t2028
      t2119 = 0.3424219000457648D0*t870*t310*t1652
     &+0.3424219000457648D0*t874*t310*t1656-0.1712109500228824D0*t309
     &*t152*t2056*t159-0.1712109500228824D0*t309*t310*t1709
     &+0.3424219000457648D0*t874*t281*t1709+0.1027265700137294D1*t888
     &*t2033-0.3424219000457648D0*t173*t314*t2028+0.1758791364464276D0
     &*t905*t2039+0.2345055152619034D0*t908*t2042
     &-0.5862637881547585D-1*t321*t2058-0.5862637881547585D-1*t321
     &*t2061+0.2345055152619034D0*t908*t2065+0.5862637881547585D0*t917
     &*t2068-0.1172527576309517D0*t179*t2071
      t2138 = t1140*t277
      s1 = t2013+t2014-t2015+t2016+t2019-t2020+t2021-t2022
     &+0.1484134046134546D0*t970*t2023
      s2 = s1+0.7420670230672731D-1*t1805*t937+0.7420670230672731D-1
     &*t270*t2028+0.7420670230672731D-1*t940*t1793
     &+0.2473556743557577D-1*t147*(0.2697586091519874D1*
     &(0.3808092365862222D0*t715*t2033-0.1269364121954074D0*t280*t152
     &*t2028+0.2173290372447189D-1*t321*t2039+0.4346580744894379D-1
     &*t745*t2042-0.1086645186223595D-1*t284*t2058
     &-0.1086645186223595D-1*t284*t2061+0.4346580744894379D-1*t745
     &*t2065+0.2173290372447189D0*t839*t2068-0.4346580744894379D-1
     &*t163*t2071)*t183-0.2697586091519874D1*t860*t613
     &-0.2697586091519874D1*t1734*t326+0.5395172183039748D1*t865*t326
     &*t613-0.2697586091519874D1*t307*t2119)*t331
      t2142 = s2-0.2473556743557577D-1*t330*t1815+0.1D1*t200*t2028
     &*t209-0.1567270379114016D2*t334*t162*t1799-0.522423459704672D1
     &*t338*t340*t2028*t208+0.272926271249799D2*t1137*t2138*t1633
      t2144 = -t1149+t1150+0.5D0*t1890+t1151+t574+t578+0.5D0*t1160
     &+t1161+t582+t1162+t1163-t1164+t619+t1611+t622-t626+rho*t2142
      v2rhoab(i) = t2007+t2144
      t2152 = 0.1680017400328676D-1*t629*t218*t10
      t2154 = 0.5040081825307963D-1*t224*t229
      t2155 = sigmaaa*t234
      t2157 = 0.1680047024824737D-1*t2155*t1187
      t2185 = t146*t664
      t2189 = t308*t165
      t2199 = t653*t306
      t2205 = t178*t148
      t2208 = t161*t156
      t2211 = t869*t165
      t2223 = t711*t664
      t2229 = t340*t146*t208
      t2233 = t200*t164*t162
      t2238 = rho*(0.7420670230672731D-1*t2185*t937
     &+0.2473556743557577D-1*t147*(0.2697586091519874D1*(
     &-0.1269364121954074D0*t315-0.2173290372447189D-1*t2189*t293
     &-0.8693161489788758D-1*t173*t299)*t183-0.2697586091519874D1*t860
     &*t661-0.2697586091519874D1*t2199*t326+0.5395172183039748D1*t865
     &*t326*t661-0.2697586091519874D1*t307*(-0.1712109500228824D0
     &*t2205*t311-0.3424219000457648D0*t2208*t281-0.1172527576309517D0
     &*t2211*t293-0.2345055152619034D0*t308*t299))*t331
     &-0.2473556743557577D-1*t330*t2223+0.1D1*t334*t668
     &-0.130605864926168D2*t962*t2229+0.1364631356248995D2*t2233*t2138
     &*t208)
      s1 = 0.7420670230672731D-1*t2185*t941+0.2473556743557577D-1*t147
     &*(0.2697586091519874D1*(-0.1269364121954074D0*t473
     &-0.148092480894642D0*t476-0.2173290372447189D-1*t2189*t455
     &-0.8693161489788758D-1*t173*t458-0.1014202173808688D0*t173*t463)
     &*t183-0.2697586091519874D1*t857*t661-0.2697586091519874D1*t2199
     &*t485+0.5395172183039748D1*t865*t485*t661-0.2697586091519874D1
     &*t307*(-0.1712109500228824D0*t2205*t470-0.3424219000457648D0
     &*t2208*t440-0.3994922167200589D0*t656*t445-0.1172527576309517D0
     &*t2211*t455-0.2345055152619034D0*t308*t458-0.273589767805554D0
     &*t308*t463))*t331-0.2473556743557577D-1*t489*t2223+0.1D1*t507
     &*t668-0.261211729852336D1*t506*t147*t673+0.1D1*t510*t668
      t2310 = s1-0.261211729852336D1*t1597*t2229-0.2333333333333333D1
     &*t201*t445*t208+0.6094940363221173D1*t671*sigma*t755*t208+0.1D1
     &*t201*t529+0.1D1*t517*t152*(-0.522423459704672D1*t518*t437
     &+0.6965646129395627D1*t524)*t208-0.261211729852336D1*t671*sigma
     &*t965*t208
      t2311 = rho*t2310
      v2rhoasigmaaa(i) = -0.12407009817988D1*t4*t640*t35
     &+0.12407009817988D1*t214*t647-0.9305257363491D0*t5*(-t2152-t2154
     &+t2157-0.3266655613691336D-1*t234*t19*sigmaaa
     &+0.1791794125007405D-1*t27/t1193/rhoa*t19-0.4388082092272149D-1
     &*t21*t224)*t35+0.9305257363491D0*t241*t647+0.9305257363491D0
     &*t641*t248-0.18610514726982D1*t26*t1622*t247*t646
     &+0.9305257363491D0*t26*t245*(-t2152-t2154+t2157
     &-0.1155315866911171D-4*t2155)+t2238+t667+t670-t675+t2311
      t2313 = 0.4947113487115154D-1*t666
      t2314 = 0.2D1*t669
      t2315 = 0.522423459704672D1*t674
      t2316 = 2.D0*t2311
      v2rhoasigmaab(i) = 2.D0*t2238+t2313+t2314-t2315+t2316
      v2rhoasigmabb(i) = t2238+t667+t670-t675+t2311
      t2360 = rho*(0.7420670230672731D-1*t2185*t1793
     &+0.2473556743557577D-1*t147*(0.2697586091519874D1*(
     &-0.1269364121954074D0*t606-0.2173290372447189D-1*t2189*t593
     &-0.8693161489788758D-1*t173*t596)*t183-0.2697586091519874D1
     &*t1734*t661-0.2697586091519874D1*t2199*t613+0.5395172183039748D1
     &*t865*t613*t661-0.2697586091519874D1*t307*(-0.1712109500228824D0
     &*t2205*t603-0.3424219000457648D0*t2208*t583-0.1172527576309517D0
     &*t2211*t593-0.2345055152619034D0*t308*t596))*t331
     &-0.2473556743557577D-1*t617*t2223+0.1D1*t620*t668
     &-0.130605864926168D2*t1812*t2229+0.1364631356248995D2*t2233
     &*t1140*t580*t208)
      v2rhobsigmaaa(i) = t2360+t667+t670-t675+t2311
      v2rhobsigmaab(i) = 2.D0*t2360+t2313+t2314-t2315+t2316
      t2369 = 0.1680017400328676D-1*t678*t538*t44
      t2371 = 0.5040081825307963D-1*t544*t549
      t2372 = sigmabb*t554
      t2374 = 0.1680047024824737D-1*t2372*t1859
      v2rhobsigmabb(i) = -0.12407009817988D1*t38*t689*t69
     &+0.12407009817988D1*t534*t696-0.9305257363491D0*t39*(-t2369
     &-t2371+t2374-0.3266655613691336D-1*t554*t53*sigmabb
     &+0.1791794125007405D-1*t61/t1865/rhob*t53-0.4388082092272149D-1
     &*t55*t544)*t69+0.9305257363491D0*t561*t696+0.9305257363491D0
     &*t690*t568-0.18610514726982D1*t60*t1899*t567*t695
     &+0.9305257363491D0*t60*t565*(-t2369-t2371+t2374
     &-0.1155315866911171D-4*t2372)+t2360+t667+t670-t675+t2311
      t2406 = 0.6300065251232535D-2/t6/sigmaaa*t7*t10
      t2410 = 0.6300102281634954D-2/sigmaaa*t16*t229
      t2412 = 0.6300176343092764D-2*t31*t1187
      t2424 = t646**2
      t2439 = t661**2
      t2450 = t664**2
      t2463 = rho*(0.2473556743557577D-1*t147*(0.5862637881547585D-1
     &*t161*t165*t168*t183-0.5395172183039748D1*t2199*t661
     &+0.5395172183039748D1*t865*t2439-0.1581497040888031D0*t307*t178
     &*t165*t168)*t331-0.2473556743557577D-1*t147*t2450*t711
     &-0.522423459704672D1*t671*t340*t208+0.6823156781244976D1*t200
     &*t296*sigma*t1140*t208)
      v2sigmaaa2(i) = -0.9305257363491D0*t5*(-t2406+t2410-t2412
     &-0.6719227968777768D-2/t1193*t19*sigmaaa+0.8166639034228341D-2
     &*t635)*t35+0.18610514726982D1*t641*t647-0.18610514726982D1*t26
     &*t1622*t2424+0.9305257363491D0*t26*t245*(-t2406+t2410-t2412
     &+0.2166217250458446D-5*t31)+t2463
      v2sigmaaaab(i) = 2.D0*t2463
      v2sigmaaabb(i) = t2463
      v2sigmaab2(i) = 4.D0*v2sigmaaabb(i)
      v2sigmaabbb(i) = v2sigmaaaab(i)
      t2468 = 0.6300065251232535D-2/t40/sigmabb*t41*t44
      t2472 = 0.6300102281634954D-2/sigmabb*t50*t549
      t2474 = 0.6300176343092764D-2*t65*t1859
      t2486 = t695**2
      v2sigmabb2(i) = -0.9305257363491D0*t39*(-t2468+t2472-t2474
     &-0.6719227968777768D-2/t1865*t53*sigmabb+0.8166639034228341D-2
     &*t684)*t69+0.18610514726982D1*t690*t696-0.18610514726982D1*t60
     &*t1899*t2486+0.9305257363491D0*t60*t565*(-t2468+t2472-t2474
     &+0.2166217250458446D-5*t65)+v2sigmaaabb(i)
      endif ! rhoa,rhob
      else ! rho
      zk(i) = 0.0d0
      vrhoa(i) = 0.0d0
      vrhob(i) = 0.0d0
      v2rhoa2(i) = 0.0d0
      v2rhob2(i) = 0.0d0
      v2rhoab(i) = 0.0d0
      vsigmaaa(i) = 0.0d0
      vsigmaab(i) = 0.0d0
      vsigmabb(i) = 0.0d0
      v2rhoasigmaaa(i) = 0.0d0
      v2rhoasigmaab(i) = 0.0d0
      v2rhoasigmabb(i) = 0.0d0
      v2rhobsigmaaa(i) = 0.0d0
      v2rhobsigmaab(i) = 0.0d0
      v2rhobsigmabb(i) = 0.0d0
      v2sigmaaa2(i) = 0.0d0
      v2sigmaab2(i) = 0.0d0
      v2sigmabb2(i) = 0.0d0
      v2sigmaaaab(i) = 0.0d0
      v2sigmaaabb(i) = 0.0d0
      v2sigmaabbb(i) = 0.0d0
      endif ! rho
      enddo
      
      endif ! ideriv
      return
      end
      
      
      subroutine rks_xc_pw91
     & (ideriv,npt,rhoa1,sigmaaa1,
     &  zk,vrhoa,vsigmaaa,
     &  v2rhoa2,v2rhoasigmaaa,v2sigmaaa2)
c
c     J.P. Perdew, J.A. Chevary, S.H. Vosko, K.A. Jackson,
c     M.R. Pederson, D.J. Singh, C. Fiolhais
c     Atoms, molecules, solids and surfaces:
c     Applications of the generalized gradient approximation
c     for exchange and correlation
c     Phys. Rev. B 46 (1992) 6671--6687
c
c
c     CITATION:
c
c     Functionals were obtained from the Density Functional Repository 
c     as developed and distributed by the Quantum Chemistry Group, 
c     CCLRC Daresbury Laboratory, Daresbury, Cheshire, WA4 4AD 
c     United Kingdom. Contact Huub van Dam (h.j.j.vandam@dl.ac.uk) or 
c     Paul Sherwood for further information.
c
c     COPYRIGHT:
c
c     Users may incorporate the source code into software packages and
c     redistribute the source code provided the source code is not
c     changed in anyway and is properly cited in any documentation or
c     publication related to its use.
c
c     ACKNOWLEDGEMENT:
c
c     The source code was generated using Maple 8 through a modified
c     version of the dfauto script published in:
c
c        R. Strange, F.R. Manby, P.J. Knowles
c        Automatic code generation in density functional theory
c        Comp. Phys. Comm. 136 (2001) 310-318.
c
      implicit real*8 (a-h,o-z)
      integer ideriv,npt
      real*8 rhoa1(npt)
      real*8 sigmaaa1(npt)
      real*8 zk(npt),vrhoa(npt),vsigmaaa(npt)
      real*8 v2rhoa2(npt),v2rhoasigmaaa(npt),v2sigmaaa2(npt)
      parameter(tol=1.0d-20)
      
      if(ideriv.eq.0) then
      
      do i=1,npt
      rho = dmax1(0.D0,rhoa1(i))
      if(rho.gt.tol) then
      sigma = dmax1(0.D0,sigmaaa1(i))
      t2 = rho**(1.D0/3.D0)
      t3 = t2*rho
      t4 = dsqrt(sigma)
      t6 = t4/t3
      t8 = dlog(0.1259928455434599D1*t6+dsqrt(1+0.1587419712813814D1
     &*t6**2))
      t10 = 0.3175033930295641D-1*t6*t8
      t11 = rho**2
      t12 = t2**2
      t14 = 1/t12/t11
      t17 = dexp(-0.261211729852336D1*t14*sigma)
      t25 = sigma**2
      t26 = t11**2
      t36 = 1/rho
      t37 = t36**(1.D0/3.D0)
      t40 = t36**(1.D0/6.D0)
      t43 = dsqrt(t36)
      t45 = t37**2
      t51 = dlog(1.D0+0.160818243221511D2/(0.598255043577108D1*t40
     &+0.2225569421150687D1*t37+0.8004286349993634D0*t43
     &+0.1897004325747559D0*t45))
      t52 = (1.D0+0.1325688999052018D0*t37)*t51
      t55 = 1/t2/t11
      t59 = dexp(0.2513869963240348D1*t52)
      t60 = t59-1.D0
      t61 = 1/t60
      t64 = 1/t12/t26
      t71 = t60**2
      t81 = dlog(1.D0+0.2697586091519874D1*(0.634682060977037D-1*sigma
     &*t55+0.1086645186223595D-1*t61*t25*t64)/(1.D0
     &+0.1712109500228824D0*t61*sigma*t55+0.2931318940773793D-1/t71
     &*t25*t64))
      zk(i) = -0.7385587663820224D0*t3*(1.D0+t10+0.261211729852336D-1*
     &(0.2743D0-0.1508D0*t17)*sigma*t14)/(1.D0+t10
     &+0.272926271249799D-5*t25/t2/t26/rho)+rho*(-0.62182D-1*t52
     &+0.2473556743557577D-1*t81+0.1D1*(0.1D-2*(0.2568D1
     &+0.1443307452126544D2*t37+0.2843543831490386D-2*t45)/(1.D0
     &+0.5411317332115466D1*t37+0.1816419932959077D0*t45
     &+0.1763993811759022D-1*t36)-0.1853571428571429D-2)*sigma*t55*t17)
      else ! rho
      zk(i) = 0.0d0
      endif ! rho
      enddo
      
      else if(ideriv.eq.1) then
      
      do i=1,npt
      rho = dmax1(0.D0,rhoa1(i))
      if(rho.gt.tol) then
      sigma = dmax1(0.D0,sigmaaa1(i))
      t2 = rho**(1.D0/3.D0)
      t3 = t2*rho
      t4 = dsqrt(sigma)
      t5 = 1/t3
      t6 = t4*t5
      t8 = dlog(0.1259928455434599D1*t6+dsqrt(1+0.1587419712813814D1
     &*t6**2))
      t10 = 0.3175033930295641D-1*t6*t8
      t11 = rho**2
      t12 = t2**2
      t14 = 1/t12/t11
      t15 = t14*sigma
      t17 = dexp(-0.261211729852336D1*t15)
      t19 = 0.2743D0-0.1508D0*t17
      t20 = t19*sigma
      t23 = 1.D0+t10+0.261211729852336D-1*t20*t14
      t24 = t3*t23
      t25 = sigma**2
      t26 = t11**2
      t27 = t26*rho
      t29 = 1/t2/t27
      t32 = 1.D0+t10+0.272926271249799D-5*t25*t29
      t33 = 1/t32
      t36 = 1/rho
      t37 = t36**(1.D0/3.D0)
      t39 = 1.D0+0.1325688999052018D0*t37
      t40 = t36**(1.D0/6.D0)
      t43 = dsqrt(t36)
      t45 = t37**2
      t47 = 0.598255043577108D1*t40+0.2225569421150687D1*t37
     &+0.8004286349993634D0*t43+0.1897004325747559D0*t45
      t50 = 1.D0+0.160818243221511D2/t47
      t51 = dlog(t50)
      t52 = t39*t51
      t53 = 0.62182D-1*t52
      t55 = 1/t2/t11
      t59 = dexp(0.2513869963240348D1*t52)
      t60 = t59-1.D0
      t61 = 1/t60
      t62 = t61*t25
      t64 = 1/t12/t26
      t67 = 0.634682060977037D-1*sigma*t55+0.1086645186223595D-1*t62*t64
      t68 = t61*sigma
      t71 = t60**2
      t72 = 1/t71
      t73 = t72*t25
      t76 = 1.D0+0.1712109500228824D0*t68*t55+0.2931318940773793D-1
     &*t73*t64
      t77 = 1/t76
      t80 = 1.D0+0.2697586091519874D1*t67*t77
      t81 = dlog(t80)
      t82 = 0.2473556743557577D-1*t81
      t85 = 0.2568D1+0.1443307452126544D2*t37+0.2843543831490386D-2*t45
      t89 = 1.D0+0.5411317332115466D1*t37+0.1816419932959077D0*t45
     &+0.1763993811759022D-1*t36
      t90 = 1/t89
      t93 = 0.1D-2*t85*t90-0.1853571428571429D-2
      t94 = t93*sigma
      t95 = t55*t17
      t97 = 0.1D1*t94*t95
      zk(i) = -0.7385587663820224D0*t24*t33+rho*(-t53+t82+t97)
      t105 = 0.8466757147455043D-1*t4*t55*t8
      t106 = t11*rho
      t108 = 1/t12/t106
      t112 = dsqrt(1.D0+0.1587419712813815D1*t15)
      t113 = 1/t112
      t115 = 0.1066750825533289D0*sigma*t108*t113
      t116 = t26*t11
      t119 = t25/t2/t116
      t128 = t32**2
      t129 = 1/t128
      t136 = 1/t11
      t137 = 1/t45*t136
      t138 = t137*t51
      t140 = t47**2
      t143 = t40**2
      t144 = t143**2
      t154 = 1/t37*t136
      t159 = t39/t140*(-0.99709173929518D0/t144/t40*t136
     &-0.7418564737168958D0*t137-0.4002143174996817D0/t43*t136
     &-0.1264669550498372D0*t154)/t50
      t162 = 1/t2/t106
      t167 = -0.1110869918438343D0*t138-0.4042761511756372D2*t159
      t169 = t64*t167*t59
      t173 = 1/t12/t27
      t179 = t76**2
      t181 = t67/t179
      t182 = t72*sigma
      t200 = 1/t80
      t208 = t89**2
      s1 = -0.9847450218426965D0*t2*t23*t33-0.3692793831910112D0*t3*(
     &-t105-t115-0.5487637560595959D-1*t119*t17-0.1393129225879125D0
     &*t20*t108)*t33+0.3692793831910112D0*t24*t129*(-t105-t115
     &-0.2911213559997856D-4*t119)
      vrhoa(i) = s1-t53+t82+t97+rho*(0.2747799777968419D-2*t138+0.1D1
     &*t159+0.2473556743557577D-1*(0.2697586091519874D1*(
     &-0.148092480894642D0*sigma*t162-0.1086645186223595D-1*t73*t169
     &-0.5071010869043442D-1*t62*t173)*t77-0.2697586091519874D1*t181*(
     &-0.1712109500228824D0*t182*t55*t167*t59-0.3994922167200589D0*t68
     &*t162-0.5862637881547585D-1/t71/t60*t25*t169-0.136794883902777D0
     &*t73*t173))*t200+0.1D1*(0.1D-2*(-0.4811024840421814D1*t137
     &-0.1895695887660258D-2*t154)*t90-0.1D-2*t85/t208*(
     &-0.1803772444038489D1*t137-0.1210946621972718D0*t154
     &-0.1763993811759022D-1*t136))*sigma*t95-0.2333333333333333D1*t94
     &*t162*t17+0.6965646129395627D1*t93*t25/t116*t17)
      t234 = 0.6350067860591282D-1/t4*t5*t8
      t236 = 0.8000631191499664D-1*t14*t113
      vsigmaaa(i) = -0.7385587663820224D0*t3*(t234+t236
     &+0.411572817044697D-1*t29*t17*sigma+0.1044846919409344D0*t19*t14
     &)*t33+0.7385587663820224D0*t24*t129*(t234+t236
     &+0.2183410169998392D-4*sigma*t29)+4.D0*rho*
     &(0.2473556743557577D-1*(0.2697586091519874D1*
     &(0.634682060977037D-1*t55+0.2173290372447189D-1*t68*t64)*t77
     &-0.2697586091519874D1*t181*(0.1712109500228824D0*t61*t55
     &+0.5862637881547585D-1*t182*t64))*t200+0.1D1*t93*t55*t17
     &-0.261211729852336D1*t94/t27*t17)
      else ! rho
      zk(i) = 0.0d0
      vrhoa(i) = 0.0d0
      vsigmaaa(i) = 0.0d0
      endif ! rho
      enddo
      
      else if(ideriv.eq.2) then
      
      do i=1,npt
      rho = dmax1(0.D0,rhoa1(i))
      if(rho.gt.tol) then
      sigma = dmax1(0.D0,sigmaaa1(i))
      t2 = rho**(1.D0/3.D0)
      t3 = t2*rho
      t4 = dsqrt(sigma)
      t5 = 1/t3
      t6 = t4*t5
      t8 = dlog(0.1259928455434599D1*t6+dsqrt(1+0.1587419712813814D1
     &*t6**2))
      t10 = 0.3175033930295641D-1*t6*t8
      t11 = rho**2
      t12 = t2**2
      t14 = 1/t12/t11
      t15 = t14*sigma
      t17 = dexp(-0.261211729852336D1*t15)
      t19 = 0.2743D0-0.1508D0*t17
      t20 = t19*sigma
      t23 = 1.D0+t10+0.261211729852336D-1*t20*t14
      t24 = t3*t23
      t25 = sigma**2
      t26 = t11**2
      t27 = t26*rho
      t29 = 1/t2/t27
      t32 = 1.D0+t10+0.272926271249799D-5*t25*t29
      t33 = 1/t32
      t36 = 1/rho
      t37 = t36**(1.D0/3.D0)
      t39 = 1.D0+0.1325688999052018D0*t37
      t40 = t36**(1.D0/6.D0)
      t43 = dsqrt(t36)
      t45 = t37**2
      t47 = 0.598255043577108D1*t40+0.2225569421150687D1*t37
     &+0.8004286349993634D0*t43+0.1897004325747559D0*t45
      t50 = 1.D0+0.160818243221511D2/t47
      t51 = dlog(t50)
      t52 = t39*t51
      t53 = 0.62182D-1*t52
      t55 = 1/t2/t11
      t59 = dexp(0.2513869963240348D1*t52)
      t60 = t59-1.D0
      t61 = 1/t60
      t62 = t61*t25
      t64 = 1/t12/t26
      t67 = 0.634682060977037D-1*sigma*t55+0.1086645186223595D-1*t62*t64
      t68 = t61*sigma
      t71 = t60**2
      t72 = 1/t71
      t73 = t72*t25
      t76 = 1.D0+0.1712109500228824D0*t68*t55+0.2931318940773793D-1
     &*t73*t64
      t77 = 1/t76
      t80 = 1.D0+0.2697586091519874D1*t67*t77
      t81 = dlog(t80)
      t82 = 0.2473556743557577D-1*t81
      t85 = 0.2568D1+0.1443307452126544D2*t37+0.2843543831490386D-2*t45
      t89 = 1.D0+0.5411317332115466D1*t37+0.1816419932959077D0*t45
     &+0.1763993811759022D-1*t36
      t90 = 1/t89
      t93 = 0.1D-2*t85*t90-0.1853571428571429D-2
      t94 = t93*sigma
      t95 = t55*t17
      t97 = 0.1D1*t94*t95
      zk(i) = -0.7385587663820224D0*t24*t33+rho*(-t53+t82+t97)
      t100 = t2*t23
      t105 = 0.8466757147455043D-1*t4*t55*t8
      t106 = t11*rho
      t108 = 1/t12/t106
      t111 = 1.D0+0.1587419712813815D1*t15
      t112 = dsqrt(t111)
      t113 = 1/t112
      t115 = 0.1066750825533289D0*sigma*t108*t113
      t116 = t26*t11
      t118 = 1/t2/t116
      t119 = t25*t118
      t124 = -t105-t115-0.5487637560595959D-1*t119*t17
     &-0.1393129225879125D0*t20*t108
      t125 = t3*t124
      t128 = t32**2
      t129 = 1/t128
      t131 = -t105-t115-0.2911213559997856D-4*t119
      t132 = t129*t131
      t135 = 1/t45
      t136 = 1/t11
      t137 = t135*t136
      t138 = t137*t51
      t140 = t47**2
      t141 = 1/t140
      t142 = t39*t141
      t143 = t40**2
      t144 = t143**2
      t145 = t144*t40
      t146 = 1/t145
      t150 = 1/t43
      t153 = 1/t37
      t154 = t153*t136
      t156 = -0.99709173929518D0*t146*t136-0.7418564737168958D0*t137
     &-0.4002143174996817D0*t150*t136-0.1264669550498372D0*t154
      t157 = 1/t50
      t159 = t142*t156*t157
      t162 = 1/t2/t106
      t167 = -0.1110869918438343D0*t138-0.4042761511756372D2*t159
      t169 = t64*t167*t59
      t173 = 1/t12/t27
      t176 = -0.148092480894642D0*sigma*t162-0.1086645186223595D-1*t73
     &*t169-0.5071010869043442D-1*t62*t173
      t179 = t76**2
      t180 = 1/t179
      t181 = t67*t180
      t182 = t72*sigma
      t190 = 1/t71/t60
      t191 = t190*t25
      t196 = -0.1712109500228824D0*t182*t55*t167*t59
     &-0.3994922167200589D0*t68*t162-0.5862637881547585D-1*t191*t169
     &-0.136794883902777D0*t73*t173
      t199 = 0.2697586091519874D1*t176*t77-0.2697586091519874D1*t181
     &*t196
      t200 = 1/t80
      t201 = t199*t200
      t205 = -0.4811024840421814D1*t137-0.1895695887660258D-2*t154
      t208 = t89**2
      t209 = 1/t208
      t210 = t85*t209
      t214 = -0.1803772444038489D1*t137-0.1210946621972718D0*t154
     &-0.1763993811759022D-1*t136
      t217 = 0.1D-2*t205*t90-0.1D-2*t210*t214
      t218 = t217*sigma
      t219 = t218*t95
      t221 = t162*t17
      t222 = t94*t221
      t224 = t93*t25
      t226 = 1/t116*t17
      t227 = t224*t226
      vrhoa(i) = -0.9847450218426965D0*t100*t33-0.3692793831910112D0
     &*t125*t33+0.3692793831910112D0*t24*t132-t53+t82+t97+rho*
     &(0.2747799777968419D-2*t138+0.1D1*t159+0.2473556743557577D-1
     &*t201+0.1D1*t219-0.2333333333333333D1*t222+0.6965646129395627D1
     &*t227)
      t231 = 1/t4
      t234 = 0.6350067860591282D-1*t231*t5*t8
      t236 = 0.8000631191499664D-1*t14*t113
      t237 = t29*t17
      t242 = t234+t236+0.411572817044697D-1*t237*sigma
     &+0.1044846919409344D0*t19*t14
      t243 = t3*t242
      t248 = t234+t236+0.2183410169998392D-4*sigma*t29
      t249 = t129*t248
      t255 = 0.634682060977037D-1*t55+0.2173290372447189D-1*t68*t64
      t262 = 0.1712109500228824D0*t61*t55+0.5862637881547585D-1*t182*t64
      t265 = 0.2697586091519874D1*t255*t77-0.2697586091519874D1*t181
     &*t262
      t266 = t265*t200
      t269 = t93*t55*t17
      t271 = 1/t27
      t272 = t271*t17
      t273 = t94*t272
      vsigmaaa(i) = -0.7385587663820224D0*t243*t33
     &+0.7385587663820224D0*t24*t249+4.D0*rho*(0.2473556743557577D-1
     &*t266+0.1D1*t269-0.261211729852336D1*t273)
      t286 = 0.395115333547902D0*t4*t162*t8
      t289 = 0.1066750825533289D1*sigma*t64*t113
      t290 = t26*t106
      t293 = t25/t2/t290
      t295 = 1/t112/t111
      t297 = 0.4515683437631874D0*t293*t295
      t306 = 1/t128/t32
      t307 = t131**2
      t315 = t25*sigma
      t316 = t26**2
      t337 = 1/t26
      t338 = 1/t45/t36*t337
      t339 = t338*t51
      t341 = t140**2
      t344 = t156**2
      t345 = t50**2
      t348 = t39/t341*t344/t345
      t354 = 1/t106
      t358 = t135*t354
      t368 = 1/t37/t36*t337
      t370 = t153*t354
      t374 = t142*(-0.8309097827459833D0/t145/t36*t337
     &+0.199418347859036D1*t146*t354-0.4945709824779306D0*t338
     &+0.1483712947433792D1*t358-0.2001071587498409D0/t43/t36*t337
     &+0.8004286349993634D0*t150*t354-0.4215565168327908D-1*t368
     &+0.2529339100996745D0*t370)*t157
      t380 = t39/t140/t47*t344*t157
      t382 = t358*t51
      t386 = t137*t141*t156*t157
      t406 = t214**2
      t422 = t316*rho
      t430 = t224/t290*t17
      t433 = 1/t2/t26
      t435 = t94*t433*t17
      t437 = t199**2
      t438 = t80**2
      t439 = 1/t438
      t442 = sigma*t433
      t445 = t173*t167*t59
      t454 = -0.740579945625562D-1*t339-0.6501498040842D3*t348
     &-0.4042761511756372D2*t374+0.8085523023512745D2*t380
     &+0.2221739836876686D0*t382+0.3572962974617552D1*t386
      t456 = t64*t454*t59
      t459 = t167**2
      t460 = t64*t459
      t462 = dexp(0.5027739926480695D1*t52)
      t463 = t460*t462
      t466 = t460*t59
      t470 = 1/t12/t116
      t471 = t62*t470
      t476 = t176*t180
      t481 = t67/t179/t76
      t482 = t196**2
      t495 = t190*sigma
      t496 = t55*t459
      t503 = t68*t433
      t505 = t71**2
      t514 = t73*t470
      s1 = 0.1831866518645613D-2*t339+0.160818243221511D2*t348+0.1D1
     &*t374-0.2D1*t380-0.5495599555936838D-2*t382
     &-0.8837926660346786D-1*t386-0.4666666666666667D1*t218*t221
      s2 = s1+0.1393129225879125D2*t217*t25*t226+0.1D1*(0.1D-2*(
     &-0.3207349893614542D1*t338+0.9622049680843627D1*t358
     &-0.6318986292200858D-3*t368+0.3791391775320515D-2*t370)*t90
     &-0.2D-2*t205*t209*t214+0.2D-2*t85/t208/t89*t406-0.1D-2*t210*(
     &-0.1202514962692326D1*t338+0.3607544888076978D1*t358
     &-0.4036488739909061D-1*t368+0.2421893243945437D0*t370
     &+0.3527987623518044D-1*t354))*sigma*t95+0.4852022599996427D2*t93
     &*t315/t12/t422*t17
      t522 = s2-0.5804705107829689D2*t430+0.7777777777777778D1*t435
     &-0.2473556743557577D-1*t437*t439+0.2473556743557577D-1*
     &(0.2697586091519874D1*(0.4936416029821399D0*t442
     &+0.1014202173808688D0*t73*t445-0.1086645186223595D-1*t73*t456
     &+0.2173290372447189D-1*t191*t463-0.1086645186223595D-1*t73*t466
     &+0.2873572825791284D0*t471)*t77-0.5395172183039748D1*t476*t196
     &+0.5395172183039748D1*t481*t482-0.2697586091519874D1*t181*
     &(0.7989844334401178D0*t182*t162*t167*t59-0.1712109500228824D0
     &*t182*t55*t454*t59+0.547179535611108D0*t191*t445
     &+0.3424219000457648D0*t495*t496*t462-0.1712109500228824D0*t182
     &*t496*t59+0.1331640722400196D1*t503+0.1758791364464276D0/t505
     &*t25*t463-0.5862637881547585D-1*t191*t456-0.5862637881547585D-1
     &*t191*t466+0.7751710087824029D0*t514))*t200
      t535 = dlog(1.D0+0.2960857464321668D2/(0.8157414703487641D1*t40
     &+0.2247591863577616D1*t37+0.4300972471276643D0*t43
     &+0.1911512595127338D0*t45))
      t537 = (1.D0+0.6901399211255825D-1*t37)*t535*t136
      t539 = t81*t136
      t545 = 0.1365402220407279D1*t537-0.1675913308826898D1*t52*t136
      t547 = t64*t545*t59
      t575 = -t545
      t577 = t64*t575*t59
      s1 = 0.1099119911187368D-1*t138+0.4D1*t159+0.2786258451758251D2
     &*t227-0.9333333333333333D1*t222+0.4D1*t219+0.9894226974230308D-1
     &*t201+0.3692793831910112D0*t24*t129*(t286+t289-t297
     &+0.3687537175997285D-3*t293)+0.7385587663820224D0*t125*t132
      s2 = s1-0.7385587663820224D0*t24*t306*t307+0.1969490043685393D1
     &*t100*t132-0.3692793831910112D0*t3*(t286+t289-t297
     &+0.9877747609072727D0*t293*t17-0.764498826669826D0*t315/t316/t11
     &*t17+0.1021628098978025D1*t20*t64)*t33
      s3 = s2-0.6564966812284644D0/t12*t23*t33-0.1969490043685393D1*t2
     &*t124*t33
      s4 = s3+2.D0*rho*t522
      s5 = s4
      s6 = rho*(-0.3377399869956914D-1*t537+0.1649037829038385D-1*t539
     &+0.2473556743557577D-1*(0.2697586091519874D1*(
     &-0.2820809159897942D-1*t442-0.1086645186223595D-1*t73*t547
     &-0.9659068321987509D-2*t471)*t77-0.2697586091519874D1*t181*(
     &-0.1712109500228824D0*t182*t55*t545*t59-0.760937555657255D-1
     &*t503-0.5862637881547585D-1*t191*t547-0.2605616836243371D-1*t514
     &))*t200+0.2222222222222222D0*t435-0.1160941021565938D1*t430)+rho
     &*(0.3377399869956914D-1*t537-0.1649037829038385D-1*t539
     &+0.2473556743557577D-1*(0.2697586091519874D1*
     &(0.2820809159897942D-1*t442-0.1086645186223595D-1*t73*t577
     &+0.9659068321987509D-2*t471)*t77-0.2697586091519874D1*t181*(
     &-0.1712109500228824D0*t182*t55*t575*t59+0.760937555657255D-1
     &*t503-0.5862637881547585D-1*t191*t577+0.2605616836243371D-1*t514
     &))*t200-0.2222222222222222D0*t435+0.1160941021565938D1*t430)
      v2rhoa2(i) = s5+s6
      t609 = 0.1693351429491009D0*t231*t55*t8
      t611 = 0.6400504953199731D0*t108*t113
      t612 = sigma*t118
      t614 = 0.3386762578223905D0*t612*t295
      t654 = t255*t180
      s1 = -0.9847450218426965D0*t2*t242*t33+0.9847450218426965D0*t100
     &*t249-0.3692793831910112D0*t3*(-t609-t611+t614
     &-0.6585165072715151D0*t118*t17*sigma+0.5733741200023695D0*t25
     &/t422*t17-0.5572516903516501D0*t19*t108)*t33
     &+0.3692793831910112D0*t125*t249+0.3692793831910112D0*t243*t132
      s2 = s1-0.7385587663820224D0*t24*t306*t131*t248
     &+0.3692793831910112D0*t24*t129*(-t609-t611+t614
     &-0.2328970847998285D-3*t612)
      v2rhoasigmaaa(i) = s2+0.9894226974230308D-1*t266+0.4D1*t269
     &-0.1044846919409344D2*t273+4.D0*rho*(0.2473556743557577D-1*
     &(0.2697586091519874D1*(-0.148092480894642D0*t162
     &-0.2173290372447189D-1*t182*t169-0.1014202173808688D0*t68*t173)
     &*t77-0.2697586091519874D1*t476*t262-0.2697586091519874D1*t654
     &*t196+0.5395172183039748D1*t481*t196*t262-0.2697586091519874D1
     &*t181*(-0.1712109500228824D0*t72*t55*t167*t59
     &-0.3994922167200589D0*t61*t162-0.1172527576309517D0*t495*t169
     &-0.273589767805554D0*t182*t173))*t200-0.2473556743557577D-1*t199
     &*t439*t265+0.1D1*t217*t55*t17-0.261211729852336D1*t218*t272
     &-0.2333333333333333D1*t93*t162*t17+0.2002623262201243D2*t94*t226
     &-0.181950847499866D2*t224/t12/t316*t17)
      t701 = 0.1270013572118256D0/t4/sigma*t5*t8
      t705 = 0.1600126238299933D0/sigma*t14*t113
      t707 = 0.2540071933667929D0*t29*t295
      t719 = t248**2
      t733 = t262**2
      t742 = t265**2
      v2sigmaaa2(i) = -0.7385587663820224D0*t3*(-t701+t705-t707
     &-0.4300305900017772D0/t316*t17*sigma+0.3292582536357576D0*t237)
     &*t33+0.1477117532764045D1*t243*t249-0.1477117532764045D1*t24
     &*t306*t719+0.7385587663820224D0*t24*t129*(-t701+t705-t707
     &+0.8733640679993569D-4*t29)+16.D0*rho*(0.2473556743557577D-1*
     &(0.5862637881547585D-1*t61*t64*t77-0.5395172183039748D1*t654
     &*t262+0.5395172183039748D1*t481*t733-0.1581497040888031D0*t181
     &*t72*t64)*t200-0.2473556743557577D-1*t742*t439
     &-0.522423459704672D1*t93*t271*t17+0.6823156781244976D1*t94/t12
     &/t290*t17)
      else ! rho
      zk(i) = 0.0d0
      vrhoa(i) = 0.0d0
      v2rhoa2(i) = 0.0d0
      vsigmaaa(i) = 0.0d0
      v2rhoasigmaaa(i) = 0.0d0
      v2sigmaaa2(i) = 0.0d0
      endif ! rho
      enddo
      
      endif ! ideriv
      return
      end

c:XC_PW91subrend
